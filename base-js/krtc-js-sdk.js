!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KRTC=t():e.KRTC=t()}(self,(function(){return(()=>{var e={1277:function(e){var t;"undefined"!=typeof window&&(t=function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="./src/index.ts")}({"./node_modules/@babel/runtime/helpers/assertThisInitialized.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/assertThisInitialized.js ***!
  \**********************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"./node_modules/@babel/runtime/helpers/asyncToGenerator.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/asyncToGenerator.js ***!
  \*****************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){function i(e,t,i,r,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void i(e)}s.done?t(c):Promise.resolve(c).then(r,n)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}},"./node_modules/@babel/runtime/helpers/createClass.js":
/*!************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/createClass.js ***!
  \************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}},"./node_modules/@babel/runtime/helpers/extends.js":
/*!********************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/extends.js ***!
  \********************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){function i(){return e.exports=i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},i.apply(this,arguments)}e.exports=i},"./node_modules/@babel/runtime/helpers/inheritsLoose.js":
/*!**************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/inheritsLoose.js ***!
  \**************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},"./node_modules/@babel/runtime/regenerator/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/regenerator/index.js ***!
  \**********************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,i){e.exports=i(/*! regenerator-runtime */"./node_modules/regenerator-runtime/runtime.js")},"./node_modules/events/events.js":
/*!***************************************!*\
  !*** ./node_modules/events/events.js ***!
  \***************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,i){"use strict";var r,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(i,r){function n(i){e.removeListener(t,o),r(i)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",n),i([].slice.call(arguments))}v(e,t,o,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&v(e,"error",t,i)}(e,n,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,i,r){var n,o,a,s;if(u(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),a=o[t]),void 0===a)a=o[t]=i,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[i,a]:[a,i]:r?a.unshift(i):a.push(i),(n=l(e))>0&&a.length>n&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=h.bind(r);return n.listener=i,r.wrapFn=n,n}function f(e,t,i){var r=e._events;if(void 0===r)return[];var n=r[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):g(n,n.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),r=0;r<t;++r)i[r]=e[r];return i}function v(e,t,i,r){if("function"==typeof e.on)r.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(o){r.once&&e.removeEventListener(t,n),i(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=n[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var u=c.length,l=g(c,u);for(i=0;i<u;++i)o(l[i],this,t)}return!0},s.prototype.addListener=function(e,t){return d(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return d(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var i,r,n,o,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,n=o;break}if(n<0)return this;0===n?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,n),1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var n,o=Object.keys(i);for(r=0;r<o.length;++r)"removeListener"!==(n=o[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},"./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,i){var r=function(e){"use strict";var t,i=Object.prototype,r=i.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,i){return e[t]=i}}function u(e,t,i,r){var n=t&&t.prototype instanceof g?t:g,o=Object.create(n.prototype),a=new w(r||[]);return o._invoke=function(e,t,i){var r=d;return function(n,o){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===n)throw o;return k()}for(i.method=n,i.arg=o;;){var a=i.delegate;if(a){var s=E(a,i);if(s){if(s===m)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var c=l(e,t,i);if("normal"===c.type){if(r=i.done?f:h,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=f,i.method="throw",i.arg=c.arg)}}}(e,i,a),o}function l(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",m={};function g(){}function v(){}function A(){}var T={};T[o]=function(){return this};var _=Object.getPrototypeOf,x=_&&_(_(R([])));x&&x!==i&&r.call(x,o)&&(T=x);var y=A.prototype=g.prototype=Object.create(T);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function i(n,o,a,s){var c=l(e[n],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var n;this._invoke=function(e,r){function o(){return new t((function(t,n){i(e,r,t,n)}))}return n=n?n.then(o,o):o()}}function E(e,i){var r=e.iterator[i.method];if(r===t){if(i.delegate=null,"throw"===i.method){if(e.iterator.return&&(i.method="return",i.arg=t,E(e,i),"throw"===i.method))return m;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=l(r,e.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,m;var o=n.arg;return o?o.done?(i[e.resultName]=o.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,m):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function R(e){if(e){var i=e[o];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function i(){for(;++n<e.length;)if(r.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}return{next:k}}function k(){return{value:t,done:!0}}return v.prototype=y.constructor=A,A.constructor=v,v.displayName=c(A,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},C(b.prototype),b.prototype[a]=function(){return this},e.AsyncIterator=b,e.async=function(t,i,r,n,o){void 0===o&&(o=Promise);var a=new b(u(t,i,r,n),o);return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(y),c(y,s,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},e.values=R,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(r,n){return s.type="throw",s.arg=e,i.next=r,n&&(i.method="next",i.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),I(i),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;I(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,r){return this.delegate={iterator:R(e),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
  !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
  \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,i){var r,n,o,a,s;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,n=/^([^\/?#]*)([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return i.alwaysNormalize?(o.path=s.normalizePath(o.path),s.buildURLFromParts(o)):t;var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var c=n.exec(a.path);a.netLoc=c[1],a.path=c[2]}a.netLoc&&!a.path&&(a.path="/");var u={scheme:a.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=a.netLoc,"/"!==o.path[0]))if(o.path){var l=a.path,d=l.substring(0,l.lastIndexOf("/")+1)+o.path;u.path=s.normalizePath(d)}else u.path=a.path,o.params||(u.params=a.params,o.query||(u.query=a.query));return null===u.path&&(u.path=i.alwaysNormalize?s.normalizePath(o.path):o.path),s.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(o,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},"./src/config.ts":
/*!***********************!*\
  !*** ./src/config.ts ***!
  \***********************/
/*! exports provided: ConfigHelper */function(e,t,i){"use strict";i.r(t),i.d(t,"ConfigHelper",(function(){return h}));var r=i(/*! @babel/runtime/helpers/extends */"./node_modules/@babel/runtime/helpers/extends.js"),n=i.n(r),o=i(/*! ./core/tf-urls */"./src/core/tf-urls.ts"),a=i(/*! ./types/main */"./src/types/main.ts"),s=i(/*! ./utils/browser-helper */"./src/utils/browser-helper.ts"),c=i(/*! ./utils/log */"./src/utils/log.ts"),u=i(/*! ./utils/pixel-ratio */"./src/utils/pixel-ratio.ts"),l=i(/*! ./utils/tf-utils */"./src/utils/tf-utils.ts"),d={keepAlive:!1,pixelRatioByDevice:!0,webWorker:!1,virtualBackgroundModel:o.DEFAULT_VB_MODEL_URL,tfBaseUrl:o.TF_BASE_URL,tfThread:0,tfFastStart:!0,maxRetry:2,connectionTimeout:1e4,transmissionTimeout:0,retryDelay:500,log:c.LOG_LEVEL.LEVEL_INFO},h=function(){function e(){}return e.processConfig=function(e){var t=n()({},d);return n()(t,e),u.PixelRatio.setPixelRatioByDevice(t.pixelRatioByDevice),t},e.updateTFModelConfig=function(e,t){void 0===t&&(t=!1),"string"!=typeof e.virtualBackgroundModel&&(e.tfModelType||(e.tfModelType=navigator.hardwareConcurrency>=4&&Object(l.getIsSupportSIMD)()&&!s.default.isAndroid&&!s.default.isIOS?a.TFModelType.full:a.TFModelType.lite))},e}()},"./src/core/errors.ts":
/*!****************************!*\
  !*** ./src/core/errors.ts ***!
  \****************************/
/*! exports provided: ErrorCode */function(e,t,i){"use strict";var r;i.r(t),i.d(t,"ErrorCode",(function(){return r})),function(e){e[e.MAIN_ERROR=101]="MAIN_ERROR",e[e.WEBGL_INIT_ERROR=102]="WEBGL_INIT_ERROR",e[e.FILTER_SELECT_ERROR=103]="FILTER_SELECT_ERROR",e[e.WORKER_INIT_ERROR=104]="WORKER_INIT_ERROR",e[e.TF_INIT_ERROR=105]="TF_INIT_ERROR",e[e.TF_LOAD_ERROR=10]="TF_LOAD_ERROR",e[e.TF_JS_LOAD_ERROR=11]="TF_JS_LOAD_ERROR",e[e.TF_MODEL_LOAD_ERROR=12]="TF_MODEL_LOAD_ERROR"}(r||(r={}))},"./src/core/events.ts":
/*!****************************!*\
  !*** ./src/core/events.ts ***!
  \****************************/
/*! exports provided: default */function(e,t,i){"use strict";var r;i.r(t),function(e){e.INIT="init",e.ERROR="error",e.HEARTBEAT="heartbeat",e.DRAWN="drawn",e.FILTER_SELECTED="filterSelected",e.RESIZED="resized",e.RES_READY="ready",e.RES_EMPTIED="emptied",e.RES_RESIZE="resize"}(r||(r={})),t.default=r},"./src/core/filter-list.ts":
/*!*********************************!*\
  !*** ./src/core/filter-list.ts ***!
  \*********************************/
/*! exports provided: FilterList */function(e,t,i){"use strict";i.r(t),i.d(t,"FilterList",(function(){return r}));var r={base:{id:"base",filter:i(/*! ../filter/filter-base */"./src/filter/filter-base.ts").default}}},"./src/core/renderer-worker.ts":
/*!*************************************!*\
  !*** ./src/core/renderer-worker.ts ***!
  \*************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/core/render-manager.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t);var r=i(/*! events */"./node_modules/events/events.js"),n=i(/*! ../utils/log */"./src/utils/log.ts"),o=i(/*! ./events */"./src/core/events.ts"),a=i(/*! ./filter-list */"./src/core/filter-list.ts"),s=i(/*! ./renderer */"./src/core/renderer.ts"),c=i(/*! ./worker-cmd */"./src/core/worker-cmd.ts");console.log(1001),t.default=function(e){var t=new r.EventEmitter,i=new s.default(t);console.log(1002),a.FilterList,console.log(1003),t.on(o.default.ERROR,(function(t){return e.postMessage({event:o.default.ERROR,data:t})})),t.on(o.default.DRAWN,(function(t){t&&t.bitmap?e.postMessage({event:o.default.DRAWN,data:t},[t.bitmap]):e.postMessage({event:o.default.DRAWN,data:t})})),t.on(o.default.FILTER_SELECTED,(function(t){return e.postMessage({event:o.default.FILTER_SELECTED,data:t})})),e.addEventListener("message",(function(e){var t=e.data;switch(t.cmd){case c.WorkerCmd.INIT:i.init(t.config,t.output),n.Log.level(t.config.log);break;case c.WorkerCmd.DRAW:i.draw(t.ts,t.data,t.extra);break;case c.WorkerCmd.SELECT:i.select(t.name,t.immediate);break;case c.WorkerCmd.SET_PARAMS:i.setParams(t.params);break;case c.WorkerCmd.SET_FILTERS:break;case c.WorkerCmd.CLEAR:i.clear();break;case c.WorkerCmd.UPDATE_OUTPUT_SIZE:i.updateOutputSize(t.w,t.h)}}))}},"./src/core/renderer.ts":
/*!******************************************!*\
  !*** ./src/core/renderer.ts + 2 modules ***!
  \******************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/createClass.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/extends.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/errors.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/events.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/filter-list.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group.ts because of ./src/filter/filter-unsharp-mask.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/types/main.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/log.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/tex-helper.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/webgl-utils.ts because of ./src/index.ts */function(e,t,i){"use strict";i.r(t);var r=i("./src/types/main.ts"),n=i("./node_modules/@babel/runtime/helpers/extends.js"),o=i.n(n),a=i("./node_modules/@babel/runtime/helpers/createClass.js"),s=i.n(a),c=i("./src/filter/filter-group.ts"),u=i("./src/utils/log.ts"),l=i("./src/core/filter-list.ts"),d="combo_m",h=function(){function e(e){this._itemNames=[],this._name="",this._filter=void 0,this._filterList=[],this._gl=null,this._params=void 0,this._config=void 0,this._config=e}e.getComboFilterName=function(e){return e.length?e.reduce((function(e,t){return e+"_"+t}),"c"):""};var t=e.prototype;return t.setWebGLCtx=function(e){u.Log.i(d,"set gl ctx"),this._gl=e||null,this._filter&&this._name&&this._newCombo()},t.select=function(t){if(t.length){var i=e.getComboFilterName(t);return this._name=i,this._itemNames=t,this._newCombo(),!0}return!1},t.setParams=function(e){var t=this;this._params&&(e.forEach((function(e,i){t._params&&(t._params[i]?o()(t._params[i],e):t._params[i]=e)})),this.applyParams())},t.applyParams=function(){var e=this,t=this._params;t&&(t.forEach((function(i,r){var n=e._filterList[r];if(i&&n)for(var o in i)t&&n&&(n[o]=i[o])})),this._filter&&this._filter.rebuildGraph())},t.destroy=function(){this._removeCombo(),this._itemNames=[],this._gl=null},t._newCombo=function(){var e=this;u.Log.i(d,"new combo"),this._removeCombo();var t=this._filter=new c.default(this._gl);this._itemNames.forEach((function(i){if(l.FilterList[i]){var r=new l.FilterList[i].filter(e._gl,e._config);e._filterList.push(r),t.addFilter(r)}})),this._params=this._getDefaultParams(this._itemNames)},t._removeCombo=function(){this._filter&&(this._filter.destroy(),delete l.FilterList[this._name],this._filter=void 0),this._filterList=[]},t._getDefaultParams=function(e){var t=[];return e.forEach((function(e,i){var r,n=l.FilterList[e].paramsInfo;n?Object.keys(n).forEach((function(e){n[e]&&n[e].default&&(r||(r={},t[i]=r),r[e]=n[e].default)})):t[i]=void 0})),t},s()(e,[{key:"filter",get:function(){return this._filter}},{key:"filterName",get:function(){return this._name}}]),e}(),p=i("./src/utils/tex-helper.ts"),f=i("./src/core/events.ts"),m=i("./src/utils/webgl-utils.ts"),g=i("./src/core/errors.ts"),v="filter-m",A=function(){function e(e,t,i){this._filterName="base",this._filter=void 0,this._gl=null,this._source=void 0,this._eventEmitter=void 0,this._config=void 0,this._inWorker=void 0,this._externalGL=!1,this._comboM=void 0,this._waitingFilter=void 0,this._waitingFilterName="",this._recover=!1,this._eventEmitter=e,this._config=t,this._inWorker=i,this._comboM=new h(t)}var t=e.prototype;return t.select=function(e,t){var i,r,n=this;if(u.Log.i(v,"select: "+e),this.destroyWaitingFilter(),Array.isArray(e)){if(!this._comboM.select(e))return;t&&Array.isArray(t)&&this._comboM.setParams(t),i=this._comboM.filter}else{if(!(r=l.FilterList[e]))return;i=new r.filter(this._gl,this._config)}this._waitingFilter=i,this._waitingFilterName=e,i&&this._gl&&(this._source||this._inWorker)&&i.init().then((function(a){var s;if(n._waitingFilter=void 0,n._waitingFilterName="",null!=(s=i)&&s.gl){if(a.error)return n._recover||(n.select(n._filterName),n._recover=!0),void n._eventEmitter.emit(f.default.ERROR,a.error);if(n._recover=!1,n._filter&&n._filter.destroy(),i&&(n._source||n._inWorker)){i.active(),r?(r.paramsInfo&&Object.keys(r.paramsInfo).forEach((function(e){r&&r.paramsInfo&&r.paramsInfo[e]&&r.paramsInfo[e].default&&(r.params||(r.params={}),void 0===r.params[e]&&(r.params[e]=r.paramsInfo[e].default))})),r.params&&(t&&!Array.isArray(t)&&o()(r.params,t),n.setParams(i,r.params,r.id))):n._comboM.applyParams(),n._source&&i.setInput(n._source),n._filter=i,n._filterName=e;var c={name:e};a.extraInfo&&(c.extraInfo=a.extraInfo),u.Log.i(v,"selected: "+n._filterName),n._eventEmitter.emit(f.default.FILTER_SELECTED,c)}}}))},t.attachSource=function(e){this._source=e},t.detachSource=function(){this._source=void 0},t.attachOutput=function(e){this._gl&&this.destroyCurrentFilter(),e instanceof WebGLRenderingContext?(this._externalGL=!0,this._gl=e):(this._externalGL=!1,this._gl=Object(m.getWebGLRenderingContext)(e)),this._comboM.setWebGLCtx(this._gl),this._gl||this._eventEmitter.emit(f.default.ERROR,{code:g.ErrorCode.WEBGL_INIT_ERROR,reason:"init webgl error",fatal:!0})},t.detachOutput=function(){this._gl&&(this.clear(),this.destroyCurrentFilter()),this._gl=null},t.setParams=function(e,t,i){if(void 0===i&&(i=""),u.Log.i(v,"setParams",i,t),i=i||this._filterName,Array.isArray(i))Array.isArray(t)&&this._comboM.setParams(t);else if(!Array.isArray(t)){var r=l.FilterList[i];r&&(r.params?o()(r.params,t):r.params=t),t&&Object.keys(t).forEach((function(i){t&&e&&(e[i]=t[i])}))}},t.clear=function(){u.Log.i(v,"clear"),this._gl&&(this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT))},t.destroyCurrentFilter=function(e){void 0===e&&(e=!1),this._filter&&(this._filter.destroy(e),this._filter=void 0)},t.destroyWaitingFilter=function(){this._waitingFilter&&(this._waitingFilter.destroy(),this._waitingFilter=void 0),this._waitingFilterName=""},t.destroy=function(){u.Log.w(v,"destroy"),Object.keys(l.FilterList).forEach((function(e){l.FilterList[e].params=void 0})),this.destroyCurrentFilter(this._externalGL),this._comboM.destroy(),this.destroyWaitingFilter()},t._isSameName=function(e,t){return typeof e==typeof t&&(Array.isArray(e)?e.length===t.length&&0===e.filter((function(e,i){return e!==t[i]})).length:e===t)},s()(e,[{key:"filters",get:function(){var e=[];return Object.keys(l.FilterList).forEach((function(t){e.push({name:t,paramsInfo:l.FilterList[t].paramsInfo,extra:l.FilterList[t].extra})})),e}},{key:"currentFilterName",get:function(){return this._filterName}},{key:"currentFilter",get:function(){return this._filter}},{key:"waitingFilter",get:function(){return this._waitingFilter}},{key:"waitingFilterName",get:function(){return this._waitingFilterName}}]),e}(),T="renderer",_=function(){function e(e){this._eventEmitter=void 0,this._config=void 0,this._inputSize={width:0,height:0},this._outputSize={width:0,height:0},this._canvas=void 0,this._gl=null,this._source=void 0,this._filterName="base",this._filter=void 0,this._waitingFilter=void 0,this._waitingFilterName="",this._comboM=void 0,this._externalGL=!1,this._filterM=void 0,this._filterParams=void 0,this._inWorker=!1,this._eventEmitter=e,this._inWorker="undefined"==typeof HTMLElement}var t=e.prototype;return t.init=function(e,t){this._config=e,this._comboM=new h(e),this._filterM=new A(this._eventEmitter,e,this._inWorker),t instanceof WebGLRenderingContext?(this._canvas=t.canvas,this._gl=t):"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?this._canvas=t:this._canvas=new OffscreenCanvas(t.width,t.height),this._canvas&&(this._outputSize.width=this._canvas.width,this._outputSize.height=this._canvas.height,this._filterM.attachOutput(this._canvas))},t.attachSource=function(e){this._source=e,this._filterM&&this._filterM.attachSource(e)},t.detachSource=function(){this._source=void 0,this._filterM&&this._filterM.detachSource()},t.select=function(e,t){u.Log.i(T,"select",e,t),(Array.isArray(e)||l.FilterList[e])&&(this._filterName=e,t&&this._selectFilter(e))},t.setParams=function(e){if(u.Log.i(T,"setParams"),this._filterM){var t=this._filterM.waitingFilter||this._filterM.currentFilter,i=this._filterM.waitingFilterName||this._filterM.currentFilterName;t?this._filterM.setParams(t,e,i):this._filterParams=e}},t.draw=function(e,t){var i,n=null==(i=this._filterM)?void 0:i.currentFilter;if(n){var o={ts:e,duration:0};t&&(n.setInputSize({width:t.width,height:t.height}),n.setInput(t,0,!1,!0)),this._source&&void 0===this._source.texture&&n.setInputSize(Object(p.getSourceSize)(this._source));var a=n.draw();a&&a.time&&(o.details=a.time),this._inWorker&&this._canvas instanceof OffscreenCanvas&&(!a||a.code===r.DrawStatuCode.success)?this._eventEmitter.emit(f.default.DRAWN,{time:o,bitmap:this._canvas.transferToImageBitmap()}):this._eventEmitter.emit(f.default.DRAWN,{time:o})}else this._eventEmitter.emit(f.default.DRAWN)},t.updateOutputSize=function(e,t){this._filterM&&this._canvas&&(this._outputSize.width!==e||this._outputSize.height!==t)&&(this._outputSize.width=e,this._outputSize.height=t,this._canvas.width=e,this._canvas.height=t,this._filterM.currentFilter&&this._filterM.currentFilter.onResize())},t.destroy=function(){Object.keys(l.FilterList).forEach((function(e){l.FilterList[e].params=void 0})),this.destroyCurrentFilter(this._externalGL),this._comboM&&this._comboM.destroy(),this._filterM&&this._filterM.destroy(),this.destroyWaitingFilter()},t.clear=function(){this._filterM&&this._filterM.clear()},t.destroyCurrentFilter=function(e){void 0===e&&(e=!1),this._filter&&(this._filter.destroy(e),this._filter=void 0)},t.destroyWaitingFilter=function(){this._waitingFilter&&(this._waitingFilter.destroy(),this._waitingFilter=void 0),this._waitingFilterName=""},t._selectFilter=function(e){u.Log.i(T,"_select",e,this._filterParams,this._filterM),this._filterM&&(this._filterM.select(e,this._filterParams),this._filterParams&&(this._filterParams=void 0))},e}();t.default=_},"./src/core/tf-urls.ts":
/*!*****************************!*\
  !*** ./src/core/tf-urls.ts ***!
  \*****************************/
/*! exports provided: WASM_URL, WASM_SIMD_URL, WASM_THREAD_URL, WASM_SIMD_THREAD_URL, JS_URL, JS_THREAD_URL, JS_SIMD_THREAD_URL, JS_WORKER_URL, MODEL, MODEL_LITE, DEFAULT_VB_MODEL_URL, TF_BASE_URL */function(e,t,i){"use strict";i.r(t),i.d(t,"WASM_URL",(function(){return r})),i.d(t,"WASM_SIMD_URL",(function(){return n})),i.d(t,"WASM_THREAD_URL",(function(){return o})),i.d(t,"WASM_SIMD_THREAD_URL",(function(){return a})),i.d(t,"JS_URL",(function(){return s})),i.d(t,"JS_THREAD_URL",(function(){return c})),i.d(t,"JS_SIMD_THREAD_URL",(function(){return u})),i.d(t,"JS_WORKER_URL",(function(){return l})),i.d(t,"MODEL",(function(){return d})),i.d(t,"MODEL_LITE",(function(){return h})),i.d(t,"DEFAULT_VB_MODEL_URL",(function(){return p})),i.d(t,"TF_BASE_URL",(function(){return f}));var r="ktf-1",n="ktf-s-1",o="ktf-t-1",a="ktf-st-1",s="ktf-js-1",c="ktf-t-js-1",u="ktf-st-js-1",l="ktf-st-jsw-1",d="portraitnet075cmask_160288_orimodel_mergebn_int8",h="portraitnetsmall015cmask_epoch7_256",p={full:d,lite:h},f="https://s2-10895.kwimgs.com/kos/nlav10895/tflite/"},"./src/core/worker-cmd.ts":
/*!********************************!*\
  !*** ./src/core/worker-cmd.ts ***!
  \********************************/
/*! exports provided: WorkerCmd */function(e,t,i){"use strict";var r;i.r(t),i.d(t,"WorkerCmd",(function(){return r})),function(e){e.INIT="init",e.DRAW="draw",e.CLEAR="clear",e.SELECT="select",e.SET_PARAMS="setParams",e.SET_FILTERS="setFilters",e.UPDATE_OUTPUT_SIZE="updateOutputSize",e.RESIZE="resize"}(r||(r={}))},"./src/filter/adv/filter-1977.ts":
/*!***************************************************!*\
  !*** ./src/filter/adv/filter-1977.ts + 2 modules ***!
  \***************************************************/
/*! exports provided: FILTER_1977_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-valencia.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-three-input.ts because of ./src/filter/adv/filter-beauty.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_1977_FRAGMENT",(function(){return d}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/filter/filter-group-res.ts"),l=i("./src/filter/filter-three-input.ts"),d="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\n\nvoid main()\n{\n    \n    vec4 texel = texture2D(inputImageTexture, textureCoordinate);\n    \n    texel.r = texture2D(inputImageTexture2, vec2(texel.r, .16666)).r;\n    texel.g = texture2D(inputImageTexture2, vec2(texel.g, .5)).g;\n    texel.b = texture2D(inputImageTexture2, vec2(texel.b, .83333)).b;\n    \n    gl_FragColor = texel;\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._three=void 0,i._image=void 0,i._image2=void 0,i._three=new l.default(t),i._image={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAIGNIUk0AAG2YAABzjgAA2e0AAIGfAAB/mgAA2GMAADIXAAAdLVvevdMAAAAJcEhZcwAACxMAAAsTAQCanBgAAACdSURBVDjL3ZJBDgMxCAPH/lVv/UL//5j2AEkIK0U5dyUkJxhjyOrzen/5k0+AC+5nj/tMWoElZXhiRyJx3GMhItf5W9hLg8UddWRObhro6cXVi0vv0PbgevcQNfs8yqHdfAPHeSyXXZQ6GfvgvWrkTqYORWPb3a4xZ2fNT9nL4NK8ifUOVYfsuTD30X+uE29gLjg68H3owyWv8hvvB7DNA7Qc4vbAAAAAAElFTkSuQmCC"},i._image2={src:"data:image/png;base64,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"},i._res.setQueue([i._image,i._image2]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._three.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._three),e.abrupt("return",this._three.init({fragment:d}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&this._image2.img&&(this._three.active(),this._three.setInput(this._image.img,1,!0),this._three.setInput(this._image2.img,2,!0),this._resUploaded=!0)},t}(u.default);t.default=h},"./src/filter/adv/filter-background.ts":
/*!*********************************************!*\
  !*** ./src/filter/adv/filter-background.ts ***!
  \*********************************************/
/*! exports provided: FILTER_MIX_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_MIX_FRAGMENT",(function(){return d}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ../../types/filter */"./src/types/filter.ts"),c=i(/*! ../../utils/tex-helper */"./src/utils/tex-helper.ts"),u=i(/*! ../../utils/tex-proxy */"./src/utils/tex-proxy.ts"),l=i(/*! ../filter-base */"./src/filter/filter-base.ts"),d="\nprecision mediump float;\n\nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\n\nuniform vec4 uBGView;\n\nvoid main() {\n    // background\n    vec4 centerColor = texture2D(inputImageTexture, textureCoordinate);\n    lowp vec2 bgCoord = vec2(textureCoordinate.x * uBGView[2] + uBGView[0], textureCoordinate.y * uBGView[3] + uBGView[1]);\n    vec3 backgroundColor = texture2D(inputImageTexture2, bgCoord).rgb;\n    gl_FragColor = vec4(mix(backgroundColor, centerColor.rgb, centerColor.a), 1.0);\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._backgroundTexture=null,i._inputTextureUniform2=null,i._bgViewUniform=null,i._bgW=0,i._bgH=0,i._background=void 0,i._bgProxy=void 0,i._bgView=[0,0,1,1],i._fragmentShader=d,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;t&&i&&(this._inputTextureUniform2=t.getUniformLocation(i,"inputImageTexture2"),this._bgViewUniform=t.getUniformLocation(i,"uBGView"))},i.draw=function(){var e=this._gl;e&&this._input&&(this._updateSize(),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),this._background&&(this._backgroundTexture||(this._backgroundTexture=this._createAndSetupTexture(e)),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._backgroundTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._background)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===s.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===s.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),this._backgroundTexture&&e.uniform1i(this._inputTextureUniform2,1),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._bgProxy&&this._bgProxy.destroy(),this._gl&&this._backgroundTexture&&this._gl.deleteTexture(this._backgroundTexture),this._background=void 0,this._backgroundTexture=null,e.prototype.destroy.call(this,t)},i._updateSize=function(){e.prototype._updateSize.call(this),this._gl&&this._isActivated&&this._bgW&&this._bgH&&(Object(c.updateView)(this._bgView,this._inputWidth,this._inputHeight,this._bgW,this._bgH,"cut"),this._gl.uniform4fv(this._bgViewUniform,this._bgView))},i._updateBackground=function(e){this._background=e;var t=Object(c.getSourceSize)(this._background);this._bgW=t.width,this._bgH=t.height},n()(t,[{key:"background",set:function(e){var t=this;Object(c.isTexImageSource)(e)&&(this._bgProxy&&this._bgProxy.destroy(),"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof ImageData&&e instanceof ImageData||Object(c.isSourceReady)(e)?this._updateBackground(e):(this._bgProxy=new u.default,this._bgProxy.on("ready",(function(){t._bgProxy&&t._bgProxy.source&&t._updateBackground(t._bgProxy.source)}))))}}]),t}(l.default);t.default=h},"./src/filter/adv/filter-beauty-tx.ts":
/*!********************************************!*\
  !*** ./src/filter/adv/filter-beauty-tx.ts ***!
  \********************************************/
/*! exports provided: FILTER_BEAUTY_TX_VERTEX, FILTER_BEAUTY_TX_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_BEAUTY_TX_VERTEX",(function(){return c})),i.d(t,"FILTER_BEAUTY_TX_FRAGMENT",(function(){return u}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ../filter-base */"./src/filter/filter-base.ts"),c="\n    precision highp float;\n    attribute vec2 position;\n    attribute vec2 inputTextureCoordinate;\n    varying vec2 textureCoordinate;\n    uniform float flipY;\n    void main(void) {\n        textureCoordinate = inputTextureCoordinate;\n        gl_Position = vec4(position.xy, 0.0, 1.);\n    }\n",u="\n    precision highp float;\n    uniform vec2 singleStepOffset;\n    uniform sampler2D inputImageTexture;\n    uniform vec4 params;\n    uniform float brightness;\n    uniform int enabled;\n    varying vec2 textureCoordinate;\n    const highp vec3 W = vec3(0.299,0.587,0.114);\n    const mat3 saturateMatrix = mat3(1.1102,-0.0598,-0.061,-0.0774,1.0826,-0.1186,-0.0228,-0.0228,1.1772);\n    vec2 blurCoordinates[24];\n\n    float hardLight(float color) {\n        if(color <= 0.5){\n            color = color * color * 2.0;\n        } else {\n            color = 1.0 - ((1.0 - color)*(1.0 - color) * 2.0);\n        }\n        return color;\n    }\n\n    void main(){\n        if (enabled == 0) {\n            gl_FragColor = texture2D(inputImageTexture, textureCoordinate);\n        } else {\n            vec4 central = texture2D(inputImageTexture, textureCoordinate);\n            vec3 centralColor = central.rgb;\n            blurCoordinates[0] = textureCoordinate.xy + singleStepOffset * vec2(0.0, -10.0);\n            blurCoordinates[1] = textureCoordinate.xy + singleStepOffset * vec2(0.0, 10.0);\n            blurCoordinates[2] = textureCoordinate.xy + singleStepOffset * vec2(-10.0, 0.0);\n            blurCoordinates[3] = textureCoordinate.xy + singleStepOffset * vec2(10.0, 0.0);\n            blurCoordinates[4] = textureCoordinate.xy + singleStepOffset * vec2(5.0, -8.0);\n            blurCoordinates[5] = textureCoordinate.xy + singleStepOffset * vec2(5.0, 8.0);\n            blurCoordinates[6] = textureCoordinate.xy + singleStepOffset * vec2(-5.0, 8.0);\n            blurCoordinates[7] = textureCoordinate.xy + singleStepOffset * vec2(-5.0, -8.0);\n            blurCoordinates[8] = textureCoordinate.xy + singleStepOffset * vec2(8.0, -5.0);\n            blurCoordinates[9] = textureCoordinate.xy + singleStepOffset * vec2(8.0, 5.0);\n            blurCoordinates[10] = textureCoordinate.xy + singleStepOffset * vec2(-8.0, 5.0);\n            blurCoordinates[11] = textureCoordinate.xy + singleStepOffset * vec2(-8.0, -5.0);\n            blurCoordinates[12] = textureCoordinate.xy + singleStepOffset * vec2(0.0, -6.0);\n            blurCoordinates[13] = textureCoordinate.xy + singleStepOffset * vec2(0.0, 6.0);\n            blurCoordinates[14] = textureCoordinate.xy + singleStepOffset * vec2(6.0, 0.0);\n            blurCoordinates[15] = textureCoordinate.xy + singleStepOffset * vec2(-6.0, 0.0);\n            blurCoordinates[16] = textureCoordinate.xy + singleStepOffset * vec2(-4.0, -4.0);\n            blurCoordinates[17] = textureCoordinate.xy + singleStepOffset * vec2(-4.0, 4.0);\n            blurCoordinates[18] = textureCoordinate.xy + singleStepOffset * vec2(4.0, -4.0);\n            blurCoordinates[19] = textureCoordinate.xy + singleStepOffset * vec2(4.0, 4.0);\n            blurCoordinates[20] = textureCoordinate.xy + singleStepOffset * vec2(-2.0, -2.0);\n            blurCoordinates[21] = textureCoordinate.xy + singleStepOffset * vec2(-2.0, 2.0);\n            blurCoordinates[22] = textureCoordinate.xy + singleStepOffset * vec2(2.0, -2.0);\n            blurCoordinates[23] = textureCoordinate.xy + singleStepOffset * vec2(2.0, 2.0);\n    \n            float sampleColor = centralColor.g * 22.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[0]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[1]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[2]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[3]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[4]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[5]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[6]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[7]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[8]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[9]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[10]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[11]).g;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[12]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[13]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[14]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[15]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[16]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[17]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[18]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[19]).g * 2.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[20]).g * 3.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[21]).g * 3.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[22]).g * 3.0;\n            sampleColor += texture2D(inputImageTexture, blurCoordinates[23]).g * 3.0;\n            sampleColor = sampleColor / 62.0;\n    \n            float highPass = centralColor.g - sampleColor + 0.5;\n            for(int i = 0; i < 5;i++){\n                highPass = hardLight(highPass);\n            }\n            float luminance = dot(centralColor, W);\n            float alpha = pow(luminance, params.r);\n            vec3 smoothColor = centralColor + (centralColor-vec3(highPass))*alpha*0.1;\n            smoothColor.r = clamp(pow(smoothColor.r, params.g),0.0,1.0);\n            smoothColor.g = clamp(pow(smoothColor.g, params.g),0.0,1.0);\n            smoothColor.b = clamp(pow(smoothColor.b, params.g),0.0,1.0);\n    \n            vec3 screen = vec3(1.0) - (vec3(1.0)-smoothColor) * (vec3(1.0)-centralColor);\n            vec3 lighten = max(smoothColor, centralColor);\n            vec3 softLight = 2.0 * centralColor*smoothColor + centralColor*centralColor - 2.0 * centralColor*centralColor * smoothColor;\n    \n            gl_FragColor = vec4(mix(centralColor, screen, alpha), central.a);\n            gl_FragColor.rgb = mix(gl_FragColor.rgb, lighten, alpha);\n            gl_FragColor.rgb = mix(gl_FragColor.rgb, softLight, params.b);\n            vec3 satColor = gl_FragColor.rgb * saturateMatrix;\n            gl_FragColor.rgb = mix(gl_FragColor.rgb, satColor, params.a);\n            gl_FragColor.rgb = vec3(gl_FragColor.rgb + vec3(brightness));\n        }\n    }\n",l=function(e){function t(t){var i;return(i=e.call(this,t)||this)._singleStepOffsetUniform=null,i._paramsUniform=null,i._brightnessUniform=null,i._enabledUniform=null,i._texelWidth=0,i._texelHeight=0,i._brightness=.5,i._beauty=.5,i._ruddy=.5,i._enabled=0,i._fragmentShader=u,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._gl&&this._program&&(this._singleStepOffsetUniform=this._gl.getUniformLocation(this._program,"singleStepOffset"),this._paramsUniform=this._gl.getUniformLocation(this._program,"params"),this._brightnessUniform=this._gl.getUniformLocation(this._program,"brightness"),this._enabledUniform=this._gl.getUniformLocation(this._program,"enabled"),this._gl.uniform2f(this._singleStepOffsetUniform,this._texelWidth,this._texelHeight),this._updateParams())},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._texelWidth=2/this._inputWidth,this._texelHeight=2/this._inputHeight,this._gl&&this._isActivated&&this._gl.uniform2f(this._singleStepOffsetUniform,this._texelWidth,this._texelHeight)},i._updateParams=function(){if(this._gl&&this._isActivated){this._enabled=0===this._beauty&&0===this._brightness&&0===this._ruddy?0:1,this._gl.uniform1i(this._enabledUniform,this._enabled);var e=new Float32Array([1-.8*this._beauty,1-.6*this._beauty,.1+.45*this._ruddy,.1+.45*this._ruddy]);this._gl.uniform4fv(this._paramsUniform,e),this._gl.uniform1f(this._brightnessUniform,.12*this._brightness)}},n()(t,[{key:"brightness",set:function(e){e!==this._brightness&&(this._brightness=e,this._updateParams())}},{key:"beauty",set:function(e){e!==this._beauty&&(this._beauty=e,this._updateParams())}},{key:"ruddy",set:function(e){e!==this._ruddy&&(this._ruddy=e,this._updateParams())}}]),t}(s.default);t.default=l},"./src/filter/adv/filter-beauty.ts":
/*!*****************************************************!*\
  !*** ./src/filter/adv/filter-beauty.ts + 8 modules ***!
  \*****************************************************/
/*! exports provided: FILTER_BEAUTIFY_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/createClass.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-base.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-color-matrix.ts because of ./src/filter/filter-sepia.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-gaussian-blur.ts because of ./src/filter/filter-unsharp-mask.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-grayscale.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group.ts because of ./src/filter/filter-unsharp-mask.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-three-input.ts because of ./src/filter/adv/filter-valencia.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_BEAUTIFY_FRAGMENT",(function(){return E}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/createClass.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),c=i.n(s),u=i("./node_modules/@babel/runtime/regenerator/index.js"),l=i.n(u),d=i("./src/filter/filter-base.ts"),h=i("./src/filter/filter-gaussian-blur.ts"),p=function(e){function t(t){var i;return(i=e.call(this,t)||this)._distanceNormalizationFactor=8,i._firstDistanceNormalizationFactorUniform=null,i._secondDistanceNormalizationFactorUniform=null,i._vertexShader=i._secondVertexShader="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\n\nconst int GAUSSIAN_SAMPLES = 9;\n\nuniform float texelWidthOffset;\nuniform float texelHeightOffset;\n\nvarying vec2 textureCoordinate;\nvarying vec2 blurCoordinates[GAUSSIAN_SAMPLES];\n\nvoid main()\n{\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n    \n    // Calculate the positions for the blur\n    int multiplier = 0;\n    vec2 blurStep;\n    vec2 singleStepOffset = vec2(texelWidthOffset, texelHeightOffset);\n    \n    for (int i = 0; i < GAUSSIAN_SAMPLES; i++)\n    {\n        multiplier = (i - ((GAUSSIAN_SAMPLES - 1) / 2));\n        // Blur in x (horizontal)\n        blurStep = float(multiplier) * singleStepOffset;\n        blurCoordinates[i] = inputTextureCoordinate.xy + blurStep;\n    }\n}\n",i._fragmentShader=i._secondFragmentShader="\nuniform sampler2D inputImageTexture;\n \nconst lowp int GAUSSIAN_SAMPLES = 9;\n\nvarying highp vec2 textureCoordinate;\nvarying highp vec2 blurCoordinates[GAUSSIAN_SAMPLES];\n\nuniform mediump float distanceNormalizationFactor;\n\nvoid main()\n{\n    lowp vec4 centralColor;\n    lowp float gaussianWeightTotal;\n    lowp vec4 sum;\n    lowp vec4 sampleColor;\n    lowp float distanceFromCentralColor;\n    lowp float gaussianWeight;\n    \n    centralColor = texture2D(inputImageTexture, blurCoordinates[4]);\n    gaussianWeightTotal = 0.18;\n    sum = centralColor * 0.18;\n    \n    sampleColor = texture2D(inputImageTexture, blurCoordinates[0]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.05 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[1]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.09 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[2]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.12 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[3]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.15 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[5]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.15 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[6]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.12 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[7]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.09 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n\n    sampleColor = texture2D(inputImageTexture, blurCoordinates[8]);\n    distanceFromCentralColor = min(distance(centralColor, sampleColor) * distanceNormalizationFactor, 1.0);\n    gaussianWeight = 0.05 * (1.0 - distanceFromCentralColor);\n    gaussianWeightTotal += gaussianWeight;\n    sum += sampleColor * gaussianWeight;\n    \n    gl_FragColor = sum / gaussianWeightTotal;\n}\n",i}c()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._firstDistanceNormalizationFactorUniform=this._gl.getUniformLocation(this._program,"distanceNormalizationFactor"),this._secondDistanceNormalizationFactorUniform=this._gl.getUniformLocation(this._program,"distanceNormalizationFactor"),this.distanceNormalizationFactor=this._distanceNormalizationFactor,this.texelSpacingMultiplier=4)},i._setUniformsForProgramAtIndex=function(t){e.prototype._setUniformsForProgramAtIndex.call(this,t),this._gl&&this._isActivated&&(0===t?this._gl.uniform1f(this._firstDistanceNormalizationFactorUniform,this._distanceNormalizationFactor):this._gl.uniform1f(this._secondDistanceNormalizationFactorUniform,this._distanceNormalizationFactor))},a()(t,[{key:"distanceNormalizationFactor",set:function(e){this._distanceNormalizationFactor=e}}]),t}(h.default),f=function(e){function t(t){var i;return(i=e.call(this,t)||this)._texelWidthUniform=null,i._texelHeightUniform=null,i._upperThresholdUniform=null,i._lowerThresholdUniform=null,i._texelWidth=0,i._texelHeight=0,i._upperThreshold=.5,i._lowerThreshold=.1,i._hasOverriddenImageSizeFactor=!1,i._fragmentShader="\nprecision mediump float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform highp float texelWidth; \nuniform highp float texelHeight; \nuniform mediump float upperThreshold; \nuniform mediump float lowerThreshold; \n\nvoid main()\n{\n    vec3 currentGradientAndDirection = texture2D(inputImageTexture, textureCoordinate).rgb;\n    vec2 gradientDirection = ((currentGradientAndDirection.gb * 2.0) - 1.0) * vec2(texelWidth, texelHeight);\n    \n    float firstSampledGradientMagnitude = texture2D(inputImageTexture, textureCoordinate + gradientDirection).r;\n    float secondSampledGradientMagnitude = texture2D(inputImageTexture, textureCoordinate - gradientDirection).r;\n    \n    float multiplier = step(firstSampledGradientMagnitude, currentGradientAndDirection.r);\n    multiplier = multiplier * step(secondSampledGradientMagnitude, currentGradientAndDirection.r);\n    \n    float thresholdCompliance = smoothstep(lowerThreshold, upperThreshold, currentGradientAndDirection.r);\n    multiplier = multiplier * thresholdCompliance;\n    \n    gl_FragColor = vec4(multiplier, multiplier, multiplier, 1.0);\n}\n",i}c()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._texelWidthUniform=this._gl.getUniformLocation(this._program,"texelWidth"),this._texelHeightUniform=this._gl.getUniformLocation(this._program,"texelHeight"),this._upperThresholdUniform=this._gl.getUniformLocation(this._program,"upperThreshold"),this._lowerThresholdUniform=this._gl.getUniformLocation(this._program,"lowerThreshold"),this.upperThreshold=this._upperThreshold,this.lowerThreshold=this._lowerThreshold)},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._hasOverriddenImageSizeFactor||(this._texelWidth=.5/this._inputWidth,this._texelHeight=.5/this._inputHeight,this._gl&&this._isActivated&&(this._gl.uniform1f(this._texelWidthUniform,this._texelWidth),this._gl.uniform1f(this._texelHeightUniform,this._texelHeight)))},a()(t,[{key:"texelWidth",set:function(e){this._texelWidth=e,this._hasOverriddenImageSizeFactor=!0,this._gl&&this._isActivated&&this._gl.uniform1f(this._texelWidthUniform,e)}},{key:"texelHeight",set:function(e){this._texelHeight=e,this._hasOverriddenImageSizeFactor=!0,this._gl&&this._isActivated&&this._gl.uniform1f(this._texelHeightUniform,e)}},{key:"lowerThreshold",get:function(){return this._lowerThreshold},set:function(e){this._lowerThreshold=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._lowerThresholdUniform,e)}},{key:"upperThreshold",get:function(){return this._upperThreshold},set:function(e){this._upperThreshold=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._upperThresholdUniform,e)}}]),t}(d.default),m=function(e){function t(t){var i;return(i=e.call(this,t)||this)._texelWidthUniform=null,i._texelHeightUniform=null,i._texelWidth=0,i._texelHeight=0,i._hasOverriddenImageSizeFactor=!1,i._vertexShader="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\n\nuniform float texelWidth;\nuniform float texelHeight; \n\nvarying vec2 textureCoordinate;\nvarying vec2 leftTextureCoordinate;\nvarying vec2 rightTextureCoordinate;\n\nvarying vec2 topTextureCoordinate;\nvarying vec2 topLeftTextureCoordinate;\nvarying vec2 topRightTextureCoordinate;\n\nvarying vec2 bottomTextureCoordinate;\nvarying vec2 bottomLeftTextureCoordinate;\nvarying vec2 bottomRightTextureCoordinate;\n\nvoid main() {\n    gl_Position = position;\n    vec2 widthStep = vec2(texelWidth, 0.0);\n    vec2 heightStep = vec2(0.0, texelHeight);\n    vec2 widthHeightStep = vec2(texelWidth, texelHeight);\n    vec2 widthNegativeHeightStep = vec2(texelWidth, -texelHeight);\n\n    textureCoordinate = inputTextureCoordinate.xy;\n    leftTextureCoordinate = inputTextureCoordinate.xy - widthStep;\n    rightTextureCoordinate = inputTextureCoordinate.xy + widthStep;\n\n    topTextureCoordinate = inputTextureCoordinate.xy - heightStep;\n    topLeftTextureCoordinate = inputTextureCoordinate.xy - widthHeightStep;\n    topRightTextureCoordinate = inputTextureCoordinate.xy + widthNegativeHeightStep;\n\n    bottomTextureCoordinate = inputTextureCoordinate.xy + heightStep;\n    bottomLeftTextureCoordinate = inputTextureCoordinate.xy - widthNegativeHeightStep;\n    bottomRightTextureCoordinate = inputTextureCoordinate.xy + widthHeightStep;\n}\n",i}c()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._texelWidthUniform=this._gl.getUniformLocation(this._program,"texelWidth"),this._texelHeightUniform=this._gl.getUniformLocation(this._program,"texelHeight"),this._gl.uniform1f(this._texelWidthUniform,this._texelWidth),this._gl.uniform1f(this._texelHeightUniform,this._texelHeight))},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._hasOverriddenImageSizeFactor||(this._texelWidth=1/this._inputWidth,this._texelHeight=1/this._inputHeight,this._gl&&this._isActivated&&(this._gl.uniform1f(this._texelWidthUniform,this._texelWidth),this._gl.uniform1f(this._texelHeightUniform,this._texelHeight)))},a()(t,[{key:"texelWidth",get:function(){return this._texelWidth},set:function(e){this._texelWidth=e,this._hasOverriddenImageSizeFactor=!0,this._gl&&this._isActivated&&this._gl.uniform1f(this._texelWidthUniform,e)}},{key:"texelHeight",get:function(){return this._texelHeight},set:function(e){this._texelHeight=e,this._hasOverriddenImageSizeFactor=!0,this._gl&&this._isActivated&&this._gl.uniform1f(this._texelHeightUniform,e)}}]),t}(d.default),g=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fragmentShader="\nprecision mediump float;\n \nvarying vec2 textureCoordinate;\nvarying vec2 leftTextureCoordinate;\nvarying vec2 rightTextureCoordinate;\n\nvarying vec2 topTextureCoordinate;\nvarying vec2 topLeftTextureCoordinate;\nvarying vec2 topRightTextureCoordinate;\n\nvarying vec2 bottomTextureCoordinate;\nvarying vec2 bottomLeftTextureCoordinate;\nvarying vec2 bottomRightTextureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nvoid main()\n{\n    float bottomLeftIntensity = texture2D(inputImageTexture, bottomLeftTextureCoordinate).r;\n    float topRightIntensity = texture2D(inputImageTexture, topRightTextureCoordinate).r;\n    float topLeftIntensity = texture2D(inputImageTexture, topLeftTextureCoordinate).r;\n    float bottomRightIntensity = texture2D(inputImageTexture, bottomRightTextureCoordinate).r;\n    float leftIntensity = texture2D(inputImageTexture, leftTextureCoordinate).r;\n    float rightIntensity = texture2D(inputImageTexture, rightTextureCoordinate).r;\n    float bottomIntensity = texture2D(inputImageTexture, bottomTextureCoordinate).r;\n    float topIntensity = texture2D(inputImageTexture, topTextureCoordinate).r;\n    \n    vec2 gradientDirection;\n    gradientDirection.x = -bottomLeftIntensity - 2.0 * leftIntensity - topLeftIntensity + bottomRightIntensity + 2.0 * rightIntensity + topRightIntensity;\n    gradientDirection.y = -topLeftIntensity - 2.0 * topIntensity - topRightIntensity + bottomLeftIntensity + 2.0 * bottomIntensity + bottomRightIntensity;\n    \n    float gradientMagnitude = length(gradientDirection);\n    vec2 normalizedDirection = normalize(gradientDirection);\n    normalizedDirection = sign(normalizedDirection) * floor(abs(normalizedDirection) + 0.617316); // Offset by 1-sin(pi/8) to set to 0 if near axis, 1 if away\n    normalizedDirection = (normalizedDirection + 1.0) * 0.5; // Place -1.0 - 1.0 within 0 - 1.0\n    \n    gl_FragColor = vec4(gradientMagnitude, normalizedDirection.x, normalizedDirection.y, 1.0);\n}\n",i}return c()(t,e),t}(m),v=i("./src/filter/filter-grayscale.ts"),A=i("./src/filter/filter-group.ts"),T=function(e){function t(){return e.apply(this,arguments)||this}c()(t,e);var i=t.prototype;return i._vertexShaderForOptimizedBlurOfRadius=function(e,t){if(e<1)return d.FILTER_VERTEX;for(var i=[],r=0,n=0;n<e+1;n++)i[n]=1/Math.sqrt(2*Math.PI*Math.pow(t,2))*Math.exp(-Math.pow(n,2)/(2*Math.pow(t,2))),r+=0==n?i[n]:2*i[n];for(var o=0;o<e+1;o++)i[o]=i[o]/r;for(var a=Math.min(e/2+e%2,7),s=[],c=0;c<a;c++){var u=i[2*c+1],l=i[2*c+2],h=u+l;s[c]=(u*(2*c+1)+l*(2*c+2))/h}for(var p="\n        attribute vec4 position;\n        attribute vec4 inputTextureCoordinate;\n\n        uniform float texelWidthOffset;\n        uniform float texelHeightOffset;\n\n        varying vec2 blurCoordinates["+(1+2*a)+"];\n\n        void main() {\n            gl_Position = position;\n            vec2 singleStepOffset = vec2(texelWidthOffset, texelHeightOffset);\n            blurCoordinates[0] = inputTextureCoordinate.xy;\n        ",f=0;f<a;f++)p+="\n                blurCoordinates["+(2*f+1)+"] = inputTextureCoordinate.xy + singleStepOffset * "+s[f]+";\n                blurCoordinates["+(2*f+2)+"] = inputTextureCoordinate.xy - singleStepOffset * "+s[f]+";\n                ";return p+="}"},i._fragmentShaderForOptimizedBlurOfRadius=function(e,t){if(e<1)return d.FILTER_FRAGMENT;for(var i=[],r=0,n=0;n<e+1;n++)i[n]=1/Math.sqrt(2*Math.PI*Math.pow(t,2))*Math.exp(-Math.pow(n,2)/(2*Math.pow(t,2))),r+=0==n?i[n]:2*i[n];for(var o=0;o<e+1;o++)i[o]=i[o]/r;for(var a=Math.min(e/2+e%2,7),s=e/2+e%2,c="\n        uniform sampler2D inputImageTexture;\n        uniform highp float texelWidthOffset;\n        uniform highp float texelHeightOffset;\n\n        varying highp vec2 blurCoordinates["+(1+2*a)+"];\n\n        void main() {\n            lowp float sum = 0.0;\n            sum += texture2D(inputImageTexture, blurCoordinates[0]).r * "+i[0]+";\n        ",u=0;u<a;u++){var l=i[2*u+1]+i[2*u+2];c+="\n            sum += texture2D(inputImageTexture, blurCoordinates["+(2*u+1)+"]).r * "+l+";\n            sum += texture2D(inputImageTexture, blurCoordinates["+(2*u+2)+"]).r * "+l+";\n            "}if(s>a){c+="\n            highp vec2 singleStepOffset = vec2(texelWidthOffset, texelHeightOffset);\n            ";for(var h=a;h<s;h++){var p=i[2*h+1],f=i[2*h+2],m=p+f,g=(p*(2*h+1)+f*(2*h+2))/m;c+="\n            sum += texture2D(inputImageTexture, blurCoordinates[0] + singleStepOffset * "+g+").r * "+m+";\n            sum += texture2D(inputImageTexture, blurCoordinates[0] - singleStepOffset * "+g+").r * "+m+";\n                "}}return c+="\n            gl_FragColor = vec4(sum, sum, sum, 1.0);\n        }"},t}(h.default),_=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fragmentShader="\nprecision lowp float;\n \nvarying vec2 textureCoordinate;\nvarying vec2 leftTextureCoordinate;\nvarying vec2 rightTextureCoordinate;\n\nvarying vec2 topTextureCoordinate;\nvarying vec2 topLeftTextureCoordinate;\nvarying vec2 topRightTextureCoordinate;\n\nvarying vec2 bottomTextureCoordinate;\nvarying vec2 bottomLeftTextureCoordinate;\nvarying vec2 bottomRightTextureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nvoid main()\n{\n    float bottomLeftIntensity = texture2D(inputImageTexture, bottomLeftTextureCoordinate).r;\n    float topRightIntensity = texture2D(inputImageTexture, topRightTextureCoordinate).r;\n    float topLeftIntensity = texture2D(inputImageTexture, topLeftTextureCoordinate).r;\n    float bottomRightIntensity = texture2D(inputImageTexture, bottomRightTextureCoordinate).r;\n    float leftIntensity = texture2D(inputImageTexture, leftTextureCoordinate).r;\n    float rightIntensity = texture2D(inputImageTexture, rightTextureCoordinate).r;\n    float bottomIntensity = texture2D(inputImageTexture, bottomTextureCoordinate).r;\n    float topIntensity = texture2D(inputImageTexture, topTextureCoordinate).r;\n    float centerIntensity = texture2D(inputImageTexture, textureCoordinate).r;\n    \n    float pixelIntensitySum = bottomLeftIntensity + topRightIntensity + topLeftIntensity + bottomRightIntensity + leftIntensity + rightIntensity + bottomIntensity + topIntensity + centerIntensity;\n    float sumTest = step(1.5, pixelIntensitySum);\n    float pixelTest = step(0.01, centerIntensity);\n         \n    gl_FragColor = vec4(vec3(sumTest * pixelTest), 1.0);\n}\n",i}return c()(t,e),t}(m),x=function(e){function t(t){var i;return(i=e.call(this,t)||this)._luminanceFilter=void 0,i._blurFilter=void 0,i._edgeDetectionFilter=void 0,i._nonMaximumSuppressionFilter=void 0,i._weakPixelInclusionFilter=void 0,i._blurRadiusInPixels=2,i._blurTexelSpacingMultiplier=1,i._upperThreshold=.4,i._lowerThreshold=.1,i._texelWidth=0,i._texelHeight=0,i._luminanceFilter=new v.default(t),i._blurFilter=new T(t),i._edgeDetectionFilter=new g(t),i._nonMaximumSuppressionFilter=new f(t),i._weakPixelInclusionFilter=new _(t),i}c()(t,e);var i=t.prototype;return i.init=function(){var e=n()(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this._luminanceFilter.init(),this._blurFilter.init(),this._edgeDetectionFilter.init(),this._nonMaximumSuppressionFilter.init(),this._weakPixelInclusionFilter.init()]).then((function(e){var i=e.filter((function(e){return!!e.error}));return i.length?i[0]:(t.addFilter(t._luminanceFilter),t.addFilter(t._blurFilter),t.addFilter(t._edgeDetectionFilter),t.addFilter(t._nonMaximumSuppressionFilter),t.addFilter(t._weakPixelInclusionFilter),e[0])})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.active=function(){this._luminanceFilter.active(),this._blurFilter.active(),this.blurRadiusInPixels=this._blurRadiusInPixels,this.blurTexelSpacingMultiplier=this.blurTexelSpacingMultiplier,this._edgeDetectionFilter.active(),this._texelWidth=this._edgeDetectionFilter.texelWidth,this._texelHeight=this._edgeDetectionFilter.texelHeight,this._nonMaximumSuppressionFilter.active(),this.upperThreshold=this._upperThreshold,this.lowerThreshold=this._lowerThreshold,this._weakPixelInclusionFilter.active()},a()(t,[{key:"blurRadiusInPixels",get:function(){return this._blurFilter.blurRadiusInPixels},set:function(e){this._blurRadiusInPixels=e,this._blurFilter.blurRadiusInPixels=e}},{key:"blurTexelSpacingMultiplier",get:function(){return this._blurFilter.texelSpacingMultiplier},set:function(e){this._blurTexelSpacingMultiplier=e,this._blurFilter.texelSpacingMultiplier=e}},{key:"texelWidth",get:function(){return this._edgeDetectionFilter.texelWidth},set:function(e){this._texelWidth=e,this._edgeDetectionFilter.texelWidth=e}},{key:"texelHeight",get:function(){return this._edgeDetectionFilter.texelHeight},set:function(e){this._texelHeight=e,this._edgeDetectionFilter.texelHeight=e}},{key:"upperThreshold",get:function(){return this._nonMaximumSuppressionFilter.upperThreshold},set:function(e){this._upperThreshold=e,this._nonMaximumSuppressionFilter.upperThreshold=e}},{key:"lowerThreshold",get:function(){return this._nonMaximumSuppressionFilter.lowerThreshold},set:function(e){this._lowerThreshold=e,this._nonMaximumSuppressionFilter.lowerThreshold=e}}]),t}(A.default),y=i("./src/filter/filter-color-matrix.ts"),C=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this)._matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],t}c()(t,e);var i=t.prototype;return i.reset=function(){t.identmat(this._matrix),this._updateColorMatrix()},i._updateColorMatrix=function(){this.colorMatrix=this._matrix[0].concat(this._matrix[1],this._matrix[2],this._matrix[3])},t.identmat=function(e){e[0][0]=1,e[0][1]=0,e[0][2]=0,e[0][3]=0,e[1][0]=0,e[1][1]=1,e[1][2]=0,e[1][3]=0,e[2][0]=0,e[2][1]=0,e[2][2]=1,e[2][3]=0,e[3][0]=0,e[3][1]=0,e[3][2]=0,e[3][3]=1},t.cscalemat=function(e,i,r,n){var o=[[],[],[],[]];o[0][0]=i,o[0][1]=0,o[0][2]=0,o[0][3]=0,o[1][0]=0,o[1][1]=r,o[1][2]=0,o[1][3]=0,o[2][0]=0,o[2][1]=0,o[2][2]=n,o[2][3]=0,o[3][0]=0,o[3][1]=0,o[3][2]=0,o[3][3]=1,t.matrixmult(o,e,e)},t.saturatemat=function(e,i){var r,n,o,a,s,c,u,l,d,h,p,f=[[],[],[],[]];r=.3*(1-i)+i,n=.3*(1-i),o=.3*(1-i),a=(1-i)*(h=.59),s=(1-i)*h+i,c=(1-i)*h,u=(1-i)*(p=.11),l=(1-i)*p,d=(1-i)*p+i,f[0][0]=r,f[0][1]=n,f[0][2]=o,f[0][3]=0,f[1][0]=a,f[1][1]=s,f[1][2]=c,f[1][3]=0,f[2][0]=u,f[2][1]=l,f[2][2]=d,f[2][3]=0,f[3][0]=0,f[3][1]=0,f[3][2]=0,f[3][3]=1,t.matrixmult(f,e,e)},t.matrixmult=function(e,t,i){var r,n,o=[[],[],[],[]];for(n=0;n<4;n++)for(r=0;r<4;r++)o[n][r]=t[n][0]*e[0][r]+t[n][1]*e[1][r]+t[n][2]*e[2][r]+t[n][3]*e[3][r];for(n=0;n<4;n++)for(r=0;r<4;r++)i[n][r]=o[n][r]},a()(t,[{key:"adjustBrightness",set:function(e){t.cscalemat(this._matrix,e,e,e),this._updateColorMatrix()}},{key:"adjustSaturation",set:function(e){t.saturatemat(this._matrix,e),this._updateColorMatrix()}}]),t}(y.default),b=i("./src/filter/filter-three-input.ts"),E="\nvarying highp vec2 textureCoordinate;\nvarying highp vec2 textureCoordinate2;\nvarying highp vec2 textureCoordinate3;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\nuniform sampler2D inputImageTexture3;\nuniform mediump float smoothDegree;\n\nvoid main()\n{\n    highp vec4 bilateral = texture2D(inputImageTexture, textureCoordinate);\n    highp vec4 canny = texture2D(inputImageTexture2, textureCoordinate2);\n    highp vec4 origin = texture2D(inputImageTexture3,textureCoordinate3);\n    highp vec4 smooth;\n    lowp float r = origin.r;\n    lowp float g = origin.g;\n    lowp float b = origin.b;\n    if (canny.r < 0.2 && r > 0.3725 && g > 0.1568 && b > 0.0784 && r > b && (max(max(r, g), b) - min(min(r, g), b)) > 0.0588 && abs(r-g) > 0.0588) {\n        smooth = (1.0 - smoothDegree) * (origin - bilateral) + bilateral;\n    }\n    else {\n        smooth = origin;\n    }\n    smooth.r = log(1.0 + 0.2 * smooth.r)/log(1.2);\n    smooth.g = log(1.0 + 0.2 * smooth.g)/log(1.2);\n    smooth.b = log(1.0 + 0.2 * smooth.b)/log(1.2);\n    gl_FragColor = smooth;\n}\n",S=function(e){function t(t){var i;return(i=e.call(this,t)||this)._intensity=.5,i._base=void 0,i._bilateral=void 0,i._cannyEdge=void 0,i._combination=void 0,i._hsb=void 0,i._base=new d.default(t),i._bilateral=new p(t),i._cannyEdge=new x(t),i._combination=new I(t),i._hsb=new C(t),i}c()(t,e);var i=t.prototype;return i.active=function(){this._bilateral.active(),this._cannyEdge.active(),this._combination.active(),this._hsb.active()},i.init=function(){var e=n()(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this._base.init(),this._bilateral.init(),this._cannyEdge.init(),this._combination.init(),this._hsb.init()]).then((function(e){var i=e.filter((function(e){return!!e.error}));return i.length?i[0]:(t._bilateral.distanceNormalizationFactor=4,t._hsb.adjustBrightness=1.1,t._hsb.adjustSaturation=1.1,t.addFilter(t._base),t.addFilter(t._bilateral),t.addFilter(t._cannyEdge),t.addFilter(t._combination),t.addFilter(t._hsb),e[0])})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.setInput=function(e,t,i,r){this._input=e,this._base.active(),this._base.setInput(e),this._grapha&&r||(this._grapha=!0,this._base.drawToFBO(),this._base.outputResource&&(this._bilateral.active(),this._bilateral.setInput(this._base.outputResource),this._bilateral.drawToFBO(),this._cannyEdge.active(),this._cannyEdge.setInput(this._base.outputResource),this._cannyEdge.drawToFBO(),this._bilateral.outputResource&&this._cannyEdge.outputResource&&(this._combination.active(),this._combination.setInput(this._bilateral.outputResource,0),this._combination.setInput(this._cannyEdge.outputResource,1),this._combination.setInput(this._base.outputResource,2),this._combination.drawToFBO()),this._combination.outputResource&&this._hsb.setInput(this._combination.outputResource)))},a()(t,[{key:"intensity",set:function(e){e>=0&&e<=1&&(this._combination.intensity=e)}}]),t}(A.default),I=function(e){function t(t){var i;return(i=e.call(this,t)||this)._smoothDegreeUniform=null,i._intensity=.5,i._fragmentShader=E,i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._smoothDegreeUniform=this._gl.getUniformLocation(this._program,"smoothDegree"),this.intensity=this._intensity)},a()(t,[{key:"intensity",set:function(e){this._intensity=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._smoothDegreeUniform,this._intensity)}}]),t}(b.default);t.default=S},"./src/filter/adv/filter-blue-blind-currect.ts":
/*!*****************************************************!*\
  !*** ./src/filter/adv/filter-blue-blind-currect.ts ***!
  \*****************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=function(e){function t(t){var i;return(i=e.call(this,t)||this)._matrixList=[[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],[1,-.0806,.0806,0,0,.9379,.0621,0,0,.0105,.9895,0,0,0,0,1],[1,-.1611,.1611,0,0,.8758,.1242,0,0,.021,.979,0,0,0,0,1],[1,-.2417,.2417,0,0,.8137,.1863,0,0,.0314,.9686,0,0,0,0,1],[1,-.3223,.3223,0,0,.7515,.2485,0,0,.0419,.9581,0,0,0,0,1],[1,-.4029,.4029,0,0,.6894,.3106,0,0,.0524,.9476,0,0,0,0,1],[1,-.4834,.4834,0,0,.6273,.3727,0,0,.0629,.9371,0,0,0,0,1],[1,-.564,.564,0,0,.5652,.4348,0,0,.0734,.9266,0,0,0,0,1],[1,-.6446,.6446,0,0,.5031,.4969,0,0,.0839,.9161,0,0,0,0,1],[1,-.7251,.7251,0,0,.441,.559,0,0,.0943,.9057,0,0,0,0,1],[1,-.805712,.805712,0,0,.378838,.621162,0,0,.104823,.895177,0,0,0,0,1]],i.colorMatrixList=i._matrixList,i.intensity=5,i}return n()(t,e),t}(i(/*! ../filter-color-blind-correct */"./src/filter/filter-color-blind-correct.ts").default);t.default=o},"./src/filter/adv/filter-crayon.ts":
/*!*****************************************!*\
  !*** ./src/filter/adv/filter-crayon.ts ***!
  \*****************************************/
/*! exports provided: FILTER_CRAYON_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_CRAYON_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ../filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\nprecision mediump float;\n\nuniform sampler2D inputImageTexture;\nuniform vec2 singleStepOffset; \nuniform float strength;\n\nconst highp vec3 W = vec3(0.299,0.587,0.114);\n\nconst mat3 rgb2yiqMatrix = mat3(\n\t\t0.299, 0.587, 0.114,\n\t\t0.596,-0.275,-0.321,\n\t\t0.212,-0.523, 0.311);\n\nconst mat3 yiq2rgbMatrix = mat3(\n\t\t1.0, 0.956, 0.621,\n\t\t1.0,-0.272,-1.703,\n\t\t1.0,-1.106, 0.0);\n\n\nvoid main()\n{ \n\tvec4 oralColor = texture2D(inputImageTexture, textureCoordinate);\n\n\tvec3 maxValue = vec3(0.,0.,0.);\n\t\n\tfor(int i = -2; i<=2; i++)\n\t{\n\t\tfor(int j = -2; j<=2; j++)\n\t\t{\n\t\t\tvec4 tempColor = texture2D(inputImageTexture, textureCoordinate+singleStepOffset*vec2(i,j));\n\t\t\tmaxValue.r = max(maxValue.r,tempColor.r);\n\t\t\tmaxValue.g = max(maxValue.g,tempColor.g);\n\t\t\tmaxValue.b = max(maxValue.b,tempColor.b);\n\t\t}\n\t}\n\t\n\tvec3 textureColor = oralColor.rgb / maxValue;\n\t\n\tfloat gray = dot(textureColor, W);\n\tfloat k = 0.223529;\n\tfloat alpha = min(gray,k)/k;\n\t\n\ttextureColor = textureColor * alpha + (1.-alpha)*oralColor.rgb;\n\t\n\tvec3 yiqColor = textureColor * rgb2yiqMatrix;\n\n\tyiqColor.r = max(0.0,min(1.0,pow(gray,strength)));\n\n\ttextureColor = yiqColor * yiq2rgbMatrix;\n\t\n\tgl_FragColor = vec4(textureColor, oralColor.w);\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._singleStepOffsetUniform=null,i._strengthUniform=null,i._strength=.5,i._texelWidth=0,i._texelHeight=0,i._fragmentShader=c,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._singleStepOffsetUniform=this._gl.getUniformLocation(this._program,"singleStepOffset"),this._strengthUniform=this._gl.getUniformLocation(this._program,"strength"),this.strength=this._strength,this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight]))},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._texelWidth=1/this._inputWidth,this._texelHeight=1/this._inputHeight,this._gl&&this._isActivated&&this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight])},n()(t,[{key:"strength",set:function(e){this._strength=e,this._gl&&this._gl.uniform1f(this._strengthUniform,e)}}]),t}(s.default);t.default=u},"./src/filter/adv/filter-earlybird.ts":
/*!********************************************************!*\
  !*** ./src/filter/adv/filter-earlybird.ts + 6 modules ***!
  \********************************************************/
/*! exports provided: FILTER_EARLYBIRD_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-four-input.ts because of ./src/filter/adv/filter-hudson.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-valencia.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/res/vignette-map.ts because of ./src/filter/adv/filter-lomo.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/types/filter.ts because of ./src/filter/adv/filter-background.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_EARLYBIRD_FRAGMENT",(function(){return m}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/res/vignette-map.ts"),l=i("./src/filter/filter-group-res.ts"),d=i("./src/types/filter.ts"),h=i("./src/filter/filter-four-input.ts"),p=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fiveTexture=null,i._inputTextureUniform5=null,i._fiveInput=void 0,i._fiveInputType=d.ResourceType.texture,i._texcoordBuffer5=null,i._inputTextureCoordinateAttrib5=0,i._vertexShader="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\nattribute vec4 inputTextureCoordinate2;\nattribute vec4 inputTextureCoordinate3;\nattribute vec4 inputTextureCoordinate4;\nattribute vec4 inputTextureCoordinate5;\n\nvarying vec2 textureCoordinate;\nvarying vec2 textureCoordinate2;\nvarying vec2 textureCoordinate3;\nvarying vec2 textureCoordinate4;\nvarying vec2 textureCoordinate5;\n\nvoid main()\n{\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n    textureCoordinate2 = inputTextureCoordinate2.xy;\n    textureCoordinate3 = inputTextureCoordinate3.xy;\n    textureCoordinate4 = inputTextureCoordinate4.xy;\n    textureCoordinate5 = inputTextureCoordinate5.xy;\n}\n",i}a()(t,e);var i=t.prototype;return i.init=function(){var t=n()(c.a.mark((function t(i){var r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.prototype.init.call(this,i).then((function(e){if(!e.error){var t=r._gl;t&&(r._texcoordBuffer5=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r._texcoordBuffer5),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW))}return e})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;t&&i&&(this._inputTextureCoordinateAttrib5=t.getAttribLocation(i,"inputTextureCoordinate5"),t.enableVertexAttribArray(this._inputTextureCoordinateAttrib5),t.bindBuffer(t.ARRAY_BUFFER,this._texcoordBuffer5),t.vertexAttribPointer(this._inputTextureCoordinateAttrib5,2,t.FLOAT,!1,0,0),this._inputTextureUniform5=t.getUniformLocation(i,"inputImageTexture5"))},i.setInput=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=!1),e.prototype.setInput.call(this,t,i,r);var n=this._gl;if(n&&4===i)if(this._fiveInput=t,this._fiveInputType=this._getInputType(t),this._fiveInputType===d.ResourceType.texture){var o=this._fiveInput;this._fiveTexture=o.texture,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer),n.bindTexture(n.TEXTURE_2D,o.texture),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o.texture,0)}else this._fiveTexture=this._createAndSetupTexture(n),r&&(this._fiveInputType=d.ResourceType.texImageSourceStatic,n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this._fiveInput))},i.draw=function(){var e=this._gl;e&&this._input&&this._fiveInput&&(this._updateSize(),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE4),e.bindTexture(e.TEXTURE_2D,this._fiveTexture),this._fiveInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._fiveInput)):this._fiveInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._fiveInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._fiveInput.texture,0)),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,this._fourTexture),this._fourInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._fourInput)):this._fourInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._fourInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._fourInput.texture,0)),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this._thirdTexture),this._thirdInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._thirdInput)):this._thirdInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._thirdInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._thirdInput.texture,0)),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),this._secondInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._secondInput)):this._secondInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._secondInput.texture,0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),e.uniform1i(this._inputTextureUniform2,1),e.uniform1i(this._inputTextureUniform3,2),e.uniform1i(this._inputTextureUniform4,3),e.uniform1i(this._inputTextureUniform5,4),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._gl&&(this._gl.disableVertexAttribArray(this._inputTextureCoordinateAttrib5),this._fiveTexture&&this._gl.deleteTexture(this._fiveTexture),this._texcoordBuffer5&&this._gl.deleteBuffer(this._texcoordBuffer5)),e.prototype.destroy.call(this,t)},t}(h.default),f=function(e){function t(t){var i;return(i=e.call(this,t)||this)._sixTexture=null,i._inputTextureUniform6=null,i._sixInput=void 0,i._sixInputType=d.ResourceType.texture,i._texcoordBuffer6=null,i._inputTextureCoordinateAttrib6=0,i._vertexShader="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\nattribute vec4 inputTextureCoordinate2;\nattribute vec4 inputTextureCoordinate3;\nattribute vec4 inputTextureCoordinate4;\nattribute vec4 inputTextureCoordinate5;\nattribute vec4 inputTextureCoordinate6;\n\nvarying vec2 textureCoordinate;\nvarying vec2 textureCoordinate2;\nvarying vec2 textureCoordinate3;\nvarying vec2 textureCoordinate4;\nvarying vec2 textureCoordinate5;\nvarying vec2 textureCoordinate6;\n\nvoid main()\n{\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n    textureCoordinate2 = inputTextureCoordinate2.xy;\n    textureCoordinate3 = inputTextureCoordinate3.xy;\n    textureCoordinate4 = inputTextureCoordinate4.xy;\n    textureCoordinate5 = inputTextureCoordinate5.xy;\n    textureCoordinate6 = inputTextureCoordinate6.xy;\n}\n",i}a()(t,e);var i=t.prototype;return i.init=function(){var t=n()(c.a.mark((function t(i){var r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.prototype.init.call(this,i).then((function(e){if(!e.error){var t=r._gl;t&&(r._texcoordBuffer6=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r._texcoordBuffer6),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW))}return e})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;t&&i&&(this._inputTextureCoordinateAttrib6=t.getAttribLocation(i,"inputTextureCoordinate6"),t.enableVertexAttribArray(this._inputTextureCoordinateAttrib6),t.bindBuffer(t.ARRAY_BUFFER,this._texcoordBuffer6),t.vertexAttribPointer(this._inputTextureCoordinateAttrib6,2,t.FLOAT,!1,0,0),this._inputTextureUniform6=t.getUniformLocation(i,"inputImageTexture6"))},i.setInput=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=!1),e.prototype.setInput.call(this,t,i,r);var n=this._gl;if(n&&5===i)if(this._sixInput=t,this._sixInputType=this._getInputType(t),this._sixInputType===d.ResourceType.texture){var o=this._sixInput;this._sixTexture=o.texture,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer),n.bindTexture(n.TEXTURE_2D,o.texture),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o.texture,0)}else this._sixTexture=this._createAndSetupTexture(n),r&&(this._sixInputType=d.ResourceType.texImageSourceStatic,n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this._sixInput))},i.draw=function(){var e=this._gl;e&&this._input&&this._sixInput&&(this._updateSize(),e.activeTexture(e.TEXTURE5),e.bindTexture(e.TEXTURE_2D,this._sixTexture),this._sixInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._sixInput)):this._sixInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._sixInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._sixInput.texture,0)),e.activeTexture(e.TEXTURE4),e.bindTexture(e.TEXTURE_2D,this._fiveTexture),this._fiveInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._fiveInput)):this._fiveInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._fiveInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._fiveInput.texture,0)),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,this._fourTexture),this._fourInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._fourInput)):this._fourInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._fourInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._fourInput.texture,0)),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this._thirdTexture),this._thirdInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._thirdInput)):this._thirdInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._thirdInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._thirdInput.texture,0)),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),this._secondInputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._secondInput)):this._secondInputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._secondInput.texture,0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===d.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),e.uniform1i(this._inputTextureUniform2,1),e.uniform1i(this._inputTextureUniform3,2),e.uniform1i(this._inputTextureUniform4,3),e.uniform1i(this._inputTextureUniform5,4),e.uniform1i(this._inputTextureUniform6,5),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._gl&&(this._gl.disableVertexAttribArray(this._inputTextureCoordinateAttrib6),this._sixTexture&&this._gl.deleteTexture(this._sixTexture),this._texcoordBuffer6&&this._gl.deleteBuffer(this._texcoordBuffer6)),e.prototype.destroy.call(this,t)},t}(p),m="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2; //earlyBirdCurves\nuniform sampler2D inputImageTexture3; //earlyBirdOverlay\nuniform sampler2D inputImageTexture4; //vig\nuniform sampler2D inputImageTexture5; //earlyBirdBlowout\nuniform sampler2D inputImageTexture6; //earlyBirdMap\n\nconst mat3 saturate = mat3(\n                           1.210300,\n                           -0.089700,\n                           -0.091000,\n                           -0.176100,\n                           1.123900,\n                           -0.177400,\n                           -0.034200,\n                           -0.034200,\n                           1.265800);\nconst vec3 rgbPrime = vec3(0.25098, 0.14640522, 0.0);\nconst vec3 desaturate = vec3(.3, .59, .11);\n\nvoid main()\n{\n    \n    vec3 texel = texture2D(inputImageTexture, textureCoordinate).rgb;\n    \n    \n    vec2 lookup;\n    lookup.y = 0.5;\n    \n    lookup.x = texel.r;\n    texel.r = texture2D(inputImageTexture2, lookup).r;\n    \n    lookup.x = texel.g;\n    texel.g = texture2D(inputImageTexture2, lookup).g;\n    \n    lookup.x = texel.b;\n    texel.b = texture2D(inputImageTexture2, lookup).b;\n    \n    float desaturatedColor;\n    vec3 result;\n    desaturatedColor = dot(desaturate, texel);\n    \n    \n    lookup.x = desaturatedColor;\n    result.r = texture2D(inputImageTexture3, lookup).r;\n    lookup.x = desaturatedColor;\n    result.g = texture2D(inputImageTexture3, lookup).g;\n    lookup.x = desaturatedColor;\n    result.b = texture2D(inputImageTexture3, lookup).b;\n    \n    texel = saturate * mix(texel, result, .5);\n    \n    vec2 tc = (2.0 * textureCoordinate) - 1.0;\n    float d = dot(tc, tc);\n    \n    vec3 sampled;\n    lookup.y = .5;\n    \n    /*\n     lookup.x = texel.r;\n     sampled.r = texture2D(inputImageTexture4, lookup).r;\n     \n     lookup.x = texel.g;\n     sampled.g = texture2D(inputImageTexture4, lookup).g;\n     \n     lookup.x = texel.b;\n     sampled.b = texture2D(inputImageTexture4, lookup).b;\n     \n     float value = smoothstep(0.0, 1.25, pow(d, 1.35)/1.65);\n     texel = mix(texel, sampled, value);\n     */\n    \n    //---\n    \n    lookup = vec2(d, texel.r);\n    texel.r = texture2D(inputImageTexture4, lookup).r;\n    lookup.y = texel.g;\n    texel.g = texture2D(inputImageTexture4, lookup).g;\n    lookup.y = texel.b;\n    texel.b\t= texture2D(inputImageTexture4, lookup).b;\n    float value = smoothstep(0.0, 1.25, pow(d, 1.35)/1.65);\n    \n    //---\n    \n    lookup.x = texel.r;\n    sampled.r = texture2D(inputImageTexture5, lookup).r;\n    lookup.x = texel.g;\n    sampled.g = texture2D(inputImageTexture5, lookup).g;\n    lookup.x = texel.b;\n    sampled.b = texture2D(inputImageTexture5, lookup).b;\n    texel = mix(sampled, texel, value);\n    \n    \n    lookup.x = texel.r;\n    texel.r = texture2D(inputImageTexture6, lookup).r;\n    lookup.x = texel.g;\n    texel.g = texture2D(inputImageTexture6, lookup).g;\n    lookup.x = texel.b;\n    texel.b = texture2D(inputImageTexture6, lookup).b;\n    \n    gl_FragColor = vec4(texel, texture2D(inputImageTexture, textureCoordinate).a);\n}\n",g=function(e){function t(t){var i;return(i=e.call(this,t)||this)._six=void 0,i._image=void 0,i._image2=void 0,i._image3=void 0,i._image4=void 0,i._image5=void 0,i._six=new f(t),i._image={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAIGNIUk0AAG2YAABzjgAA2e0AAIGfAAB/mgAA2GMAADIXAAAdLVvevdMAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAiSURBVDjLY2RgYPjPyMjIAMEMDAj2qNhIEWNgGA2HkSoGAI1oA8gFKQ7kAAAAAElFTkSuQmCC"},i._image2={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAIGNIUk0AAG2YAABzjgAA2e0AAIGfAAB/mgAA2GMAADIXAAAdLVvevdMAAAAJcEhZcwAACxMAAAsTAQCanBgAAABBSURBVDjLY2RgYPjPyMjIwMjIwAChGRkYGdD4jDj4DATk4WYRYR7DELWP2PAixj5i3U/l+GGAu41+do7G0eBIEwA97QOgFIn10AAAAABJRU5ErkJggg=="},i._image3={src:u.VIGNETTE_MAP},i._image4={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAIGNIUk0AAG2YAABzjgAA2e0AAIGfAAB/mgAA2GMAADIXAAAdLVvevdMAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAlSURBVDjLY2RgYPjPyMjIwMTExIBMj4qNHDEYgInD2KNiw18MACXoA/szUKleAAAAAElFTkSuQmCC"},i._image5={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAIGNIUk0AAG2YAABzjgAA2e0AAIGfAAB/mgAA2GMAADIXAAAdLVvevdMAAAAJcEhZcwAACxMAAAsTAQCanBgAAABWSURBVDjLtZPJEQAgCMSyJViA/ZepDQByjA9+OxuIozbrSAIJuQPvjIwMiYzXQ4FjMzMcO0djX//eXE/Xsc2l0AEM3ooyb+45dv3P85//kPNHc9/Y8QVOZQP7gpOmSwAAAABJRU5ErkJggg=="},i._res.setQueue([i._image,i._image2,i._image3,i._image4,i._image5]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._six.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._six),e.abrupt("return",this._six.init({fragment:m}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&this._image2.img&&this._image3.img&&this._image4.img&&this._image5.img&&(this._six.active(),this._six.setInput(this._image.img,1,!0),this._six.setInput(this._image2.img,2,!0),this._six.setInput(this._image3.img,3,!0),this._six.setInput(this._image4.img,4,!0),this._six.setInput(this._image5.img,5,!0),this._resUploaded=!0)},t}(l.default);t.default=g},"./src/filter/adv/filter-green-blind-currect.ts":
/*!******************************************************!*\
  !*** ./src/filter/adv/filter-green-blind-currect.ts ***!
  \******************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=function(e){function t(t){var i;return(i=e.call(this,t)||this)._matrixList=[[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],[1.0989,-.135,.0362,0,0,1,0,0,-.0312,.0354,.9958,0,0,0,0,1],[1.1759,-.2416,.0657,0,0,1,0,0,-.0574,.0642,.9932,0,0,0,0,1],[1.2369,-.3273,.0904,0,0,1,0,0,-.0798,.088,.9918,0,0,0,0,1],[1.2858,-.3972,.1114,0,0,1,0,0,-.0993,.1082,.9912,0,0,0,0,1],[1.3253,-.455,.1297,0,0,1,0,0,-.1168,.1255,.9913,0,0,0,0,1],[1.49,-.6574,.1674,0,.2526,.6514,.096,0,-.3541,.4465,.9076,0,0,0,0,1],[1.5314,-.7144,.1831,0,.2729,.6217,.1054,0,-.3851,.4843,.9008,0,0,0,0,1],[1.5669,-.7639,.197,0,.2901,.5961,.1139,0,-.4119,.5168,.8952,0,0,0,0,1],[1.5669,-.7639,.197,0,.2901,.5961,.1139,0,-.4119,.5168,.8952,0,0,0,0,1],[1.4027,-.8266,.424,0,.174,.6429,.1832,0,-.2818,.5784,.7032,0,0,0,0,1]],i.colorMatrixList=i._matrixList,i.intensity=5,i}return n()(t,e),t}(i(/*! ../filter-color-blind-correct */"./src/filter/filter-color-blind-correct.ts").default);t.default=o},"./src/filter/adv/filter-hudson.ts":
/*!*****************************************************!*\
  !*** ./src/filter/adv/filter-hudson.ts + 3 modules ***!
  \*****************************************************/
/*! exports provided: FILTER_HUDSON_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-four-input.ts because of ./src/filter/adv/filter-earlybird.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-valencia.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_HUDSON_FRAGMENT",(function(){return d}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/filter/filter-four-input.ts"),l=i("./src/filter/filter-group-res.ts"),d="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2; //blowout;\nuniform sampler2D inputImageTexture3; //overlay;\nuniform sampler2D inputImageTexture4; //map\n\nvoid main()\n{\n    \n    vec4 texel = texture2D(inputImageTexture, textureCoordinate);\n    \n    vec3 bbTexel = texture2D(inputImageTexture2, textureCoordinate).rgb;\n    \n    texel.r = texture2D(inputImageTexture3, vec2(bbTexel.r, texel.r)).r;\n    texel.g = texture2D(inputImageTexture3, vec2(bbTexel.g, texel.g)).g;\n    texel.b = texture2D(inputImageTexture3, vec2(bbTexel.b, texel.b)).b;\n    \n    vec4 mapped;\n    mapped.r = texture2D(inputImageTexture4, vec2(texel.r, .16666)).r;\n    mapped.g = texture2D(inputImageTexture4, vec2(texel.g, .5)).g;\n    mapped.b = texture2D(inputImageTexture4, vec2(texel.b, .83333)).b;\n    mapped.a = texel.a;\n    gl_FragColor = mapped;\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._four=void 0,i._image=void 0,i._image2=void 0,i._image3=void 0,i._four=new u.default(t),i._image={src:"data:image/jpg;base64,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"},i._image2={src:"data:image/png;base64,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"},i._image3={src:"data:image/png;base64,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"},i._res.setQueue([i._image,i._image2,i._image3]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._four.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._four),e.abrupt("return",this._four.init({fragment:d}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&this._image2.img&&this._image3.img&&(this._four.active(),this._four.setInput(this._image.img,1,!0),this._four.setInput(this._image2.img,2,!0),this._four.setInput(this._image3.img,3,!0),this._resUploaded=!0)},t}(l.default);t.default=h},"./src/filter/adv/filter-inkwell.ts":
/*!******************************************************!*\
  !*** ./src/filter/adv/filter-inkwell.ts + 1 modules ***!
  \******************************************************/
/*! exports provided: FILTER_INKWELL_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-valencia.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-two-input.ts because of ./src/filter/filter-unsharp-mask.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_INKWELL_FRAGMENT",(function(){return d}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/filter/filter-group-res.ts"),l=i("./src/filter/filter-two-input.ts"),d="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\n\nvoid main()\n{\n    vec3 texel = texture2D(inputImageTexture, textureCoordinate).rgb;\n    texel = vec3(dot(vec3(0.3, 0.6, 0.1), texel));\n    texel = vec3(texture2D(inputImageTexture2, vec2(texel.r, .16666)).r);\n    gl_FragColor = vec4(texel, texture2D(inputImageTexture, textureCoordinate).a);\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._two=void 0,i._image=void 0,i._two=new l.default(t),i._image={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAADCAYAAAB8kdF8AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAGJJREFUSMftlEEKACEMA6f9/5/dg5dlD8HW9WSE0iQtiAgTwAhgtXJzL5uZ8n9olXV23v3ErPIOpYN5cuP/ThaFHOG7msJspXcypTv+e9/ABDABTIArCTABYAKYACbAlQR4ABZwBf7HB/NZAAAAAElFTkSuQmCC"},i._res.setQueue([i._image]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._two.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._two),e.abrupt("return",this._two.init({fragment:d}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&(this._two.active(),this._two.setInput(this._image.img,1,!0),this._resUploaded=!0)},t}(u.default);t.default=h},"./src/filter/adv/filter-kelvin.ts":
/*!*****************************************************!*\
  !*** ./src/filter/adv/filter-kelvin.ts + 1 modules ***!
  \*****************************************************/
/*! exports provided: FILTER_KELVIN_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-valencia.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-two-input.ts because of ./src/filter/filter-unsharp-mask.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_KELVIN_FRAGMENT",(function(){return d}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/filter/filter-group-res.ts"),l=i("./src/filter/filter-two-input.ts"),d="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\n\nvoid main()\n{\n    vec4 texel = texture2D(inputImageTexture, textureCoordinate);\n    \n    vec2 lookup;\n    lookup.y = .5;\n    \n    lookup.x = texel.r;\n    texel.r = texture2D(inputImageTexture2, lookup).r;\n    \n    lookup.x = texel.g;\n    texel.g = texture2D(inputImageTexture2, lookup).g;\n    \n    lookup.x = texel.b;\n    texel.b = texture2D(inputImageTexture2, lookup).b;\n    \n    gl_FragColor = texel;\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._two=void 0,i._image=void 0,i._two=new l.default(t),i._image={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAO1JREFUOMulk0FywDAIA3eF8/8ntwdw4mR6ay5gIQQMROBHIQGBCKYtGxdC21fsw4/DHXvyv/jW+3IV6uRNXy/sD3vWL2FtLG/8y9vvOmatPZ9Q+XCmz/ojfuK7BgWXEIOGMlhFXIN1jAQtgmgNt3A5vAtT4zen99N5pvWTzsULDKawGtv1caGrYwao8ddduzWZoTL1gjz6Gsw1/QSsmSOjn3uJrfv4cGDunO3X6yisBTp1nqU7B2Nf0+Tu2NZg3o5Gbu27P2mNrX/we4nvY7375PwxbOrs9Mz1+HncPTFHBrf1wB7fG3m42///9wuU6gP4cc1nRgAAAABJRU5ErkJggg=="},i._res.setQueue([i._image]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._two.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._two),e.abrupt("return",this._two.init({fragment:d}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&(this._two.active(),this._two.setInput(this._image.img,1,!0),this._resUploaded=!0)},t}(u.default);t.default=h},"./src/filter/adv/filter-lomo.ts":
/*!***************************************************!*\
  !*** ./src/filter/adv/filter-lomo.ts + 1 modules ***!
  \***************************************************/
/*! exports provided: FILTER_LOMO_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-valencia.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-three-input.ts because of ./src/filter/adv/filter-beauty.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/res/vignette-map.ts because of ./src/filter/adv/filter-earlybird.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_LOMO_FRAGMENT",(function(){return h}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/res/vignette-map.ts"),l=i("./src/filter/filter-group-res.ts"),d=i("./src/filter/filter-three-input.ts"),h="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\nuniform sampler2D inputImageTexture3;\n\nvoid main()\n{\n    \n    vec4 texel = texture2D(inputImageTexture, textureCoordinate);\n    \n    vec2 red = vec2(texel.r, 0.16666);\n    vec2 green = vec2(texel.g, 0.5);\n    vec2 blue = vec2(texel.b, 0.83333);\n    \n    texel.rgb = vec3(\n                     texture2D(inputImageTexture2, red).r,\n                     texture2D(inputImageTexture2, green).g,\n                     texture2D(inputImageTexture2, blue).b);\n    \n    vec2 tc = (2.0 * textureCoordinate) - 1.0;\n    float d = dot(tc, tc);\n    vec2 lookup = vec2(d, texel.r);\n    texel.r = texture2D(inputImageTexture3, lookup).r;\n    lookup.y = texel.g;\n    texel.g = texture2D(inputImageTexture3, lookup).g;\n    lookup.y = texel.b;\n    texel.b\t= texture2D(inputImageTexture3, lookup).b;\n    \n    gl_FragColor = texel;\n}\n",p=function(e){function t(t){var i;return(i=e.call(this,t)||this)._three=void 0,i._image=void 0,i._image2=void 0,i._three=new d.default(t),i._image={src:"data:image/png;base64,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"},i._image2={src:u.VIGNETTE_MAP},i._res.setQueue([i._image,i._image2]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._three.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._three),e.abrupt("return",this._three.init({fragment:h}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&this._image2.img&&(this._three.active(),this._three.setInput(this._image.img,1,!0),this._three.setInput(this._image2.img,2,!0),this._resUploaded=!0)},t}(l.default);t.default=p},"./src/filter/adv/filter-mix.ts":
/*!**************************************!*\
  !*** ./src/filter/adv/filter-mix.ts ***!
  \**************************************/
/*! exports provided: FILTER_MIX_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_MIX_FRAGMENT",(function(){return u}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ../filter-group */"./src/filter/filter-group.ts"),c=i(/*! ../filter-two-input */"./src/filter/filter-two-input.ts"),u="\nprecision mediump float;\n\nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2;\n\nuniform vec2 singleStepOffset;\nuniform vec4 viewport;\n\nconst highp vec3 W = vec3(0.299, 0.587, 0.114);\n\nvec3 greyscale(){\n    return vec3(dot(\n        W,\n        texture2D(inputImageTexture, textureCoordinate).rgb\n        ));\n}\n\nvec3 sepia(){\n    return texture2D(inputImageTexture, textureCoordinate).rgb * mat3(\n        0.3588, 0.7044, 0.1368,\n        0.2990, 0.5870, 0.1140,\n        0.2392, 0.4696, 0.0912\n        );\n}\n\nvec3 base(){\n    return texture2D(inputImageTexture, textureCoordinate).rgb;\n}\n\nvec3 binary() {\n    vec3 color = texture2D(inputImageTexture, textureCoordinate).rgb;\n    if (color.r + color.g + color.b > 1.5) {\n        return vec3(1, 1, 1);\n    } else {\n        return vec3(0, 0, 0);\n    }\n}\n\nvec3 sketch(){\n    float threshold = 0.;\n\n    vec4 oralColor = texture2D(inputImageTexture, textureCoordinate);\n\n    vec3 maxValue = vec3(0.);\n\n    for (int i = -2; i<=2; i++) {\n\t\tfor(int j = -2; j<=2; j++) {\n            vec4 tempColor = texture2D(inputImageTexture, textureCoordinate +singleStepOffset*vec2(i,j));\n\t\t\tmaxValue = max(maxValue, tempColor.rgb);\n\t\t\tthreshold += dot(tempColor.rgb, W);\n\t\t}\n    }\n    float gray1 = dot(oralColor.rgb, W);\n\t\n\t//pic4\n\tfloat gray2 = dot(maxValue, W);\n\t\n\t//pic5\n\tfloat contour = gray1 / gray2;\n\n\tthreshold = threshold / 25.;\n\tfloat alpha = max(1.0,gray1>threshold?1.0:(gray1/threshold));\n\tfloat result = contour * alpha + (1.0-alpha)*gray1;\n\treturn vec3(result,result,result);\n}\n\nvoid main(){\n    vec2 canvasCoord = vec2(textureCoordinate.x * viewport[2] + viewport[0], (1. - textureCoordinate.y) * viewport[3] + viewport[1]);\n\n    float filterIdx = 255. * texture2D(inputImageTexture2, canvasCoord).r;\n\n    vec3 color = base();\n    if (filterIdx < 10.) {\n        color = base();\n    } else if(filterIdx < 20.) {\n        color = sepia();\n    } else if(filterIdx < 30.) {\n        color = greyscale();\n    } else if(filterIdx < 40.) {\n        color = sketch();\n    } else if (filterIdx < 50.) {\n        color = binary();\n    } else {\n        color = base();\n    }\n\n    gl_FragColor = vec4(color, 1.);\n}\n",l=function(e){function t(t){var i;return(i=e.call(this,t)||this)._mixCanvas=void 0,i._two=void 0,i._two=new d(i._gl),i.addFilter(i._two),i}a()(t,e);var i=t.prototype;return i.setInput=function(e){this._input=e,this._two.setInput(e)},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t)},i.destroy=function(t){void 0===t&&(t=!1),this._mixCanvas=void 0,this._two.destroy(),e.prototype.destroy.call(this,t)},i.draw=function(){this._mixCanvas&&this._input&&this._two.draw()},n()(t,[{key:"mixCanvas",set:function(e){this._mixCanvas=e,this._two.setInput(this._mixCanvas,1)}}]),t}(s.default),d=function(e){function t(t){var i;return(i=e.call(this,t)||this)._viewportUniform=null,i._singleStepOffsetUniform=null,i._singleStepOffset=0,i._texelWidth=0,i._texelHeight=0,i._fragmentShader=u,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._gl&&this._program&&(this._viewportUniform=this._gl.getUniformLocation(this._program,"viewport"),this._singleStepOffsetUniform=this._gl.getUniformLocation(this._program,"singleStepOffset"),this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight]))},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._texelWidth=1/this._inputWidth,this._texelHeight=1/this._inputHeight,this._gl&&this._isActivated&&this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight])},i._updateSize=function(){if(e.prototype._updateSize.call(this),this._gl&&this._isActivated){var t=this._viewport;t.x?this._gl.uniform4fv(this._viewportUniform,[t.x/(t.w+2*t.x),0,t.w/(t.w+2*t.x),1]):this._gl.uniform4fv(this._viewportUniform,[0,t.y/(t.h+2*t.y),1,t.h/(t.h+2*t.y)])}},t}(c.default);t.default=l},"./src/filter/adv/filter-red-blind-currect.ts":
/*!****************************************************!*\
  !*** ./src/filter/adv/filter-red-blind-currect.ts ***!
  \****************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=function(e){function t(t){var i;return(i=e.call(this,t)||this)._matrixList=[[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],[1.0849,-.1048,.02,0,.0692,.9158,.0149,0,.1658,-.2117,1.0459,0,0,0,0,1],[1.1571,-.1933,.0361,0,.1288,.8442,.027,0,.3035,-.3869,1.0834,0,0,0,0,1],[1.2199,-.2693,.0495,0,.1812,.7819,.0369,0,.42,-.5344,1.1144,0,0,0,0,1],[1.2752,-.3358,.0606,0,.2279,.727,.0452,0,.5201,-.6605,1.1404,0,0,0,0,1],[1.2752,-.3358,.0606,0,.2279,.727,.0452,0,.5201,-.6605,1.1404,0,0,0,0,1],[1.3247,-.3947,.07,0,.2701,.6777,.0521,0,.6073,-.7698,1.1625,0,0,0,0,1],[1.3696,-.4476,.078,0,.3088,.6332,.058,0,.6839,-.8654,1.1814,0,0,0,0,1],[1.4106,-.4955,.0849,0,.3446,.5923,.0631,0,.7521,-.9499,1.1978,0,0,0,0,1],[1.4484,-.5393,.0909,0,.3779,.5546,.0675,0,.8131,-1.0252,1.212,0,0,0,0,1],[1.4836,-.5798,.0962,0,.4092,.5194,.0714,0,.8683,-1.0928,1.2245,0,0,0,0,1],[1,0,0,0,.5836,.4146,0,0,.6384,-.6384,1,0,0,0,0,1]],i.colorMatrixList=i._matrixList,i.intensity=5,i}return n()(t,e),t}(i(/*! ../filter-color-blind-correct */"./src/filter/filter-color-blind-correct.ts").default);t.default=o},"./src/filter/adv/filter-sketch-2.ts":
/*!*******************************************!*\
  !*** ./src/filter/adv/filter-sketch-2.ts ***!
  \*******************************************/
/*! exports provided: FILTER_SKETCH2_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_SKETCH2_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ../filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\nprecision mediump float;\n\nuniform sampler2D inputImageTexture;\nuniform vec2 singleStepOffset; \nuniform float strength;\n\nconst highp vec3 W = vec3(0.299,0.587,0.114);\n\n\nvoid main()\n{ \n\tfloat threshold = 0.0;\n\t//pic1\n\tvec4 oralColor = texture2D(inputImageTexture, textureCoordinate);\n\t\n\t//pic2\n\tvec3 maxValue = vec3(0.,0.,0.);\n\t\n\tfor(int i = -2; i<=2; i++)\n\t{\n\t\tfor(int j = -2; j<=2; j++)\n\t\t{\n\t\t\tvec4 tempColor = texture2D(inputImageTexture, textureCoordinate+singleStepOffset*vec2(i,j));\n\t\t\tmaxValue.r = max(maxValue.r,tempColor.r);\n\t\t\tmaxValue.g = max(maxValue.g,tempColor.g);\n\t\t\tmaxValue.b = max(maxValue.b,tempColor.b);\n\t\t\tthreshold += dot(tempColor.rgb, W);\n\t\t}\n\t}\n\t//pic3\n\tfloat gray1 = dot(oralColor.rgb, W);\n\t\n\t//pic4\n\tfloat gray2 = dot(maxValue, W);\n\t\n\t//pic5\n\tfloat contour = gray1 / gray2;\n\n\tthreshold = threshold / 25.;\n\tfloat alpha = max(1.0,gray1>threshold?1.0:(gray1/threshold));\n\t\n\tfloat result = contour * alpha + (1.0-alpha)*gray1;\n\t\n\tgl_FragColor = vec4(vec3(result,result,result), oralColor.w);\n} \n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._singleStepOffsetUniform=null,i._strengthUniform=null,i._strength=.5,i._texelWidth=0,i._texelHeight=0,i._fragmentShader=c,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._singleStepOffsetUniform=this._gl.getUniformLocation(this._program,"singleStepOffset"),this._strengthUniform=this._gl.getUniformLocation(this._program,"strength"),this.strength=this._strength,this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight]))},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._texelWidth=1/this._inputWidth,this._texelHeight=1/this._inputHeight,this._gl&&this._isActivated&&this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight])},n()(t,[{key:"strength",set:function(e){this._strength=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._strengthUniform,e)}}]),t}(s.default);t.default=u},"./src/filter/adv/filter-sketch-interactive.ts":
/*!*****************************************************!*\
  !*** ./src/filter/adv/filter-sketch-interactive.ts ***!
  \*****************************************************/
/*! exports provided: FILTER_SKETCH_INTERACTIVE_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_SKETCH_INTERACTIVE_FRAGMENT",(function(){return u}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ../filter-base */"./src/filter/filter-base.ts"),c=i(/*! ../../utils/pixel-ratio */"./src/utils/pixel-ratio.ts"),u="\nprecision mediump float;\n\nvarying vec2 textureCoordinate;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\nuniform vec2 singleStepOffset; \nuniform sampler2D inputImageTexture;\n\n\n/* Adapted from Robert Penner easing equations */\n#define PI_TWO 1.570796326794897\n\nconst vec3 W = vec3(0.299,0.587,0.114);\n\nvoid main (){\n    float threshold = 0.;\n    vec4 oralColor = texture2D(inputImageTexture, textureCoordinate);\n    vec2 center = mouse;\n    center.x = center.x / resolution.x;\n    center.y = (resolution.y - center.y) / resolution.x;\n    // center.y = center.y* resolution.y / resolution.x;\n    vec2 poi = textureCoordinate;\n    poi.y = poi.y * resolution.y / resolution.x;\n    float len = length(center - poi);\n\n    if(len < .08){\n        gl_FragColor = oralColor;\n        return ;\n    }\n    float pre = smoothstep(.08 , .14,len);\n\n    vec3 maxValue = vec3(0.);\n\n    for(int i= -2 ; i<=2 ;i++){\n        for(int j=-2 ; j <=2 ;j++){\n            vec4 tempColor = texture2D(inputImageTexture, textureCoordinate + singleStepOffset*vec2( float(i),float(j) ));\n\n            maxValue = max(maxValue , tempColor.rgb);\n\n            threshold += dot(tempColor.rgb , W );\n        }\n    }\n\n    float gray1 = dot(oralColor.rgb , W);\n\n    float gray2 = dot(maxValue, W);\n\n    float contour = gray1 / gray2;\n\n    threshold = threshold / 25.;\n\n    // float alpha = gray1 > threshold ? 1. : 0.;\n    float alpha = (gray1/threshold);\n    // float alpha = gray1 > threshold ? 1. : (gray1/threshold);\n\n    float result = contour * alpha + (1. - alpha)* gray1;\n\n    gl_FragColor = mix(vec4(vec3(result) , oralColor.a) , oralColor, 1.-pre);\n}\n",l=function(e){function t(t){var i;return(i=e.call(this,t)||this)._singleStepOffsetUniform=null,i._mouseUniform=null,i._resolutionUniform=null,i._texelWidth=0,i._texelHeight=0,i._mouse=[.5,.5],i._resolution=[1,1],i._fragmentShader=u,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._singleStepOffsetUniform=this._gl.getUniformLocation(this._program,"singleStepOffset"),this._mouseUniform=this._gl.getUniformLocation(this._program,"mouse"),this._resolutionUniform=this._gl.getUniformLocation(this._program,"resolution"),this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight]),this.mouse=[this._gl.canvas.width/2,this._gl.canvas.height/2],this._gl.canvas instanceof HTMLCanvasElement?this.resolution=[this._gl.canvas.clientWidth,this._gl.canvas.clientHeight]:this.resolution=[this._gl.canvas.width,this._gl.canvas.height])},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._texelWidth=1/this._inputWidth,this._texelHeight=1/this._inputHeight,this._gl&&this._isActivated&&this._gl.uniform2fv(this._singleStepOffsetUniform,[this._texelWidth,this._texelHeight])},i._updateSize=function(){e.prototype._updateSize.call(this);var t=c.PixelRatio.pixelRatio;this.resolution=[this._viewport.w/t,this._viewport.h/t]},n()(t,[{key:"mouse",set:function(e){var t=c.PixelRatio.pixelRatio;e[0]=e[0]-this._viewport.x/t,e[1]=e[1]-this._viewport.y/t,this._mouse=e,this._gl&&this._isActivated&&this._gl.uniform2fv(this._mouseUniform,e)}},{key:"resolution",set:function(e){this._resolution=e,this._gl&&this._isActivated&&this._gl.uniform2fv(this._resolutionUniform,e)}}]),t}(s.default);t.default=l},"./src/filter/adv/filter-valencia.ts":
/*!*******************************************************!*\
  !*** ./src/filter/adv/filter-valencia.ts + 2 modules ***!
  \*******************************************************/
/*! exports provided: FILTER_VALENCIA_FRAGMENT, default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group-res.ts because of ./src/filter/adv/filter-lomo.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-three-input.ts because of ./src/filter/adv/filter-beauty.ts */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_VALENCIA_FRAGMENT",(function(){return d}));var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i("./src/filter/filter-group-res.ts"),l=i("./src/filter/filter-three-input.ts"),d="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2; //map\nuniform sampler2D inputImageTexture3; //gradMap\n\nmat3 saturateMatrix = mat3(\n                           1.1402,\n                           -0.0598,\n                           -0.061,\n                           -0.1174,\n                           1.0826,\n                           -0.1186,\n                           -0.0228,\n                           -0.0228,\n                           1.1772);\n\nvec3 lumaCoeffs = vec3(.3, .59, .11);\n\nvoid main()\n{\n    vec3 texel = texture2D(inputImageTexture, textureCoordinate).rgb;\n    \n    texel = vec3(\n                 texture2D(inputImageTexture2, vec2(texel.r, .1666666)).r,\n                 texture2D(inputImageTexture2, vec2(texel.g, .5)).g,\n                 texture2D(inputImageTexture2, vec2(texel.b, .8333333)).b\n                 );\n    \n    texel = saturateMatrix * texel;\n    float luma = dot(lumaCoeffs, texel);\n    texel = vec3(\n                 texture2D(inputImageTexture3, vec2(luma, texel.r)).r,\n                 texture2D(inputImageTexture3, vec2(luma, texel.g)).g,\n                 texture2D(inputImageTexture3, vec2(luma, texel.b)).b);\n    \n    gl_FragColor = vec4(texel, texture2D(inputImageTexture, textureCoordinate).a);\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._three=void 0,i._image=void 0,i._image2=void 0,i._three=new l.default(t),i._image={src:"data:image/png;base64,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"},i._image2={src:"data:image/png;base64,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"},i._res.setQueue([i._image,i._image2]),i._res.start(),i}a()(t,e);var i=t.prototype;return i.active=function(){this._three.active()},i.init=function(){var e=n()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addFilter(this._three),e.abrupt("return",this._three.init({fragment:d}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setResInput=function(){!this._resUploaded&&this._res.ready&&this._image.img&&this._image2.img&&(this._three.active(),this._three.setInput(this._image.img,1,!0),this._three.setInput(this._image2.img,2,!0),this._resUploaded=!0)},t}(u.default);t.default=h},"./src/filter/adv/filter-virtual-background-kwai.ts":
/*!***********************************************************************!*\
  !*** ./src/filter/adv/filter-virtual-background-kwai.ts + 18 modules ***!
  \***********************************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/createClass.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/config.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/errors.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/tf-urls.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/worker-cmd.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-base.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group.ts because of ./src/filter/filter-unsharp-mask.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-three-input.ts because of ./src/filter/adv/filter-beauty.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-two-input.ts because of ./src/filter/filter-unsharp-mask.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/types/filter.ts because of ./src/filter/adv/filter-background.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/types/main.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/log.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/tex-helper.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/tex-proxy.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/tf-utils.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/worker-utils.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/url-toolkit/src/url-toolkit.js (<- Module is not an ECMAScript module) */function(e,t,i){"use strict";i.r(t);var r=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/createClass.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),c=i.n(s),u=i("./node_modules/@babel/runtime/regenerator/index.js"),l=i.n(u),d=i("./src/utils/log.ts"),h=i("./src/core/worker-cmd.ts"),p="resize-wm",f=function(){function e(){var e=this;this._workers=[],this._taskIdx=1,this._lastOutputIdx=0,this._outputQueue=[],this._inputQueue=[],this._onMessage=function(t){var i=t.data;if("resized"===i.event&&i.input&&i.output){var r=e._getWorkerByTaskIdx(i.idx);if(r&&(r.idx=0),i.idx<=e._lastOutputIdx)return;e._outputQueue.push(i),e._outputQueue.sort((function(e,t){return e.idx-t.idx})),e._outputQueue.length>2+e._workers.length&&(d.Log.i(p,"output queue is full: "+e._outputQueue.length+" shift first frame."),e._outputQueue.shift()),e._resizeNext()}}}var t=e.prototype;return t.init=function(){var e=n()(l.a.mark((function e(t){var i,r,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(d.Log.i(p,"init resize worker: "+t),i=[],r=0;r<t;r++)i.push(this._initWorker());return e.abrupt("return",Promise.all(i).then((function(e){return e.filter((function(e){return!e})).length?(d.Log.i(p,"init resize worker error"),!1):(e.forEach((function(e){e&&(n._workers.push({w:e,idx:0}),e.addEventListener("message",n._onMessage))})),!0)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.resize=function(e,t,i){return this._inputQueue.length>this._workers.length+2?(d.Log.i(p,"input queue is full: "+this._inputQueue.length+". drop frame"),!1):(this._inputQueue.push({input:e,width:t,height:i}),this._resizeNext(),!0)},t.getResult=function(){var e=this._outputQueue.shift();return e&&(this._lastOutputIdx=e.idx),e},t.destroy=function(){var e=this;this._workers.forEach((function(t){t.w.removeEventListener("message",e._onMessage),t.w.terminate()})),this._workers=[],this._outputQueue=[],this._inputQueue=[]},t._initWorker=function(){var e=n()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t,i=(t=new Blob(["\nvar canvas = new OffscreenCanvas(1, 1);\nvar ctx = canvas.getContext('2d');\nvar list = [];\n\nfunction run(source, w, h) {\n    if (!ctx || !canvas) return;\n    if (source instanceof ImageData) return;\n    if (typeof ImageBitmap !== 'undefined' && source instanceof ImageBitmap) ctx.setTransform(1, 0, 0, -1, 0, h);\n    \n    if (canvas.width !== w || canvas.height !== h) {\n        canvas.width = w;\n        canvas.height = h;\n    }\n\n    // 缩放\n    ctx.drawImage(source, 0, 0, w, h);\n    var data = ctx.getImageData(0, 0, w, h);\n    return data;\n}\n\nfunction loop() {\n    var d = list.shift();\n    if (d) {\n        if (!d.input || !d.width || !d.height) {\n            self.postMessage({ event: 'resized', ts: d.ts, idx: d.idx });\n        } else {\n            var output = run(d.input, d.width, d.height);\n            if (output) {\n                self.postMessage({ event: 'resized', input: d.input, output, ts: d.ts, idx: d.idx }, [d.input, output.data.buffer]);\n            } else {\n                self.postMessage({ event: 'resized', ts: d.ts, idx: d.idx });\n            }\n        }\n    }\n    setTimeout(loop, 0);\n}\n\nloop();\n\nonmessage = function (e) {\n    var d = e.data;\n    switch (d.cmd) {\n        case 'resize':\n            list.push(d);\n            if (list.lenght > 10) list.shift();\n            break;\n        case 'init':\n            self.postMessage({ event: 'init' });\n            break;\n    }\n}\n"],{type:"text/javascript"}),new Worker(URL.createObjectURL(t)));i||e(void 0),i.addEventListener("message",(function(t){e(i)})),i.postMessage({cmd:h.WorkerCmd.INIT})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t._post=function(e,t,i,r){this._taskIdx++,e.idx=this._taskIdx,e.w.postMessage({cmd:h.WorkerCmd.RESIZE,input:t,width:i,height:r,ts:performance.now(),idx:this._taskIdx},[t])},t._getIdleWorker=function(){for(var e=0;e<this._workers.length;e++)if(!this._workers[e].idx)return this._workers[e]},t._getWorkerByTaskIdx=function(e){for(var t=0;t<this._workers.length;t++)if(this._workers[t].idx===e)return this._workers[t]},t._resizeNext=function(){if(this._inputQueue.length){var e=this._getIdleWorker();if(e){var t=this._inputQueue.shift();t&&this._post(e,t.input,t.width,t.height)}}},e}(),m=i("./src/config.ts"),g=i("./src/types/main.ts"),v=i("./src/utils/tf-utils.ts"),A=i("./src/utils/worker-utils.ts"),T=i("./src/core/errors.ts"),_=i("./node_modules/url-toolkit/src/url-toolkit.js"),x=i.n(_),y=function(){function e(){var e=this;this._xhr=null,this._context=void 0,this._callbacks=null,this._onReadyStateChange=function(t){if(e._xhr){var i=e._xhr;2===i.readyState&&(e._context.responseUrl=i.responseURL,e._context.responseHeader=i.getAllResponseHeaders(),e._callbacks&&e._callbacks.onConnect&&e._callbacks.onConnect(i.status),(i.status<200||i.status>299)&&e._onError(new Error("xhr error")))}},this._onLoadEnd=function(t){var i=null,r=e._xhr;r&&(i=r.response),e._callbacks&&e._callbacks.onEnd(e._context,i)},this._onError=function(t){e._callbacks&&e._callbacks.onError&&e._callbacks.onError(t)},this._xhr=null}var t=e.prototype;return t.load=function(e,t){this._callbacks=t,this._context=e;var i=this._xhr=new XMLHttpRequest;i.open(e.requestMethod?e.requestMethod:"GET",this._context.url,!0),i.responseType=e.responseType||"arraybuffer",i.onload=this._onLoadEnd,i.onreadystatechange=this._onReadyStateChange,i.onerror=this._onError,i.withCredentials=!!e.credentials,e.range&&i.setRequestHeader("Range",e.range),e.headers&&e.headers.forEach((function(e){i.setRequestHeader(e.header,e.value)})),i.send()},t.abort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},t.destroy=function(){this._callbacks=null,this.abort()},e}(),C=0,b=function(){function e(){var e=this;this.context=void 0,this._loader=void 0,this._callbacks=null,this._config=void 0,this._loaderCallback=void 0,this._stats=void 0,this._retryDelay=0,this._loading=!1,this._aborted=!1,this._requestTimeout=void 0,this._transTimer=void 0,this._retryTimeout=void 0,this._rangeStart=void 0,this._continuedTransmissionRetry=!1,this._progressTime=0,this._loadInternal=function(){e._loading=!0,e._aborted=!1;var t=e._stats;t.code=0,t.tfirst=0,t.loaded=0,e._retryTimeout&&(clearTimeout(e._retryTimeout),e._retryTimeout=null),e._loader=new y,e._loader&&(t.id="xhr-"+C,e._config.connectionTimeout&&(e._requestTimeout=setTimeout(e._onTimeout,e._config.connectionTimeout)),e.context.rangeEnd?e.context.range="bytes="+e.context.rangeStart+"-"+(e.context.rangeEnd-1):e.context.rangeStart&&(e.context.range="bytes="+e.context.rangeStart+"-"),t.tsload=Date.now(),t.tstart=performance.now(),e._loader.load(e.context,e._loaderCallback))},this._onConnect=function(t){e._requestTimeout&&(clearTimeout(e._requestTimeout),e._requestTimeout=null),e._startTransmissionTimer(),e._stats.code=t,e._stats.tfirst=Math.max(e._stats.trequest,performance.now())},this._onProgress=function(t,i){var r=e._stats;if(e._progressTime=performance.now(),!e._continuedTransmissionRetry&&r.output>r.loaded){if(r.loaded+i.byteLength-r.output>0){var n=i.slice(r.output-r.loaded);r.loaded+=i.byteLength,e._callProgress(e.context,n,r)}}else r.loaded+=i.byteLength,e._callProgress(e.context,i,r)},this._onError=function(t){d.Log.i("loader",t),e._stopTimer(),e._destroyLoader();var i=e._stats,r=e._config;e._loading=!1,i.fatal=!r.maxRetry||i.retry>=r.maxRetry||!r.maxRetry,i.text=t.message||"load error",e._callbacks&&e._callbacks.onError&&e._callbacks.onError(e.context,i),i.fatal||(e._stats.output&&e._stats.loaded>0?(e._rangeStart?e.context.rangeStart=e._rangeStart+e._stats.output:e.context.rangeStart=e._stats.output,e._continuedTransmissionRetry=!0):(e.context.rangeStart=e._rangeStart,e._continuedTransmissionRetry=!1),i.retry++,e._callbacks&&(e._retryDelay?(e._retryTimeout=setTimeout(e._loadInternal,e._retryDelay),e._retryDelay=2*e._retryDelay):e._loadInternal()))},this._onTimeout=function(){e._loading=!1,e._abortInternal();var t=new Error("timeout");e._onError(t)},C++,this._loader=null,this._config={useFetch:!1,connectionTimeout:0,transmissionTimeout:0,maxRetry:0,retryDelay:0},this._loaderCallback={onConnect:this._onConnect,onProgress:this._onProgress,onEnd:this._onEnd.bind(this),onError:this._onError}}var t=e.prototype;return t.load=function(e,t,i){this._init(e,t,i),this._loadInternal()},t.destroy=function(){this._stopTimer(),this._abortInternal(),this._destroyLoader(),this._callbacks=null},t._init=function(e,t,i){this.context=e,this._rangeStart=e.rangeStart,this._callbacks=t,this._config=i||this._config,this._stats={id:"",trequest:performance.now(),retry:0,loaded:0,code:0,output:0,tfirst:0,tload:0,total:0,tsload:0,tstart:0,fatal:!1,text:""},this._config.retryDelay&&(this._retryDelay=this._config.retryDelay)},t._destroyLoader=function(){this._loader&&(this._loader.destroy(),this._loader=null)},t._abortInternal=function(){this._callbacks&&this._callbacks.onAbort&&!this._aborted&&this._loading&&this._callbacks.onAbort(this.context,this._stats),this._aborted=!0,this._loader&&this._loader.abort()},t.abort=function(){this._stopTimer(),this._abortInternal()},t._stopTimer=function(){this._requestTimeout&&(clearTimeout(this._requestTimeout),this._requestTimeout=null),this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),this._stopTransmissionTimer()},t._callProgress=function(e,t,i){this._stats.output+=t.byteLength,this._callbacks&&this._callbacks.onProgress&&this._callbacks.onProgress(e,t,i)},t._onEnd=function(e,t){this._stopTimer();var i=this._stats;i.total=t?i.loaded="string"==typeof t?t.length||0:t.byteLength||0:i.loaded,i.tload=Math.max(i.tfirst,performance.now()),this._loading=!1,i.output=0,this._callbacks&&this._callbacks.onEnd(e,t,i)},t._startTransmissionTimer=function(){var e=this;this._stopTransmissionTimer(),this._progressTime=performance.now();var t=this._config.transmissionTimeout||0;t&&(this._transTimer=setInterval((function(){performance.now()-e._progressTime>t&&e._onTimeout()}),1e3))},t._stopTransmissionTimer=function(){this._transTimer&&(clearInterval(this._transTimer),this._transTimer=null)},e}(),E={400:"01",401:"02",403:"03",404:"04",other4xx:"05",serverError:"06",timeoutOpen:"07",timeoutIO:"08",200:"09",206:"09"};function S(e,t,i){if(void 0===i&&(i=0),e>=100)return e;var r="00";return"timeout"===t?r=i?E.timeoutIO||r:E.timeoutOpen||r:E.hasOwnProperty(i)?r=E[i]||r:/^4\d{2}$/.test(i.toString())?r=E.other4xx||r:/^5\d{2}$/.test(i.toString())&&(r=E.serverError||r),parseInt(e+r,10)}var I=i("./src/core/tf-urls.ts"),w={0:T.ErrorCode.TF_LOAD_ERROR,1:T.ErrorCode.TF_JS_LOAD_ERROR,2:T.ErrorCode.TF_JS_LOAD_ERROR},R="tf-res-m",k=function(){function e(e){this._config=void 0,this._loaderList=[],this._modelLoader=void 0,this._config=e}e.hasModel=function(t){return!!e._models[t]};var t=e.prototype;return t.getTFRes=function(){var e=n()(l.a.mark((function e(t,i,r,o){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.Log.i(R,"load tf res simd:"+r+" thread:"+o),e.next=3,Promise.all([this._loadTf(t,r,o),this._loadModel(t,i)]).then(function(){var e=n()(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t[0].code){e.next=4;break}return e.abrupt("return",t[0]);case 4:if(!t[1].code){e.next=8;break}return e.abrupt("return",t[1]);case 8:return e.abrupt("return",{wasm:t[0],model:t[1]});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,i,r,n){return e.apply(this,arguments)}}(),t.destroy=function(){this._destroyTfLoader(),this._destroyModelLoader()},t._destroyTfLoader=function(){this._loaderList.forEach((function(e){e.destroy()})),this._loaderList=[]},t._destroyModelLoader=function(){this._modelLoader&&this._modelLoader.destroy(),this._modelLoader=void 0},t._loadTf=function(){var t=n()(l.a.mark((function t(i,r,o){var a,s,c,u,h,p=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._tfRes){t.next=2;break}return t.abrupt("return",e._tfRes);case 2:return a=I.JS_URL,s="",c=I.WASM_URL,o?(s=I.JS_WORKER_URL,r?(a=I.JS_SIMD_THREAD_URL,c=I.WASM_SIMD_THREAD_URL):(a=I.JS_THREAD_URL,c=I.WASM_THREAD_URL)):r&&(c=I.WASM_SIMD_URL),a=x.a.buildAbsoluteURL(i,a),c=x.a.buildAbsoluteURL(i,c),s&&(s=x.a.buildAbsoluteURL(i,s)),this._destroyTfLoader(),this._loaderList[0]=new b,this._loaderList[1]=new b,u={connectionTimeout:this._config.connectionTimeout,transmissionTimeout:this._config.transmissionTimeout,maxRetry:this._config.maxRetry,retryDelay:this._config.retryDelay},h=[this._request(this._loaderList[0],{url:c,responseType:"arraybuffer"},u),this._request(this._loaderList[1],{url:a,responseType:"text"},u)],o&&(this._loaderList[2]=new b,h.push(this._request(this._loaderList[2],{url:s,responseType:"text"},u))),t.next=17,Promise.all(h).then(function(){var t=n()(l.a.mark((function t(i){var n,a,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i[0].response&&i[1].response&&(!o||i[2]&&i[2].response))){t.next=7;break}return n=i[0].response,a=i[1].response,s=i[2]?i[2].response:"",p._destroyTfLoader(),e._tfRes={thread:o,simd:r,wasmBinary:new Uint8Array(n),jsSrc:a,jsWorkerSrc:s},t.abrupt("return",e._tfRes);case 7:return d.Log.i(R,"load error"),p._destroyTfLoader(),i.forEach((function(e,t){if(!i[0].response){var r=e.context.url+"内容空。code: "+e.stats.code+". "+e.stats.text;return{code:S(w[t],e.stats.text,e.stats.code),reason:r}}})),t.abrupt("return",{code:T.ErrorCode.TF_LOAD_ERROR,reason:"tf加载失败，unknown error"});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){p._destroyTfLoader();var t=e.context.url+"加载失败。code: "+e.stats.code+". "+(0===e.stats.code?"请检查跨域设置":"")+" "+e.stats.text;return{code:S(T.ErrorCode.TF_LOAD_ERROR,e.stats.text,e.stats.code),reason:t}}));case 17:return t.abrupt("return",t.sent);case 18:case"end":return t.stop()}}),t,this)})));return function(e,i,r){return t.apply(this,arguments)}}(),t._loadModel=function(){var t=n()(l.a.mark((function t(i,r){var n,o,a=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=x.a.buildAbsoluteURL(i,r),!e._models[r]){t.next=3;break}return t.abrupt("return",e._models[r]);case 3:return this._destroyModelLoader(),o={connectionTimeout:this._config.connectionTimeout,transmissionTimeout:this._config.transmissionTimeout,maxRetry:this._config.maxRetry,retryDelay:this._config.retryDelay},this._modelLoader=new b,t.abrupt("return",this._request(this._modelLoader,{url:n,responseType:"arraybuffer"},o).then((function(t){if(t.response){var i=new Uint8Array(t.response);return e._models[r]={url:n,model:i},e._models[r]}a._destroyTfLoader();var o=t.context.url+"内容空。code: "+t.stats.code+". "+t.stats.text;return{code:S(T.ErrorCode.TF_MODEL_LOAD_ERROR,t.stats.text,t.stats.code),reason:o}})).catch((function(e){a._destroyModelLoader();var t=e.context.url+"加载失败。code: "+e.stats.code+". "+(0===e.stats.code?"请检查跨域设置":"")+" "+e.stats.text;return{code:S(T.ErrorCode.TF_LOAD_ERROR,e.stats.text,e.stats.code),reason:t}})));case 7:case"end":return t.stop()}}),t,this)})));return function(e,i){return t.apply(this,arguments)}}(),t._request=function(e,t,i){return new Promise((function(r,n){var o={onEnd:function(e,t,i){return r({context:e,response:t,stats:i})},onError:function(e,t){t.fatal&&n({context:e,stats:t})},onAbort:function(e,t){n({context:e,stats:t})}};e.load(t,o,i)}))},e}();k._tfRes=void 0,k._models={};var P=k,D="tf-proxy",O=function(){function e(e,t){this._tflite=void 0,this._tfRes=void 0,this._inputSize={width:0,height:0},this._outputSize={width:0,height:0},this._outputChannel=1,this._outputPixelCount=0,this._outputUint=void 0,this._config=void 0,this._kwaiModel=!1,this._lastOutput=void 0,this._fullModelWaiting=!1,this._fastDelayTimer=void 0,this._sizeUpdateCB=void 0,this._config=e,this._sizeUpdateCB=t,this._tfRes=new P(e)}var t=e.prototype;return t.getSize=function(){return this._outputSize},t.getOutputChannel=function(){return this._outputChannel},t.init=function(){var e=n()(l.a.mark((function e(){var t,i,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.Log.i(D,"init",this._config.virtualBackgroundModel),t="","string"!=typeof this._config.virtualBackgroundModel?(m.ConfigHelper.updateTFModelConfig(this._config,Object(A.isInWorker)()),t=this._config.virtualBackgroundModel.lite,this._config.tfModelType===g.TFModelType.full&&(!this._config.tfFastStart||P.hasModel(this._config.virtualBackgroundModel.full)?t=this._config.virtualBackgroundModel.full:(this._fullModelWaiting=!0,d.Log.i(D,"load model. fast start")))):t=this._config.virtualBackgroundModel,i={extraInfo:{modelType:this._config.tfModelType,model:t}},e.next=6,this._loadModel(this._config.tfBaseUrl,t);case 6:if((r=e.sent).tflite){e.next=9;break}return e.abrupt("return",{error:r});case 9:return i.extraInfo||(i.extraInfo={}),i.extraInfo.thread=r.threadNum,i.extraInfo.simd=r.simd,this._tflite=r.tflite,this._kwaiModel=r.kwaiModel,d.Log.i(D,"model: "+t+". "+this._kwaiModel),this._updateSizeByModel(this._tflite),this._delayCheckUpdateFullModel(),e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t._loadModel=function(){var e=n()(l.a.mark((function e(t,i){var r,n,o,a,s,c,u,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.Log.i(D,"load model"),r=1!==this._config.tfThread&&Object(v.getIsSupportThread)(),e.next=4,this._tfRes.getTFRes(t,i,Object(v.getIsSupportSIMD)(),r);case 4:if((n=e.sent).model){e.next=7;break}return e.abrupt("return",n);case 7:return o=n.wasm,a=n.model,e.next=11,this._getTFByRes(o);case 11:if(s=e.sent){e.next=14;break}return e.abrupt("return",{code:T.ErrorCode.TF_INIT_ERROR,reason:"init tf error"});case 14:return c=s._getModelBufferMemoryOffset(),s.HEAPU8.set(a.model,c),u=o.thread?Object(v.getThreadNum)(this._config.tfThread):1,h=!(i.startsWith("segm_")||i.startsWith("selfie")),s._loadModel(a.model.byteLength,this._kwaiModel?0:1,u),e.abrupt("return",{tflite:s,simd:o.simd,threadNum:u,kwaiModel:h});case 20:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}(),t.run=function(e,t){if(void 0===t&&(t=!1),this._tflite){var i=this._tflite;this._uploadData(e),i._runInference();var r=i._getOutputMemoryOffset()/4;if(this._lastOutput=i.HEAPF32.subarray(r,r+this._outputChannel*this._outputPixelCount),t)return this._lastOutput;this._outputUint||(this._outputUint=new Uint8ClampedArray(this._outputChannel*this._outputPixelCount));for(var n=0;n<this._outputPixelCount;n++)if(2===this._outputChannel){var o=i.HEAPF32[r+2*n],a=i.HEAPF32[r+2*n+1],s=Math.max(o,a),c=Math.exp(o-s),u=Math.exp(a-s);this._outputUint[n]=255*u/(c+u)}else{var l=i.HEAPF32[r+n];this._outputUint[n]=255*l}return this._outputUint}},t.destroy=function(){d.Log.i(D,"destroy"),this._fastDelayTimer&&clearTimeout(this._fastDelayTimer),this._outputUint=void 0,this._sizeUpdateCB=void 0,this._destroyTf(),this._tfRes.destroy()},t._destroyTf=function(){if(this._tfRes.destroy(),this._tflite)try{this._tflite._exit()}catch(e){}this._tflite=void 0},t._delayCheckUpdateFullModel=function(e){var t=this;void 0===e&&(e=2e3),this._fastDelayTimer=setTimeout(n()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._fullModelWaiting&&"string"!=typeof t._config.virtualBackgroundModel&&t._hotUpdateModel(t._config.tfBaseUrl,t._config.virtualBackgroundModel.full);case 1:case"end":return e.stop()}}),e)}))),e)},t._hotUpdateModel=function(){var e=n()(l.a.mark((function e(t,i){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadModel(t,i);case 2:(r=e.sent).tflite?(this._tfRes.destroy(),this._tflite&&this._destroyTf(),this._lastOutput=void 0,this._tflite=r.tflite,this._kwaiModel=r.kwaiModel,d.Log.i(D,"update model : "+i),this._updateSizeByModel(this._tflite)):d.Log.e(D,"update model error");case 4:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}(),t._uploadData=function(e){if(this._tflite){this._inputSize;var t=this._tflite;if(e){var i=t._getInputMemoryOffset(0)/4;if(this._kwaiModel){if(this._lastOutput){var r=t._getInputMemoryOffset(1)/4;t.HEAPF32.set(this._lastOutput,r)}for(var n=0;n<this._outputPixelCount;n++)t.HEAPF32[i+3*n]=e.data[4*n+2]/255*2-1,t.HEAPF32[i+3*n+1]=e.data[4*n+1]/255*2-1,t.HEAPF32[i+3*n+2]=e.data[4*n]/255*2-1}else for(var o=0;o<this._outputPixelCount;o++)t.HEAPF32[i+3*o]=e.data[4*o]/255,t.HEAPF32[i+3*o+1]=e.data[4*o+1]/255,t.HEAPF32[i+3*o+2]=e.data[4*o+2]/255}}},t._updateSizeByModel=function(e){this._inputSize.width=e._getInputWidth(),this._inputSize.height=e._getInputHeight(),this._outputSize.width=e._getOutputWidth(),this._outputSize.height=e._getOutputHeight(),this._outputChannel=e._getOutputChannelCount(),this._outputPixelCount=this._outputSize.width*this._outputSize.height,this._lastOutput=new Float32Array(this._outputPixelCount*this._outputChannel),this._sizeUpdateCB&&this._sizeUpdateCB()},t._getTFByRes=function(){var e=n()(l.a.mark((function e(t){var i,r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new Function(t.jsSrc+" return createTFLiteModule;")(),d.Log.i(D,"load complete thread:"+!!t.jsWorkerSrc),e.prev=2,!t.jsWorkerSrc){e.next=12;break}return n=t.jsWorkerSrc?new Blob([t.jsSrc],{type:"text/javascript"}):"",o=new Blob([t.jsWorkerSrc],{type:"text/javascript"}),e.next=8,i({wasmBinary:t.wasmBinary,mainScriptUrlOrBlob:n,locateFile:function(e){return-1!==e.indexOf(".worker.js")?URL.createObjectURL(o):""}});case 8:r=e.sent,d.Log.i(D,"wasm with thread ready"),e.next=16;break;case 12:return e.next=14,i({wasmBinary:t.wasmBinary});case 14:r=e.sent,d.Log.i(D,"wasm ready");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),d.Log.e(D,e.t0.message);case 21:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),e}(),L=i("./src/utils/tex-helper.ts"),M=function(){function e(){this._originCanvas=void 0,this._originCtx=null,this._resizeCanvas=void 0,this._resizeCtx=null,"undefined"!=typeof HTMLCanvasElement&&(this._originCanvas=document.createElement("canvas"),this._originCtx=this._originCanvas.getContext("2d"),this._resizeCanvas=document.createElement("canvas"),this._resizeCtx=this._resizeCanvas.getContext("2d"))}var t=e.prototype;return t.run=function(e,t,i){var r=this._originCtx,n=this._originCanvas,o=this._resizeCtx,a=this._resizeCanvas,s=Object(L.getSourceSize)(e);if(r&&n&&o&&a&&t&&i&&s.width&&s.height&&!(e instanceof ImageData))return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap&&o.setTransform(1,0,0,-1,0,i),n.width===s.width&&n.height===s.height||(n.width=s.width,n.height=s.height),a.width===t&&a.height===i||(a.width=t,a.height=i),r.drawImage(e,0,0,s.width,s.height),o.drawImage(n,0,0,t,i),{input:n,output:o.getImageData(0,0,t,i)}},t.destroy=function(){this._resizeCtx=null,this._resizeCanvas=void 0,this._originCtx=null,this._originCanvas=void 0},e}(),N=i("./src/filter/filter-base.ts"),U=i("./src/filter/filter-group.ts"),B=i("./src/filter/filter-two-input.ts"),F={frosted:1},V=function(e){function t(t){var i;return(i=e.call(this,t)||this)._backgroundTexture=null,i._texelSizeUniform=null,i._backgroundTypeUniform=null,i._blurType=0,i._fragmentShader="\nprecision lowp float;\n \nvarying highp vec2 textureCoordinate;\n\n// foreground\nuniform sampler2D inputImageTexture;\n// person\nuniform sampler2D inputImageTexture2;\n\nuniform vec2 texelSize;\n\nuniform int backgroundType;\n\nvec2 randMap = vec2(.5);\n\nfloat normpdf(float x, float sigma) {\n\treturn 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;\n}\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n}   \n\nconst int mSize = 17;\nconst int kSize = (mSize-1)/2;\nfloat texelSizeRatio = 1.2;\n\nvoid main() {\n    float personMask = texture2D(inputImageTexture2, textureCoordinate).r;\n    vec4 centerColor = texture2D(inputImageTexture, textureCoordinate);\n\n    // gl_FragColor = vec4(personMask, 0.0,0.0,1.0);\n    // return;\n\n    vec2 uv = textureCoordinate;\n    if (backgroundType == 1) {\n        uv += vec2(rand(textureCoordinate), rand(textureCoordinate)) * 0.05;\n        texelSizeRatio = 4.0;\n    }\n\n    // onepass gaussian blur https://www.shadertoy.com/view/XdfGDH\n\n    float kernel[mSize];\n    vec3 final_colour = vec3(0.0);\n    float sigma = 9.0;\n\tfloat Z = 0.0;\n    float mask = 0.0;\n\tfor (int j = 0; j <= kSize; ++j) {\n\t\tkernel[kSize+j] = kernel[kSize-j] = normpdf(float(j), sigma);\n\t}\n\n    for (int i=-kSize; i <= kSize; ++i) {\n\t\tfor (int j=-kSize; j <= kSize; ++j) {\n            mask = (1.0 - texture2D(inputImageTexture2, (uv + vec2(float(i) / texelSize.x * texelSizeRatio, float(j) / texelSize.y * texelSizeRatio))).r);\n\t\t\tfinal_colour += kernel[kSize+j]*kernel[kSize+i]*texture2D(inputImageTexture, (uv + vec2(float(i) / texelSize.x * texelSizeRatio, float(j) / texelSize.y * texelSizeRatio))).rgb * mask;\n            Z += kernel[kSize+j]*kernel[kSize+i] * mask;\n\t\t}\n\t}\n    vec3 frameColor = Z == 0.0 ? vec3(final_colour) : vec3(final_colour / Z);\n    gl_FragColor = vec4(centerColor.rgb * personMask + frameColor * (1.0 - personMask), centerColor.a);\n}\n",i}c()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;i&&t&&(this._texelSizeUniform=t.getUniformLocation(i,"texelSize"),this._backgroundTypeUniform=t.getUniformLocation(i,"backgroundType"),t.uniform1i(this._backgroundTypeUniform,this._blurType),this._updateTexelSize())},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._updateTexelSize(),this._updateSize()},i._updateTexelSize=function(){this._gl&&this._isActivated&&this._gl.uniform2f(this._texelSizeUniform,this._inputWidth,this._inputHeight)},a()(t,[{key:"background",set:function(e){this._blurType=F[e]||0,this._gl&&this._isActivated&&this._gl.uniform1i(this._backgroundTypeUniform,this._blurType)}}]),t}(B.default),H=function(e){function t(t){var i;return(i=e.call(this,t)||this)._channelUniform=null,i._mask=void 0,i._maskTex=null,i._fragmentShader="\nprecision mediump float;\n\n// vTexCoord\nvarying highp vec2 textureCoordinate;\n// uTexture0\nuniform sampler2D inputImageTexture;\n\nuniform int uChannel;\n\nfloat getMaskByCoord(int channel, vec2 coord) {\n    if (channel == 2) {\n        vec2 segmentation = vec2(texture2D(inputImageTexture, coord).r, texture2D(inputImageTexture, coord).a);\n        float shift = max(segmentation.x, segmentation.y);\n        float backgroundExp = exp(segmentation.x - shift);\n        float personExp = exp(segmentation.y - shift);\n        return personExp / (backgroundExp + personExp);\n    } else {\n        return texture2D(inputImageTexture, coord).r;\n    }\n}\n\nvoid main() {\n    float mask = getMaskByCoord(uChannel, textureCoordinate);\n    gl_FragColor = vec4(vec3(mask), 1.0);\n}\n",i}c()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._channelUniform=this._gl.getUniformLocation(this._program,"uChannel"))},i.updateMask=function(e){this._mask=e},i.draw=function(){var e=this._gl;e&&this._mask&&(e.uniform1i(this._channelUniform,this._mask.channel),this._updateSize(),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE0),this._maskTex?e.bindTexture(e.TEXTURE_2D,this._maskTex):this._maskTex=this._createAndSetupTexture(e),Object(v.uploadMask)(e,this._mask),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._output&&(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)),e.finish())},t}(N.default),j=i("./src/types/filter.ts"),G=i("./src/utils/tex-proxy.ts"),z=function(e){function t(t){var i;return(i=e.call(this,t)||this)._inputTextureUniform3=null,i._backgroundTexture=null,i._backgroundTypeUniform=null,i._texelSizeUniform=null,i._bgViewUniform=null,i._bgColorUniform=null,i._backgroundType=1,i._background=void 0,i._backgroundColor=[0,0,0,0],i._bgW=0,i._bgH=0,i._bgProxy=void 0,i._bgView=[0,0,1,1],i._fragmentShader="\nprecision highp float;\n \nvarying highp vec2 textureCoordinate;\n\n// foreground\nuniform sampler2D inputImageTexture;\n// person\nuniform sampler2D inputImageTexture2;\n// background\nuniform sampler2D inputImageTexture3;\n\nuniform int channel;\n\nuniform vec2 texelSize;\n\nuniform int backgroundType;\n\nuniform vec4 uBGView;\n\nuniform vec4 uBGColor;\n\nconst int mSize = 31;\nconst int kSize = (mSize-1)/2;\n\nvoid main() {\n    float personMask = texture2D(inputImageTexture2, textureCoordinate).r;\n    vec4 centerColor = texture2D(inputImageTexture, textureCoordinate);\n\n    if (backgroundType == 0) {\n        gl_FragColor = vec4(mix(uBGColor.rgb, centerColor.rgb, personMask), centerColor.a > 0.0 ? (personMask + uBGColor.a) : 0.0);\n    } else {\n        // background\n        lowp vec2 bgCoord = vec2(textureCoordinate.x * uBGView[2] + uBGView[0], textureCoordinate.y * uBGView[3] + uBGView[1]);\n        vec3 backgroundColor = texture2D(inputImageTexture3, bgCoord).rgb;\n        gl_FragColor = vec4(mix(backgroundColor, centerColor.rgb, personMask), centerColor.a);\n    }\n}\n",i}c()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;i&&t&&(this._inputTextureUniform3=t.getUniformLocation(i,"inputImageTexture3"),this._backgroundTypeUniform=t.getUniformLocation(i,"backgroundType"),this._texelSizeUniform=t.getUniformLocation(i,"texelSize"),this._bgViewUniform=t.getUniformLocation(i,"uBGView"),this._bgColorUniform=t.getUniformLocation(i,"uBGColor"),t.uniform1i(this._backgroundTypeUniform,this._backgroundType),t.uniform4fv(this._bgViewUniform,this._bgView),t.uniform4fv(this._bgColorUniform,this._backgroundColor),this._updateTexelSize())},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._updateTexelSize(),this._updateSize()},i.destroy=function(t){this._bgProxy&&this._bgProxy.destroy(),this._background=void 0,e.prototype.destroy.call(this,t)},i.draw=function(){var e=this._gl;e&&this._input&&this._secondInput&&(this._updateSize(),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),this._background&&(this._backgroundTexture||(this._backgroundTexture=this._createAndSetupTexture(e)),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this._backgroundTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._background)),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),this._secondInputType===j.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._secondInput)):this._secondInputType===j.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._secondInput.texture,0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===j.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===j.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),e.uniform1i(this._inputTextureUniform2,1),e.uniform1i(this._inputTextureUniform3,2),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i._updateSize=function(){e.prototype._updateSize.call(this),this._gl&&this._isActivated&&this._bgW&&this._bgH&&(Object(L.updateView)(this._bgView,this._inputWidth,this._inputHeight,this._bgW,this._bgH,"cut"),this._gl.uniform4fv(this._bgViewUniform,this._bgView))},i._updateTexelSize=function(){this._gl&&this._isActivated&&this._gl.uniform2f(this._texelSizeUniform,this._inputWidth,this._inputHeight)},i._updateBackground=function(e){this._background=e;var t=Object(L.getSourceSize)(this._background);this._bgW=t.width,this._bgH=t.height},a()(t,[{key:"backgroundType",set:function(e){this._backgroundType=e,this._gl&&this._isActivated&&this._gl.uniform1i(this._backgroundTypeUniform,this._backgroundType)}},{key:"background",set:function(e){var t=this;Object(L.isTexImageSource)(e)?(e=e,this._bgH=this._bgW=0,this._bgProxy&&this._bgProxy.destroy(),"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||e instanceof ImageData||Object(L.isSourceReady)(e)?this._updateBackground(e):(this._bgProxy=new G.default,this._bgProxy.on("ready",(function(){t._bgProxy&&t._bgProxy.source&&t._updateBackground(t._bgProxy.source)})),this._bgProxy.init(e))):Array.isArray(e)&&(this._backgroundColor=e,this._bgH=this._inputHeight,this._bgW=this._inputWidth,this._gl&&this._bgColorUniform&&this._gl.uniform4fv(this._bgColorUniform,this._backgroundColor))}}]),t}(B.default),W=function(e){return"\n    precision mediump float;\n    \n    // vTexCoord\n    varying highp vec2 textureCoordinate;\n    // uTexture0\n    uniform sampler2D inputImageTexture;\n    \n    uniform float uStep;\n    // uRadius\n    const float radius = "+e.toFixed(1)+";\n    \n    void main () {\n        lowp float cur;\n        lowp float minValue;\n        vec3 mask = texture2D(inputImageTexture, textureCoordinate).xyz;\n        minValue = mask.y;\n        lowp vec2 offset;\n        for (float i_1 = -radius; i_1 <= radius; i_1++) {\n            offset.x = i_1 * uStep;\n            offset.y = 0.0;\n            cur = texture2D(inputImageTexture, textureCoordinate + offset).y;\n            minValue = min(minValue, cur);\n        };\n        gl_FragColor = vec4(vec3(mask.x,minValue,mask.z),1.0);\n    }\n    "},q=function(e){function t(t){var i;return(i=e.call(this,t)||this)._stepUniform=null,i._radius=3,i._step=1/512,i._fragmentShader=W(i._radius),i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._stepUniform=this._gl.getUniformLocation(this._program,"uStep"),this.radius=this._radius,this.step=this._step)},a()(t,[{key:"radius",set:function(e){this._radius!==e&&(this._radius=e,this._fragmentShader=W(this._radius),this._program&&(this.destroy(!1),this.init(),this.active()))}},{key:"step",set:function(e){this._step!==e&&(this._step=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._stepUniform,e))}}]),t}(N.default),Y=function(e){return"\n    precision mediump float;\n    \n    // vTexCoord\n    varying highp vec2 textureCoordinate;\n    // uTexture0\n    uniform sampler2D inputImageTexture;\n    \n    uniform float uStep;\n    uniform float uOnlyErode;\n    \n    const float radius = "+e.toFixed(1)+";\n    \n    void main () {\n        lowp float cur;\n        lowp vec4 combine = texture2D (inputImageTexture, textureCoordinate);\n        lowp float erodemask = combine.y;\n        for (float i_1 = -radius; i_1 <= radius; i_1++) {\n            lowp vec2 offset = vec2(0.0, i_1 * uStep);\n            cur = texture2D (inputImageTexture, textureCoordinate + offset).y;\n            erodemask = min(erodemask, cur);\n        };\n        lowp float binarymask = combine.z;\n        lowp float orimask = combine.x;\n        lowp float outmask;\n        if (uOnlyErode==0.0){\n            outmask = erodemask * orimask + (binarymask - erodemask) * orimask * orimask;\n        } else {\n            outmask = erodemask;\n        }\n        gl_FragColor = vec4(vec3(outmask),1.0);\n    }\n    "},Q=function(e){function t(t){var i;return(i=e.call(this,t)||this)._stepUniform=null,i._onlyErodeUniform=null,i._radius=3,i._step=1/512,i._onlyErode=0,i._fragmentShader=Y(i._radius),i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._stepUniform=this._gl.getUniformLocation(this._program,"uStep"),this._onlyErodeUniform=this._gl.getUniformLocation(this._program,"uOnlyErode"),this.radius=this._radius,this.step=this._step,this.onlyErode=this._onlyErode)},a()(t,[{key:"radius",set:function(e){this._radius!==e&&(this._radius=e,this._fragmentShader=Y(this._radius),this._program&&(this.destroy(!1),this.init(),this.active()))}},{key:"step",set:function(e){this._step!==e&&(this._step=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._stepUniform,e))}},{key:"onlyErode",set:function(e){this._onlyErode!==e&&(this._onlyErode=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._onlyErodeUniform,e))}}]),t}(N.default),K=function(e){return"\n    precision mediump float;\n    \n    // vTexCoord\n    varying highp vec2 textureCoordinate;\n    // uTextureY\n    uniform sampler2D inputImageTexture;\n    // uGuidedTextureY\n    uniform sampler2D inputImageTexture2;\n    \n    uniform float uStep;\n\n    const float blurRadius = "+e.toFixed(1)+";\n    \n    void main () {\n        lowp vec4 guided_I = texture2D(inputImageTexture2, textureCoordinate);\n        lowp vec4 src = texture2D (inputImageTexture, textureCoordinate);\n        lowp vec3 yuv = mat3(0.213, -0.115, 0.5, 0.715, -0.385, -0.454, 0.072, 0.5, -0.046) * src.xyz;\n        lowp vec4 yuva = vec4(yuv, src.w);\n        lowp float sum_I = guided_I.x;\n        lowp float sum_p = yuva.x;\n        lowp float sum_Ip = (guided_I.x * yuva.x);\n        lowp float sum_II = (guided_I.x * guided_I.x);\n        const highp int r_2 = int(blurRadius);\n        for (highp int i_1 = 1; i_1 <= r_2; i_1++) {\n            lowp vec2 tmpvar_10 = vec2(float(i_1) * uStep, 0.0);\n            lowp vec4 guidedI_left = texture2D (inputImageTexture2, (textureCoordinate - tmpvar_10));\n            lowp vec4 guidedI_right = texture2D (inputImageTexture2, (textureCoordinate + tmpvar_10));\n            lowp vec4 p_left = texture2D (inputImageTexture, (textureCoordinate - tmpvar_10));\n            lowp vec4 p_right = texture2D (inputImageTexture, (textureCoordinate + tmpvar_10));\n            sum_I += (guidedI_left.x + guidedI_right.x);\n            sum_p += (p_left.x + p_right.x);\n            sum_Ip += ((guidedI_left.x * p_left.x) + (guidedI_right.x * p_right.x));\n            sum_II += ((guidedI_left.x * guidedI_left.x) + (guidedI_right.x * guidedI_right.x));\n        };\n        highp int tmpvar_15 = (1 + (r_2 * 2));\n        lowp vec4 guided_res;\n        guided_res.x = (sum_I / float(tmpvar_15));\n        guided_res.y = (sum_II / float(tmpvar_15));\n        guided_res.z = (sum_p / float(tmpvar_15));\n        guided_res.w = (sum_Ip / float(tmpvar_15));\n        gl_FragColor = guided_res;   \n    }\n    "},J=function(e){function t(t){var i;return(i=e.call(this,t)||this)._stepUniform=null,i._blurRadius=10,i._step=10/512,i._fragmentShader=K(i._blurRadius),i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._stepUniform=this._gl.getUniformLocation(this._program,"uStep"),this.blurRadius=this._blurRadius,this.step=this._step)},a()(t,[{key:"blurRadius",set:function(e){this._blurRadius!==e&&(this._blurRadius=e,this._fragmentShader=K(this._blurRadius),this._program&&(this.destroy(!1),this.init(),this.active()))}},{key:"step",set:function(e){this._step!==e&&(this._step=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._stepUniform,e))}}]),t}(B.default),X=i("./src/filter/filter-three-input.ts"),Z=function(e){return"\n    precision mediump float;\n    \n    //vTexCoord\n    varying highp vec2 textureCoordinate;\n    // uTexture0;\n    uniform sampler2D inputImageTexture;\n    // uTextureY\n    uniform sampler2D inputImageTexture2;\n    // uGuidedTextureY\n    uniform sampler2D inputImageTexture3;\n    \n    uniform float uEps;\n    uniform float uStep;\n    const float blurRadius = "+e.toFixed(1)+";\n    \n    void main () {\n        const highp int r_2 = int(blurRadius);\n        lowp vec4 guided_res = texture2D(inputImageTexture, textureCoordinate);\n        lowp vec4 src = texture2D(inputImageTexture2, textureCoordinate);\n        lowp vec3 yuv = mat3(0.213, -0.115, 0.5, 0.715, -0.385, -0.454, 0.072, 0.5, -0.046) * src.xyz;\n        lowp vec4 guided_I = texture2D (inputImageTexture3, textureCoordinate);\n        lowp float sum_I = guided_res.x;\n        lowp float sum_II = guided_res.y;\n        lowp float sum_p = guided_res.z;\n        lowp float sum_Ip = guided_res.w;\n    \n        for (highp int i_1 = 1; i_1 <= r_2; i_1++) {\n            lowp vec2 tmpvar_12 = vec2(0.0, float(i_1) * uStep);\n            lowp vec4 guideres_up = texture2D (inputImageTexture, (textureCoordinate - tmpvar_12));\n            lowp vec4 guideres_down = texture2D (inputImageTexture, (textureCoordinate + tmpvar_12));\n            sum_I += (guideres_up.x + guideres_down.x);\n            sum_II += (guideres_up.y + guideres_down.y);\n            sum_p += (guideres_up.z + guideres_down.z);\n            sum_Ip += (guideres_up.w + guideres_down.w);\n        }\n    \n        highp int tmpvar_15 = (1 + (r_2 * 2));\n        lowp float mean_I = (sum_I / float(tmpvar_15));\n        lowp float mean_p = (sum_p / float(tmpvar_15));\n        lowp float corr_I = (sum_II / float(tmpvar_15));\n        lowp float corr_Ip = (sum_Ip / float(tmpvar_15));\n        lowp float var_I = (corr_I - mean_I*mean_I);\n        lowp float cov_Ip = (corr_Ip - mean_I*mean_p);\n        lowp float a = clamp(cov_Ip/(var_I + uEps),-1.0, 1.0);\n        lowp float b = mean_p - a*mean_I;\n        yuv.x  = clamp((a*guided_I.x + b), 0.0, 1.0);\n        lowp vec4 guided_rgba;\n        guided_rgba.w = 1.0;\n        guided_rgba.xyz = (mat3(1.0, 1.0, 1.0, 0.0, -0.18732, 1.8556, 1.57481, -0.46813, 0.0) * yuv);\n        gl_FragColor = guided_rgba;\n    }\n    "},$=function(e){function t(t){var i;return(i=e.call(this,t)||this)._epsUniform=null,i._stepUniform=null,i._eps=0,i._blurRadius=10,i._step=10/512,i._fragmentShader=Z(i._blurRadius),i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._epsUniform=this._gl.getUniformLocation(this._program,"uEps"),this._stepUniform=this._gl.getUniformLocation(this._program,"uStep"),this.eps=this._eps,this.blurRadius=this._blurRadius,this.step=this._step)},a()(t,[{key:"eps",set:function(e){this._eps!==e&&(this._eps=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._epsUniform,e))}},{key:"blurRadius",set:function(e){this._blurRadius!==e&&(this._blurRadius=e,this._fragmentShader=Z(this._blurRadius),this._program&&(this.destroy(!1),this.init(),this.active()))}},{key:"step",set:function(e){this._step!==e&&(this._step=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._stepUniform,e))}}]),t}(X.default),ee=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fragmentShader="\nprecision mediump float;\n\n//vTexCoord\nvarying highp vec2 textureCoordinate;\n// uTexture0\nuniform sampler2D inputImageTexture;\n// uTextureY\nuniform sampler2D inputImageTexture2;\n\nvoid main () {\n\n    lowp float tmp1;\n    tmp1 = texture2D (inputImageTexture, textureCoordinate).x;\n    lowp float tmp2;\n    tmp2 = texture2D (inputImageTexture2, textureCoordinate).x;\n    lowp float tmp3;\n    tmp3 = tmp1 * tmp2;\n    gl_FragColor = vec4(vec3(tmp3),1.0);\n}\n\n",i}return c()(t,e),t}(B.default),te=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fragmentShader="\nprecision mediump float;\n\n// vTexCoord\nvarying highp vec2 textureCoordinate;\n// uTexture0\nuniform sampler2D inputImageTexture;\n\nvoid main() {\n    mediump vec3 rgb_1;\n    mediump vec3 yuv_2;\n    lowp vec4 tmpvar_3;\n    tmpvar_3 = texture2D(inputImageTexture, textureCoordinate);\n    rgb_1 = tmpvar_3.xyz;\n    yuv_2 = (mat3(0.213, -0.115, 0.5, 0.715, -0.385, -0.454, 0.072, 0.5, -0.046) * rgb_1);\n    yuv_2.yz = (yuv_2.yz + vec2(0.5, 0.5));\n    mediump vec4 tmpvar_4;\n    tmpvar_4.w = 1.0;\n    tmpvar_4.xyz = yuv_2;\n    gl_FragColor = tmpvar_4;\n}\n",i}return c()(t,e),t}(N.default),ie=function(e){function t(t){var i;return(i=e.call(this,t)||this)._threshUniform=null,i._thresh1Uniform=null,i._modeUniform=null,i._thresh=.1,i._thresh1=0,i._mode=0,i._fragmentShader="\nprecision mediump float;\n\n// vTexCoord\nvarying highp vec2 textureCoordinate;\n// uTexture0\nuniform sampler2D inputImageTexture;\n\nuniform float uThresh;\nuniform float uThresh1;\nuniform float uMode;\nvoid main () {\n    lowp vec4 tmp1;\n    tmp1 = texture2D (inputImageTexture, textureCoordinate);\n    lowp float tmp2 = (tmp1.x > uThresh) ? ((1.0 - uMode) * 1.0 + uMode * tmp1.x): 0.0;\n    lowp float tmp3 = (tmp1.x > uThresh1) ? ((1.0 - uMode) * 1.0 + uMode * tmp1.x): 0.0;\n    lowp vec4 res;\n    if (uMode > 0.0) {\n        res = vec4(vec3(tmp2), 1.0);\n    } else { \n        res = vec4(tmp1.x,tmp2,tmp3,1.0);\n    }\n    gl_FragColor = res;\n}\n",i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._threshUniform=this._gl.getUniformLocation(this._program,"uThresh"),this._thresh1Uniform=this._gl.getUniformLocation(this._program,"uThresh1"),this._modeUniform=this._gl.getUniformLocation(this._program,"uMode"),this.thresh=this._thresh,this.thresh1=this._thresh1,this.mode=this._mode)},a()(t,[{key:"thresh",set:function(e){this._thresh!==e&&(this._thresh=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._threshUniform,e))}},{key:"thresh1",set:function(e){this._thresh1!==e&&(this._thresh1=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._thresh1Uniform,e))}},{key:"mode",set:function(e){this._mode!==e&&(this._mode=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._modeUniform,e))}}]),t}(N.default);function re(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return ne(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ne(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var oe=function(e){function t(t,i){var r;return(r=e.call(this,t)||this)._channelUniform=null,r._texelSizeUniform=null,r._viewportUniform=null,r._proxy=void 0,r._floatTex=!1,r._mask={w:255,h:255,channel:1},r._foreInput=void 0,r._maskInput=void 0,r._rgb2yuv=void 0,r._guided0=void 0,r._guided1=void 0,r._mul=void 0,r._thresh0=void 0,r._erode0=void 0,r._erode1=void 0,r._erode2=void 0,r._erode3=void 0,r._thresh1=void 0,r._comb=void 0,r._blur=void 0,r._output=void 0,r._guided0Step=1,r._guided1Step=1,r._erode0Step=1,r._erode1Step=1,r._erode2Step=1,r._erode3Step=1,r._bgType=1,r._blurList=[],r._combList=[],r._w=void 0,r._config=void 0,r._resizer=void 0,r._tfSize={width:0,height:0},r._config=i,r._proxy=new O(i,(function(){r._tfSize=r._proxy.getSize(),r._mask.w=r._tfSize.width,r._mask.h=r._tfSize.height,r._mask.channel=r._proxy.getOutputChannel()})),t&&t.getExtension("OES_texture_float")&&t.getExtension("OES_texture_float_linear")&&(r._floatTex=!0),r._foreInput=new N.default(t),r._maskInput=new H(t),r._rgb2yuv=new te(t),r._guided0=new J(t),r._guided0.blurRadius=10,r._guided1=new $(t),r._guided1.blurRadius=10,r._guided1.eps=.02,r._mul=new ee(t),r._thresh0=new ie(t),r._thresh0.thresh=.1,r._thresh0.thresh1=0,r._thresh0.mode=0,r._erode0=new q(t),r._erode1=new Q(t),r._erode2=new q(t),r._erode2.radius=1,r._erode3=new Q(t),r._erode3.radius=1,r._thresh1=new ie(t),r._thresh1.thresh=.1,r._thresh1.thresh1=0,r._thresh1.mode=1,r._comb=new z(t),r._blur=new V(t),r._output=new N.default(t),r.addFilter(r._maskInput),r.addFilter(r._rgb2yuv),r.addFilter(r._guided0),r.addFilter(r._guided1),r.addFilter(r._mul),r.addFilter(r._thresh0),r.addFilter(r._erode0),r.addFilter(r._erode1),r.addFilter(r._erode2),r.addFilter(r._erode3),r.addFilter(r._thresh1),r.addFilter(r._comb),r.addFilter(r._blur),r.addFilter(r._output),r}c()(t,e);var i=t.prototype;return i.init=function(){var t=n()(l.a.mark((function t(){var i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._initResizeWorker();case 2:return this._w||this._resizer||(this._resizer=new M),t.next=5,this._proxy.init();case 5:if(!(i=t.sent).error){t.next=8;break}return t.abrupt("return",i);case 8:return this._combList=[this._maskInput,this._rgb2yuv,this._guided0,this._guided1,this._mul,this._thresh0,this._erode0,this._erode1,this._erode2,this._erode3,this._thresh1,this._comb,this._output],this._blurList=[this._maskInput,this._blur,this._output],t.abrupt("return",Promise.all([e.prototype.init.call(this),this._foreInput.init(),this._blur.init()]).then((function(e){var t=e.filter((function(e){return!!e.error}));return t.length?t[0]:i})));case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.active=function(){this._foreInput.active(),e.prototype.active.call(this)},i.setInputSize=function(t){this._foreInput.setInputSize(t),e.prototype.setInputSize.call(this,t),this._guided0.step=this._guided0Step/t.width,this._guided1.step=this._guided1Step/t.height,this._erode0.step=this._erode0Step/t.width,this._erode1.step=this._erode1Step/t.height,this._erode2.step=this._erode2Step/t.width,this._erode3.step=this._erode3Step/t.height},i.setInput=function(e,t,i,r){this._input=e,this._foreInput.setInput(e),this._grapha&&r||(this._grapha=!0,this._foreInput.drawToFBO(),this._foreInput.outputResource&&(this._maskInput.active(),this._maskInput.drawToFBO(),this._maskInput.outputResource&&(this._rgb2yuv.active(),this._rgb2yuv.setInput(this._maskInput.outputResource),this._rgb2yuv.drawToFBO(),this._rgb2yuv.outputResource&&(this._guided0.active(),this._guided0.setInput(this._rgb2yuv.outputResource,0),this._guided0.setInput(this._maskInput.outputResource,1),this._guided0.drawToFBO(),this._guided0.outputResource&&(this._guided1.active(),this._guided1.setInput(this._guided0.outputResource),this._guided1.setInput(this._rgb2yuv.outputResource,1),this._guided1.setInput(this._maskInput.outputResource,2),this._guided1.drawToFBO(),this._guided1.outputResource&&(this._mul.active(),this._mul.setInput(this._guided1.outputResource),this._mul.setInput(this._maskInput.outputResource,1),this._mul.drawToFBO(),this._mul.outputResource&&(this._thresh0.active(),this._thresh0.setInput(this._mul.outputResource),this._thresh0.drawToFBO(),this._thresh0.outputResource&&(this._erode0.active(),this._erode0.setInput(this._thresh0.outputResource),this._erode0.drawToFBO(),this._erode0.outputResource&&(this._erode1.active(),this._erode1.setInput(this._erode0.outputResource),this._erode1.drawToFBO(),this._erode1.outputResource&&(this._erode2.active(),this._erode2.setInput(this._erode1.outputResource),this._erode2.drawToFBO(),this._erode2.outputResource&&(this._erode3.active(),this._erode3.setInput(this._erode2.outputResource),this._erode3.drawToFBO(),this._erode3.outputResource&&(this._thresh1.active(),this._thresh1.setInput(this._erode3.outputResource),this._thresh1.drawToFBO(),this._thresh1.outputResource&&(this._comb.active(),this._comb.setInput(this._foreInput.outputResource),this._comb.setInput(this._thresh1.outputResource,1),this._comb.drawToFBO(),this._comb.outputResource&&(this._blur.active(),this._blur.setInput(this._foreInput.outputResource),this._blur.setInput(this._maskInput.outputResource,1),this._blur.drawToFBO(),this._blur.outputResource&&(this._output.active(),1===this._bgType?this._output.setInput(this._blur.outputResource):this._output.setInput(this._comb.outputResource))))))))))))))))},i.draw=function(){var e,t;if(!this._gl||!this._proxy||!this._input)return{code:g.DrawStatuCode.skip};if(this._w&&this._input instanceof ImageBitmap?(this._w.resize(this._input,this._tfSize.width,this._tfSize.height),t=this._w.getResult()):this._resizer&&(t=this._resizer.run(this._input,this._tfSize.width,this._tfSize.height)),!t)return{code:g.DrawStatuCode.skip};if(e=t.output,this._foreInput.setInput(t.input),this._foreInput.active(),this._foreInput.draw(),!e)return{code:g.DrawStatuCode.skip};var i={tf:performance.now()},r=this._proxy.run(e,this._floatTex);if(i.tf=performance.now()-i.tf,!r)return{code:g.DrawStatuCode.skip};this._mask.data=r,this._maskInput.updateMask(this._mask);for(var n,o=re(1===this._bgType?this._blurList:this._combList);!(n=o()).done;){var a=n.value;a.active(),a.draw()}return{time:i,code:g.DrawStatuCode.success}},i.destroy=function(t){var i,r;void 0===t&&(t=!1),this._proxy&&this._proxy.destroy(),this._foreInput.destroy(t),this._comb.destroy(t),this._blur.destroy(t),null==(i=this._w)||i.destroy(),null==(r=this._resizer)||r.destroy(),e.prototype.destroy.call(this,t)},i._initResizeWorker=function(){var e=n()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(A.isWorkerSupported)()||!this._config.webWorker){e.next=5;break}if(!this._w){e.next=3;break}return e.abrupt("return",!0);case 3:return this._w=new f,e.abrupt("return",this._w.init(2));case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a()(t,[{key:"backgroundType",set:function(e){this._bgType=e,1===e?(this._output.active(),this._output.setInput(this._blur.outputResource)):(this._output.active(),this._output.setInput(this._comb.outputResource),this._comb.backgroundType=e)}},{key:"background",set:function(e){"string"==typeof e?this._blur.background=e:this._comb.background=e}}]),t}(U.default);t.default=oe},"./src/filter/filter-alpha.ts":
/*!************************************!*\
  !*** ./src/filter/filter-alpha.ts ***!
  \************************************/
/*! exports provided: FILTER_ALPHA_VERTEX, FILTER_ALPHA_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_ALPHA_VERTEX",(function(){return a})),i.d(t,"FILTER_ALPHA_FRAGMENT",(function(){return s}));var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=i(/*! ./filter-base */"./src/filter/filter-base.ts"),a="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    gl_Position = position;\n    textureCoordinate = vec2(inputTextureCoordinate.x / 2.0, inputTextureCoordinate.y);\n}\n",s="\nprecision highp float;\n\nvarying highp vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nconst vec2 leftW = vec2(0.5,0.0);\n\nvoid main() {\n    vec3 colorRGB = texture2D(inputImageTexture, textureCoordinate).rgb;\n    vec2 rightTextureCoordinate = leftW + textureCoordinate;\n    float colorA = texture2D(inputImageTexture, rightTextureCoordinate).r;\n    gl_FragColor = vec4(colorRGB.rgb, colorA);\n}\n",c=function(e){function t(t){var i;return(i=e.call(this,t)||this)._vertexShader=a,i._fragmentShader=s,i}return n()(t,e),t.prototype.setInputSize=function(e,t){void 0===t&&(t=0),this._inputWidth===e.width/2&&this._inputHeight===e.height||(this._inputWidth=e.width/2,this._inputHeight=e.height)},t}(o.default);t.default=c},"./src/filter/filter-base.ts":
/*!***********************************!*\
  !*** ./src/filter/filter-base.ts ***!
  \***********************************/
/*! exports provided: FILTER_VERTEX, FILTER_FRAGMENT, default */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_VERTEX",(function(){return p})),i.d(t,"FILTER_FRAGMENT",(function(){return f}));var r=i(/*! @babel/runtime/helpers/asyncToGenerator */"./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),a=i.n(o),s=i(/*! @babel/runtime/regenerator */"./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i(/*! ../utils/pixel-ratio */"./src/utils/pixel-ratio.ts"),l=i(/*! ../types/filter */"./src/types/filter.ts"),d=i(/*! ../utils/webgl-utils */"./src/utils/webgl-utils.ts"),h=i(/*! ../core/errors */"./src/core/errors.ts"),p="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\n\nvarying vec2 textureCoordinate;\n\nvoid main() {\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n}\n",f="\nvarying highp vec2 textureCoordinate;\nuniform sampler2D inputImageTexture;\n\nvoid main() {\n    gl_FragColor = texture2D(inputImageTexture, textureCoordinate);\n}\n",m=function(){function e(e){this._vertexShader=p,this._fragmentShader=f,this._vShader=null,this._fShader=null,this._gl=null,this._program=null,this._positionBuffer=null,this._texcoordBuffer=null,this._texture=null,this._input=void 0,this._inputType=l.ResourceType.texImageSource,this._inputWidth=0,this._inputHeight=0,this._outputFBO=null,this._output=null,this._inputTextureUniform=null,this._positionAttrib=0,this._inputTextureCoordinateAttrib=0,this._hasOverriddenImageSizeFactor=!1,this._viewport={x:0,y:0,w:1,h:1},this._gl=e}var t=e.prototype;return t.init=function(){var e=n()(c.a.mark((function e(t){var i,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(this._vertexShader=t.vertex||this._vertexShader,this._fragmentShader=t.fragment||this._fragmentShader),i=this._gl){e.next=4;break}return e.abrupt("return",{error:{code:h.ErrorCode.WEBGL_INIT_ERROR,reason:"缺少WebGLRenderingContext",fatal:!0}});case 4:if(r=Object(d.createProgramFromSources)(i,this._vertexShader,this._fragmentShader),this._vShader=r.vertexShader,this._fShader=r.fragmentShader,this._program=r.program){e.next=10;break}return e.abrupt("return",{error:{code:h.ErrorCode.WEBGL_INIT_ERROR,reason:"创建program失败",fatal:!0}});case 10:return Object(d.resizeCanvasToDisplaySize)(i.canvas,u.PixelRatio.pixelRatio),this._positionBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this._positionBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),i.STATIC_DRAW),this._texcoordBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this._texcoordBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),i.STATIC_DRAW),e.abrupt("return",{});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.active=function(){var e=this._gl,t=this._program;e&&t&&(e.useProgram(t),this._positionAttrib=e.getAttribLocation(t,"position"),this._inputTextureCoordinateAttrib=e.getAttribLocation(t,"inputTextureCoordinate"),e.enableVertexAttribArray(this._positionAttrib),e.bindBuffer(e.ARRAY_BUFFER,this._positionBuffer),e.vertexAttribPointer(this._positionAttrib,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this._inputTextureCoordinateAttrib),e.bindBuffer(e.ARRAY_BUFFER,this._texcoordBuffer),e.vertexAttribPointer(this._inputTextureCoordinateAttrib,2,e.FLOAT,!1,0,0),this._inputTextureUniform=e.getUniformLocation(t,"inputImageTexture"))},t.setInput=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!1),this._input=e,this._inputType=this._getInputType(e);var r=this._gl;if(r)if(this._inputType===l.ResourceType.texture){var n=this._input;this._texture=n.texture,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer),r.bindTexture(r.TEXTURE_2D,n.texture),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n.texture,0)}else this._texture=this._createAndSetupTexture(r),i&&(this._inputType=l.ResourceType.texImageSourceStatic,r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,this._input))},t.setInputSize=function(e,t){void 0===t&&(t=0),this._inputWidth===e.width&&this._inputHeight===e.height||(this._inputWidth=e.width,this._inputHeight=e.height)},t.draw=function(){var e=this._gl;e&&this._input&&(this._updateSize(),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===l.ResourceType.texImageSource&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._output&&(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)),e.finish())},t.drawToFBO=function(){var e=this._gl;e&&(this._outputFBO&&e.deleteFramebuffer(this._outputFBO),this._output&&e.deleteTexture(this._output),this._output=this._createAndSetupTexture(e),this._outputFBO=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.canvas.width,e.canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._output,0))},t.destroy=function(e){if(void 0===e&&(e=!1),this._gl){if(this._gl.disableVertexAttribArray(this._positionAttrib),this._gl.disableVertexAttribArray(this._inputTextureCoordinateAttrib),this._outputFBO&&this._gl.deleteFramebuffer(this._outputFBO),this._positionBuffer&&this._gl.deleteBuffer(this._positionBuffer),this._texcoordBuffer&&this._gl.deleteBuffer(this._texcoordBuffer),this._texture&&this._inputType!==l.ResourceType.texture&&this._gl.deleteTexture(this._texture),this._output&&this._gl.deleteTexture(this._output),this._program&&this._gl.deleteProgram(this._program),this._vShader&&this._gl.deleteShader(this._vShader),this._fShader&&this._gl.deleteShader(this._fShader),e){var t=this._gl.getExtension("WEBGL_lose_context");t&&t.loseContext()}this._gl=null}this._input=void 0},t.onResize=function(){this._outputFBO&&this.drawToFBO()},t._createAndSetupTexture=function(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t},t._getInputType=function(e){return e.hasOwnProperty("texture")?l.ResourceType.texture:l.ResourceType.texImageSource},t._updateSize=function(){var e=this._gl;if(e){var t=this._inputWidth/this._inputHeight,i=e.canvas.width,r=e.canvas.height,n=i/r;this._viewport.x=0,this._viewport.y=0,this._viewport.w=i,this._viewport.h=r,t>n?(this._viewport.h=i/t,this._viewport.y=(r-this._viewport.h)/2):(this._viewport.w=r*t,this._viewport.x=(i-this._viewport.w)/2),e.viewport(this._viewport.x,this._viewport.y,this._viewport.w,this._viewport.h)}},a()(e,[{key:"outputResource",get:function(){return{texture:this._output,framebuffer:this._outputFBO}}},{key:"gl",get:function(){return this._gl}},{key:"_isActivated",get:function(){return!(!this._gl||this._gl.getParameter(this._gl.CURRENT_PROGRAM)!==this._program)}}]),e}();t.default=m},"./src/filter/filter-bicubic.ts":
/*!**************************************!*\
  !*** ./src/filter/filter-bicubic.ts ***!
  \**************************************/
/*! exports provided: FILTER_BICUBIC_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_BICUBIC_FRAGMENT",(function(){return a}));var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=i(/*! ./filter-base */"./src/filter/filter-base.ts"),a="\n\nprecision mediump float;//用于手机上时需要添加此句\nvarying vec2 textureCoordinate;//纹理坐标，注意与 vertex shader 中的变量对应\nuniform sampler2D inputImageTexture;\nuniform float width;//传入原图的宽\nuniform float height;//传入原图的高\n\nfloat BiCubicPoly1(float x, float a)\n{\n    x = abs(x);\n    float res = (a+float(2))*x*x*x - (a+float(3))*x*x + float(1);\n    return res;\n}\nfloat BiCubicPoly2(float x, float a)\n{\n    x = abs(x);\n    float res = a*x*x*x - float(5)*a*x*x + float(8)*a*x - float(4)*a;\n    return res;\n}\nvoid main()\n{\nvec2 basic; \nvec2 det; \nbasic = textureCoordinate*vec2(width, height) - vec2(0.5,0.5); \ndet = fract(basic); \ngl_FragColor = vec4(0.0,0.0,0.0,0.0)\n+BiCubicPoly2(det.x-float(-1), float(-0.5))*BiCubicPoly2(det.y-float(-1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(-1), float(-1)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(-1), float(-0.5))*BiCubicPoly1(det.y-float(0), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(-1), float(0)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(-1), float(-0.5))*BiCubicPoly1(det.y-float(1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(-1), float(1)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(-1), float(-0.5))*BiCubicPoly2(det.y-float(2), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(-1), float(2)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(0), float(-0.5))*BiCubicPoly2(det.y-float(-1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(0), float(-1)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(0), float(-0.5))*BiCubicPoly1(det.y-float(0), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(0), float(0)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(0), float(-0.5))*BiCubicPoly1(det.y-float(1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(0), float(1)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(0), float(-0.5))*BiCubicPoly2(det.y-float(2), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(0), float(2)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(1), float(-0.5))*BiCubicPoly2(det.y-float(-1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(1), float(-1)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(1), float(-0.5))*BiCubicPoly1(det.y-float(0), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(1), float(0)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(1), float(-0.5))*BiCubicPoly1(det.y-float(1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(1), float(1)))/vec2(width, height))\n+BiCubicPoly1(det.x-float(1), float(-0.5))*BiCubicPoly2(det.y-float(2), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(1), float(2)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(2), float(-0.5))*BiCubicPoly2(det.y-float(-1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(2), float(-1)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(2), float(-0.5))*BiCubicPoly1(det.y-float(0), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(2), float(0)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(2), float(-0.5))*BiCubicPoly1(det.y-float(1), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(2), float(1)))/vec2(width, height))\n+BiCubicPoly2(det.x-float(2), float(-0.5))*BiCubicPoly2(det.y-float(2), float(-0.5))*texture2D(inputImageTexture, textureCoordinate + ( - det + vec2(float(2), float(2)))/vec2(width, height))\n;\n}\n",s=function(e){function t(t){var i;return(i=e.call(this,t)||this)._widthUniform=null,i._heightUniform=null,i._fragmentShader=a,i}n()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._widthUniform=this._gl.getUniformLocation(this._program,"width"),this._heightUniform=this._gl.getUniformLocation(this._program,"height"))},i.setInputSize=function(t,i){void 0===i&&(i=0),e.prototype.setInputSize.call(this,t,i),this._program&&this._gl&&(this._gl.uniform1f(this._widthUniform,this._inputWidth),this._gl.uniform1f(this._heightUniform,this._inputHeight))},t}(o.default);t.default=s},"./src/filter/filter-brightness.ts":
/*!*****************************************!*\
  !*** ./src/filter/filter-brightness.ts ***!
  \*****************************************/
/*! exports provided: FILTER_BRIGHTNESS_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_BRIGHTNESS_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\nuniform lowp float brightness;\n\nvoid main()\n{\n    lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n    \n    gl_FragColor = vec4((textureColor.rgb + vec3(brightness)), textureColor.w);\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._brightnessUniform=null,i._brightness=0,i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._brightnessUniform=this._gl.getUniformLocation(this._program,"brightness"),this.brightness=this._brightness)},n()(t,[{key:"brightness",set:function(e){e<-1||e>1||(this._brightness=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._brightnessUniform,e))}}]),t}(s.default);t.default=u},"./src/filter/filter-color-blind-correct.ts":
/*!**************************************************!*\
  !*** ./src/filter/filter-color-blind-correct.ts ***!
  \**************************************************/
/*! exports provided: FILTER_COLOR_BLIND_CORRECT_FRAGMENT, default */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_COLOR_BLIND_CORRECT_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\n\nuniform lowp mat4 colorMatrix;\n\nvoid main()\n{\n    lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n    gl_FragColor = textureColor * colorMatrix;\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._intensityUniform=null,i._colorMatrixUniform=null,i._intensity=0,i._colorMatrixList=[],i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._colorMatrixUniform=this._gl.getUniformLocation(this._program,"colorMatrix"),this.intensity=this._intensity)},n()(t,[{key:"intensity",set:function(e){if((e=Math.round(e))>=0&&e<this._colorMatrixList.length&&(this._intensity=e,this._gl&&this._isActivated)){var t=this._colorMatrixList[this._intensity];this._gl.uniformMatrix4fv(this._colorMatrixUniform,!1,t)}}},{key:"colorMatrixList",set:function(e){this._colorMatrixList=e}}]),t}(s.default);t.default=u},"./src/filter/filter-color-matrix.ts":
/*!*******************************************!*\
  !*** ./src/filter/filter-color-matrix.ts ***!
  \*******************************************/
/*! exports provided: FILTER_COLOR_MATRIX_FRAGMENT, default */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_COLOR_MATRIX_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\n\nuniform lowp mat4 colorMatrix;\nuniform lowp float intensity;\n\nvoid main()\n{\n    lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n    lowp vec4 outputColor = textureColor * colorMatrix;\n    \n    gl_FragColor = (intensity * outputColor) + ((1.0 - intensity) * textureColor);\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._intensityUniform=null,i._colorMatrixUniform=null,i._intensity=0,i._colorMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._intensityUniform=this._gl.getUniformLocation(this._program,"intensity"),this._colorMatrixUniform=this._gl.getUniformLocation(this._program,"colorMatrix"),this.intensity=this._intensity,this.colorMatrix=this._colorMatrix)},n()(t,[{key:"intensity",set:function(e){this._intensity=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._intensityUniform,e)}},{key:"colorMatrix",set:function(e){this._colorMatrix=e,this._gl&&this._isActivated&&this._gl.uniformMatrix4fv(this._colorMatrixUniform,!1,e)}}]),t}(s.default);t.default=u},"./src/filter/filter-contrast.ts":
/*!***************************************!*\
  !*** ./src/filter/filter-contrast.ts ***!
  \***************************************/
/*! exports provided: FILTER_CONTRAST_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_CONTRAST_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\nuniform lowp float contrast;\n\nvoid main()\n{\n    lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n    \n    gl_FragColor = vec4(((textureColor.rgb - vec3(0.5)) * contrast + vec3(0.5)), textureColor.w);\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._contrastUniform=null,i._contrast=1,i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._contrastUniform=this._gl.getUniformLocation(this._program,"contrast"),this.contrast=this._contrast)},n()(t,[{key:"contrast",get:function(){return this._contrast},set:function(e){e<0||e>4||(this._contrast=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._contrastUniform,e))}}]),t}(s.default);t.default=u},"./src/filter/filter-dilation.ts":
/*!***************************************!*\
  !*** ./src/filter/filter-dilation.ts ***!
  \***************************************/
/*! exports provided: FILTER_DILATION_RADUIS_ONE_VERTEX, FILTER_DILATION_RADUIS_ONE_FRAGMENT, FILTER_DILATION_RADUIS_TWO_VERTEX, FILTER_DILATION_RADUIS_TWO_FRAGMENT, FILTER_DILATION_RADUIS_THREE_VERTEX, FILTER_DILATION_RADUIS_THREE_FRAGMENT, FILTER_DILATION_RADUIS_FOUR_VERTEX, FILTER_DILATION_RADUIS_FOUR_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_DILATION_RADUIS_ONE_VERTEX",(function(){return a})),i.d(t,"FILTER_DILATION_RADUIS_ONE_FRAGMENT",(function(){return s})),i.d(t,"FILTER_DILATION_RADUIS_TWO_VERTEX",(function(){return c})),i.d(t,"FILTER_DILATION_RADUIS_TWO_FRAGMENT",(function(){return u})),i.d(t,"FILTER_DILATION_RADUIS_THREE_VERTEX",(function(){return l})),i.d(t,"FILTER_DILATION_RADUIS_THREE_FRAGMENT",(function(){return d})),i.d(t,"FILTER_DILATION_RADUIS_FOUR_VERTEX",(function(){return h})),i.d(t,"FILTER_DILATION_RADUIS_FOUR_FRAGMENT",(function(){return p}));var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=i(/*! ./filter-two-pass-texture-sampling */"./src/filter/filter-two-pass-texture-sampling.ts"),a="\nattribute vec4 position;\nattribute vec2 inputTextureCoordinate;\n\nuniform float texelWidthOffset; \nuniform float texelHeightOffset; \n\nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\n\nvoid main()\n{\n    gl_Position = position;\n    \n    vec2 offset = vec2(texelWidthOffset, texelHeightOffset);\n    \n    centerTextureCoordinate = inputTextureCoordinate;\n    oneStepNegativeTextureCoordinate = inputTextureCoordinate - offset;\n    oneStepPositiveTextureCoordinate = inputTextureCoordinate + offset;\n}",s="\nprecision lowp float;\n \nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\n \nuniform sampler2D inputImageTexture;\n\nvoid main()\n{\n    float centerIntensity = texture2D(inputImageTexture, centerTextureCoordinate).r;\n    float oneStepPositiveIntensity = texture2D(inputImageTexture, oneStepPositiveTextureCoordinate).r;\n    float oneStepNegativeIntensity = texture2D(inputImageTexture, oneStepNegativeTextureCoordinate).r;\n         \n    lowp float maxValue = max(centerIntensity, oneStepPositiveIntensity);\n    maxValue = max(maxValue, oneStepNegativeIntensity);\n\n    gl_FragColor = vec4(vec3(maxValue), 1.0);\n}\n",c="\nattribute vec4 position;\nattribute vec2 inputTextureCoordinate;\n\nuniform float texelWidthOffset;\nuniform float texelHeightOffset;\n\nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\nvarying vec2 twoStepsPositiveTextureCoordinate;\nvarying vec2 twoStepsNegativeTextureCoordinate;\n\nvoid main()\n{\n    gl_Position = position;\n    \n    vec2 offset = vec2(texelWidthOffset, texelHeightOffset);\n    \n    centerTextureCoordinate = inputTextureCoordinate;\n    oneStepNegativeTextureCoordinate = inputTextureCoordinate - offset;\n    oneStepPositiveTextureCoordinate = inputTextureCoordinate + offset;\n    twoStepsNegativeTextureCoordinate = inputTextureCoordinate - (offset * 2.0);\n    twoStepsPositiveTextureCoordinate = inputTextureCoordinate + (offset * 2.0);\n}\n",u="\nprecision lowp float;\n \nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\nvarying vec2 twoStepsPositiveTextureCoordinate;\nvarying vec2 twoStepsNegativeTextureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nvoid main()\n{\n    float centerIntensity = texture2D(inputImageTexture, centerTextureCoordinate).r;\n    float oneStepPositiveIntensity = texture2D(inputImageTexture, oneStepPositiveTextureCoordinate).r;\n    float oneStepNegativeIntensity = texture2D(inputImageTexture, oneStepNegativeTextureCoordinate).r;\n    float twoStepsPositiveIntensity = texture2D(inputImageTexture, twoStepsPositiveTextureCoordinate).r;\n    float twoStepsNegativeIntensity = texture2D(inputImageTexture, twoStepsNegativeTextureCoordinate).r;\n    \n    lowp float maxValue = max(centerIntensity, oneStepPositiveIntensity);\n    maxValue = max(maxValue, oneStepNegativeIntensity);\n    maxValue = max(maxValue, twoStepsPositiveIntensity);\n    maxValue = max(maxValue, twoStepsNegativeIntensity);\n    \n    gl_FragColor = vec4(vec3(maxValue), 1.0);\n}\n",l="\nattribute vec4 position;\nattribute vec2 inputTextureCoordinate;\n\nuniform float texelWidthOffset;\nuniform float texelHeightOffset;\n\nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\nvarying vec2 twoStepsPositiveTextureCoordinate;\nvarying vec2 twoStepsNegativeTextureCoordinate;\nvarying vec2 threeStepsPositiveTextureCoordinate;\nvarying vec2 threeStepsNegativeTextureCoordinate;\n\nvoid main()\n{\n    gl_Position = position;\n    \n    vec2 offset = vec2(texelWidthOffset, texelHeightOffset);\n    \n    centerTextureCoordinate = inputTextureCoordinate;\n    oneStepNegativeTextureCoordinate = inputTextureCoordinate - offset;\n    oneStepPositiveTextureCoordinate = inputTextureCoordinate + offset;\n    twoStepsNegativeTextureCoordinate = inputTextureCoordinate - (offset * 2.0);\n    twoStepsPositiveTextureCoordinate = inputTextureCoordinate + (offset * 2.0);\n    threeStepsNegativeTextureCoordinate = inputTextureCoordinate - (offset * 3.0);\n    threeStepsPositiveTextureCoordinate = inputTextureCoordinate + (offset * 3.0);\n}\n",d="\nprecision lowp float;\n \nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\nvarying vec2 twoStepsPositiveTextureCoordinate;\nvarying vec2 twoStepsNegativeTextureCoordinate;\nvarying vec2 threeStepsPositiveTextureCoordinate;\nvarying vec2 threeStepsNegativeTextureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nvoid main()\n{\n    float centerIntensity = texture2D(inputImageTexture, centerTextureCoordinate).r;\n    float oneStepPositiveIntensity = texture2D(inputImageTexture, oneStepPositiveTextureCoordinate).r;\n    float oneStepNegativeIntensity = texture2D(inputImageTexture, oneStepNegativeTextureCoordinate).r;\n    float twoStepsPositiveIntensity = texture2D(inputImageTexture, twoStepsPositiveTextureCoordinate).r;\n    float twoStepsNegativeIntensity = texture2D(inputImageTexture, twoStepsNegativeTextureCoordinate).r;\n    float threeStepsPositiveIntensity = texture2D(inputImageTexture, threeStepsPositiveTextureCoordinate).r;\n    float threeStepsNegativeIntensity = texture2D(inputImageTexture, threeStepsNegativeTextureCoordinate).r;\n    \n    lowp float maxValue = max(centerIntensity, oneStepPositiveIntensity);\n    maxValue = max(maxValue, oneStepNegativeIntensity);\n    maxValue = max(maxValue, twoStepsPositiveIntensity);\n    maxValue = max(maxValue, twoStepsNegativeIntensity);\n    maxValue = max(maxValue, threeStepsPositiveIntensity);\n    maxValue = max(maxValue, threeStepsNegativeIntensity);\n    \n    gl_FragColor = vec4(vec3(maxValue), 1.0);\n}\n",h="\nattribute vec4 position;\nattribute vec2 inputTextureCoordinate;\n\nuniform float texelWidthOffset;\nuniform float texelHeightOffset;\n\nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\nvarying vec2 twoStepsPositiveTextureCoordinate;\nvarying vec2 twoStepsNegativeTextureCoordinate;\nvarying vec2 threeStepsPositiveTextureCoordinate;\nvarying vec2 threeStepsNegativeTextureCoordinate;\nvarying vec2 fourStepsPositiveTextureCoordinate;\nvarying vec2 fourStepsNegativeTextureCoordinate;\n\nvoid main()\n{\n    gl_Position = position;\n    \n    vec2 offset = vec2(texelWidthOffset, texelHeightOffset);\n    \n    centerTextureCoordinate = inputTextureCoordinate;\n    oneStepNegativeTextureCoordinate = inputTextureCoordinate - offset;\n    oneStepPositiveTextureCoordinate = inputTextureCoordinate + offset;\n    twoStepsNegativeTextureCoordinate = inputTextureCoordinate - (offset * 2.0);\n    twoStepsPositiveTextureCoordinate = inputTextureCoordinate + (offset * 2.0);\n    threeStepsNegativeTextureCoordinate = inputTextureCoordinate - (offset * 3.0);\n    threeStepsPositiveTextureCoordinate = inputTextureCoordinate + (offset * 3.0);\n    fourStepsNegativeTextureCoordinate = inputTextureCoordinate - (offset * 4.0);\n    fourStepsPositiveTextureCoordinate = inputTextureCoordinate + (offset * 4.0);\n}\n",p="\nprecision lowp float;\n \nvarying vec2 centerTextureCoordinate;\nvarying vec2 oneStepPositiveTextureCoordinate;\nvarying vec2 oneStepNegativeTextureCoordinate;\nvarying vec2 twoStepsPositiveTextureCoordinate;\nvarying vec2 twoStepsNegativeTextureCoordinate;\nvarying vec2 threeStepsPositiveTextureCoordinate;\nvarying vec2 threeStepsNegativeTextureCoordinate;\nvarying vec2 fourStepsPositiveTextureCoordinate;\nvarying vec2 fourStepsNegativeTextureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nvoid main()\n{\n    float centerIntensity = texture2D(inputImageTexture, centerTextureCoordinate).r;\n    float oneStepPositiveIntensity = texture2D(inputImageTexture, oneStepPositiveTextureCoordinate).r;\n    float oneStepNegativeIntensity = texture2D(inputImageTexture, oneStepNegativeTextureCoordinate).r;\n    float twoStepsPositiveIntensity = texture2D(inputImageTexture, twoStepsPositiveTextureCoordinate).r;\n    float twoStepsNegativeIntensity = texture2D(inputImageTexture, twoStepsNegativeTextureCoordinate).r;\n    float threeStepsPositiveIntensity = texture2D(inputImageTexture, threeStepsPositiveTextureCoordinate).r;\n    float threeStepsNegativeIntensity = texture2D(inputImageTexture, threeStepsNegativeTextureCoordinate).r;\n    float fourStepsPositiveIntensity = texture2D(inputImageTexture, fourStepsPositiveTextureCoordinate).r;\n    float fourStepsNegativeIntensity = texture2D(inputImageTexture, fourStepsNegativeTextureCoordinate).r;\n    \n    lowp float maxValue = max(centerIntensity, oneStepPositiveIntensity);\n    maxValue = max(maxValue, oneStepNegativeIntensity);\n    maxValue = max(maxValue, twoStepsPositiveIntensity);\n    maxValue = max(maxValue, twoStepsNegativeIntensity);\n    maxValue = max(maxValue, threeStepsPositiveIntensity);\n    maxValue = max(maxValue, threeStepsNegativeIntensity);\n    maxValue = max(maxValue, fourStepsPositiveIntensity);\n    maxValue = max(maxValue, fourStepsNegativeIntensity);\n    \n    gl_FragColor = vec4(vec3(maxValue), 1.0);\n}\n",f=function(e){function t(t){var i;return(i=e.call(this,t)||this)._initWithRadius(1),i}return n()(t,e),t.prototype._initWithRadius=function(e){switch(e){case 0:case 1:this._vertexShader=a,this._fragmentShader=s;break;case 2:this._vertexShader=c,this._fragmentShader=u;break;case 3:this._vertexShader=l,this._fragmentShader=d;break;case 4:default:this._vertexShader=h,this._fragmentShader=p}},t}(o.default);t.default=f},"./src/filter/filter-four-input.ts":
/*!*****************************************!*\
  !*** ./src/filter/filter-four-input.ts ***!
  \*****************************************/
/*! exports provided: FILTER_FOUR_INPUT_VERTEX, default */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_FOUR_INPUT_VERTEX",(function(){return d}));var r=i(/*! @babel/runtime/helpers/asyncToGenerator */"./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! @babel/runtime/regenerator */"./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i(/*! ../types/filter */"./src/types/filter.ts"),l=i(/*! ./filter-three-input */"./src/filter/filter-three-input.ts"),d="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\nattribute vec4 inputTextureCoordinate2;\nattribute vec4 inputTextureCoordinate3;\nattribute vec4 inputTextureCoordinate4;\n\nvarying vec2 textureCoordinate;\nvarying vec2 textureCoordinate2;\nvarying vec2 textureCoordinate3;\nvarying vec2 textureCoordinate4;\n\nvoid main()\n{\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n    textureCoordinate2 = inputTextureCoordinate2.xy;\n    textureCoordinate3 = inputTextureCoordinate3.xy;\n    textureCoordinate4 = inputTextureCoordinate4.xy;\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fourTexture=null,i._inputTextureUniform4=null,i._fourInput=void 0,i._fourInputType=u.ResourceType.texture,i._texcoordBuffer4=null,i._inputTextureCoordinateAttrib4=0,i._vertexShader=d,i}a()(t,e);var i=t.prototype;return i.init=function(){var t=n()(c.a.mark((function t(i){var r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.prototype.init.call(this,i).then((function(e){if(!e.error){var t=r._gl;t&&(r._texcoordBuffer4=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r._texcoordBuffer4),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW))}return e})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;t&&i&&(this._inputTextureCoordinateAttrib4=t.getAttribLocation(i,"inputTextureCoordinate4"),t.enableVertexAttribArray(this._inputTextureCoordinateAttrib4),t.bindBuffer(t.ARRAY_BUFFER,this._texcoordBuffer4),t.vertexAttribPointer(this._inputTextureCoordinateAttrib4,2,t.FLOAT,!1,0,0),this._inputTextureUniform4=t.getUniformLocation(i,"inputImageTexture4"))},i.setInput=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=!1),e.prototype.setInput.call(this,t,i,r);var n=this._gl;if(n&&3===i)if(this._fourInput=t,this._fourInputType=this._getInputType(t),this._fourInputType===u.ResourceType.texture){var o=this._fourInput;this._fourTexture=o.texture,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer),n.bindTexture(n.TEXTURE_2D,o.texture),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o.texture,0)}else this._fourTexture=this._createAndSetupTexture(n),r&&(this._fourInputType=u.ResourceType.texImageSourceStatic,n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this._fourInput))},i.draw=function(){var e=this._gl;e&&this._input&&this._fourInput&&(this._updateSize(),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,this._fourTexture),this._fourInputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._fourInput)):this._fourInputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._fourInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._fourInput.texture,0)),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this._thirdTexture),this._thirdInputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._thirdInput)):this._thirdInputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._thirdInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._thirdInput.texture,0)),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),this._secondInputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._secondInput)):this._secondInputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._secondInput.texture,0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),e.uniform1i(this._inputTextureUniform2,1),e.uniform1i(this._inputTextureUniform3,2),e.uniform1i(this._inputTextureUniform4,3),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._gl&&(this._gl.disableVertexAttribArray(this._inputTextureCoordinateAttrib4),this._fourTexture&&this._gl.deleteTexture(this._fourTexture),this._texcoordBuffer4&&this._gl.deleteBuffer(this._texcoordBuffer4)),e.prototype.destroy.call(this,t)},t}(l.default);t.default=h},"./src/filter/filter-gamma.ts":
/*!************************************!*\
  !*** ./src/filter/filter-gamma.ts ***!
  \************************************/
/*! exports provided: FILTER_GAMMA_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_GAMMA_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\nuniform lowp float gamma;\n\nvoid main()\n{\n    lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n    \n    gl_FragColor = vec4(pow(textureColor.rgb, vec3(gamma)), textureColor.w);\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._gammaUniform=null,i._gamma=1,i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._gammaUniform=this._gl.getUniformLocation(this._program,"gamma"),this.gamma=this._gamma)},n()(t,[{key:"gamma",set:function(e){e<0||e>3||(this._gamma=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._gammaUniform,e))}}]),t}(s.default);t.default=u},"./src/filter/filter-gaussian-blur.ts":
/*!********************************************!*\
  !*** ./src/filter/filter-gaussian-blur.ts ***!
  \********************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-two-pass-texture-sampling */"./src/filter/filter-two-pass-texture-sampling.ts"),c=i(/*! ./filter-base */"./src/filter/filter-base.ts"),u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._texelSpacingMultiplier=1,i._blurRadiusInPixels=2,i._vertexShader=i._secondVertexShader=i._vertexShaderForOptimizedBlurOfRadius(8,4),i._fragmentShader=i._secondFragmentShader=i._fragmentShaderForOptimizedBlurOfRadius(8,4),i}a()(t,e);var i=t.prototype;return i._vertexShaderForOptimizedBlurOfRadius=function(e,t){if(e<1)return c.FILTER_VERTEX;for(var i=[],r=0,n=0;n<e+1;n++)i[n]=1/Math.sqrt(2*Math.PI*Math.pow(t,2))*Math.exp(-Math.pow(n,2)/(2*Math.pow(t,2))),r+=0==n?i[n]:2*i[n];for(var o=0;o<e+1;o++)i[o]=i[o]/r;for(var a=Math.min(e/2+e%2,7),s=[],u=0;u<a;u++){var l=i[2*u+1],d=i[2*u+2],h=l+d;s[u]=(l*(2*u+1)+d*(2*u+2))/h}for(var p="\n        attribute vec4 position;\n        attribute vec4 inputTextureCoordinate;\n\n        uniform float texelWidthOffset;\n        uniform float texelHeightOffset;\n\n        varying vec2 blurCoordinates["+(1+2*a)+"];\n\n        void main() {\n            gl_Position = position;\n            vec2 singleStepOffset = vec2(texelWidthOffset, texelHeightOffset);\n            blurCoordinates[0] = inputTextureCoordinate.xy;\n        ",f=0;f<a;f++)p+="\n            blurCoordinates["+(2*f+1)+"] = inputTextureCoordinate.xy + singleStepOffset * "+s[f]+";\n            blurCoordinates["+(2*f+2)+"] = inputTextureCoordinate.xy - singleStepOffset * "+s[f]+";\n            ";return p+="}"},i._fragmentShaderForOptimizedBlurOfRadius=function(e,t){if(e<1)return c.FILTER_FRAGMENT;for(var i=[],r=0,n=0;n<e+1;n++)i[n]=1/Math.sqrt(2*Math.PI*Math.pow(t,2))*Math.exp(-Math.pow(n,2)/(2*Math.pow(t,2))),r+=0==n?i[n]:2*i[n];for(var o=0;o<e+1;o++)i[o]=i[o]/r;var a=Math.min(e/2+e%2,7),s=e/2+e%2,u="\n    uniform sampler2D inputImageTexture;\n    uniform highp float texelWidthOffset;\n    uniform highp float texelHeightOffset;\n\n    varying highp vec2 blurCoordinates["+(1+2*a)+"];\n\n    void main() {\n        lowp vec4 sum = vec4(0.0);\n    ";u+="\n        sum += texture2D(inputImageTexture, blurCoordinates[0]) * "+i[0]+";";for(var l=0;l<a;l++){var d=i[2*l+1]+i[2*l+2];u+="\n        sum += texture2D(inputImageTexture, blurCoordinates["+(2*l+1)+"]) * "+d+";",u+="\n        sum += texture2D(inputImageTexture, blurCoordinates["+(2*l+2)+"]) * "+d+";"}if(s>a){u+="highp vec2 singleStepOffset = vec2(texelWidthOffset, texelHeightOffset);\n";for(var h=a;h<s;h++){var p=i[2*h+1],f=i[2*h+2],m=p+f,g=(p*(2*h+1)+f*(2*h+2))/m;u+="\n        sum += texture2D(inputImageTexture, blurCoordinates[0] + singleStepOffset * "+g+") * "+m+";\n        sum += texture2D(inputImageTexture, blurCoordinates[0] - singleStepOffset * "+g+") * "+m+";\n                "}}return u+="\n        gl_FragColor = sum;\n    }"},i._switchToVertexShader=function(e,t){this._vertexShader=this._secondVertexShader=e,this._fragmentShader=this._secondFragmentShader=t,this.init(),this.active()},n()(t,[{key:"texelSpacingMultiplier",get:function(){return this._texelSpacingMultiplier},set:function(e){this._texelSpacingMultiplier=e,this.horizontalTexelSpacing=this._texelSpacingMultiplier,this.verticalTexelSpacing=this._texelSpacingMultiplier}},{key:"blurRadiusInPixels",get:function(){return this._blurRadiusInPixels},set:function(e){if(Math.round(e)!==this._blurRadiusInPixels){this._blurRadiusInPixels=Math.round(e);var t=0;this._blurRadiusInPixels>=1&&(t=Math.floor(Math.sqrt(-2*Math.pow(this._blurRadiusInPixels,2)*Math.log(1/256*Math.sqrt(2*Math.PI*Math.pow(this._blurRadiusInPixels,2))))),t+=t%2);var i=this._vertexShaderForOptimizedBlurOfRadius(t,this._blurRadiusInPixels),r=this._fragmentShaderForOptimizedBlurOfRadius(t,this._blurRadiusInPixels);this._switchToVertexShader(i,r)}}}]),t}(s.default);t.default=u},"./src/filter/filter-grayscale.ts":
/*!****************************************!*\
  !*** ./src/filter/filter-grayscale.ts ***!
  \****************************************/
/*! exports provided: FILTER_GRAYSCALE_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_GRAYSCALE_FRAGMENT",(function(){return a}));var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=i(/*! ./filter-base */"./src/filter/filter-base.ts"),a="\nprecision highp float;\n\nvarying vec2 textureCoordinate;\n\nuniform sampler2D inputImageTexture;\n\nconst highp vec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n    lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n    float luminance = dot(textureColor.rgb, W);\n    \n    gl_FragColor = vec4(vec3(luminance), textureColor.a);\n}\n",s=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fragmentShader=a,i}return n()(t,e),t}(o.default);t.default=s},"./src/filter/filter-group-res.ts":
/*!****************************************************!*\
  !*** ./src/filter/filter-group-res.ts + 2 modules ***!
  \****************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/assertThisInitialized.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/createClass.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-group.ts because of ./src/filter/filter-unsharp-mask.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/events/events.js (<- Module is not an ECMAScript module) */function(e,t,i){"use strict";i.r(t);var r=i("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/helpers/createClass.js"),c=i.n(s);const u="function"==typeof atob,l="function"==typeof Buffer,d=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),h=(e=>{let t={};return e.forEach(((e,i)=>t[e]=i)),t})(d),p=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),m="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),g=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),v=e=>{if(e=e.replace(/\s+/g,""),!p.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,i,r,n="";for(let o=0;o<e.length;)t=h[e.charAt(o++)]<<18|h[e.charAt(o++)]<<12|(i=h[e.charAt(o++)])<<6|(r=h[e.charAt(o++)]),n+=64===i?f(t>>16&255):64===r?f(t>>16&255,t>>8&255):f(t>>16&255,t>>8&255,255&t);return n},A=u?e=>atob(g(e)):l?e=>Buffer.from(e,"base64").toString("binary"):v,T=l?e=>m(Buffer.from(e,"base64")):e=>m(A(e),(e=>e.charCodeAt(0))),_=e=>T(x(e)),x=e=>g(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),y=_;var C=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this)._queue=[],t._index=0,t._ready=!1,t._loaded=function(){var e=t._queue[t._index];"undefined"!=typeof HTMLImageElement&&e.img instanceof HTMLImageElement&&(e.img.onload=null),t._index++,t._loadNext()},t}a()(t,e);var i=t.prototype;return i.setQueue=function(e){this._queue=e},i.start=function(){this._loadNext()},i.destroy=function(){var e=this._queue[this._index];e&&(void 0!==typeof HTMLImageElement&&e.img instanceof HTMLImageElement?(e.img.src="",e.img.removeEventListener("loadend",this._loaded)):e.img instanceof ImageBitmap&&e.img.close()),this._queue=[],this._ready=!1,this.removeAllListeners()},i._loadNext=function(){var e=this,t=this._queue[this._index];t?"undefined"!=typeof HTMLImageElement?(t.img=new Image,t.img.onload=this._loaded,t.img.src=t.src):void 0===t.img&&createImageBitmap(new Blob([y(t.src.split(",")[1])])).then((function(i){t.img=i,e._loaded()})):(this._ready=!0,this.emit("complete"))},c()(t,[{key:"ready",get:function(){return this._ready}}]),t}(i("./node_modules/events/events.js").EventEmitter),b=function(e){function t(t){var i;return(i=e.call(this,t)||this)._res=new C,i._resUploaded=!1,i._res.on("complete",i._onResComplete.bind(n()(i))),i}a()(t,e);var i=t.prototype;return i.setInput=function(t,i,r,n){e.prototype.setInput.call(this,t,i,r,n)},i.draw=function(){this._resUploaded&&this._input&&e.prototype.draw.call(this)},i.destroy=function(t){void 0===t&&(t=!1),this._res.destroy(),e.prototype.destroy.call(this,t)},i._setResInput=function(){this._resUploaded=!0},i._onResComplete=function(){this._res.ready&&this._setResInput()},t}(i("./src/filter/filter-group.ts").default);t.default=b},"./src/filter/filter-group.ts":
/*!************************************!*\
  !*** ./src/filter/filter-group.ts ***!
  \************************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/asyncToGenerator */"./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),a=i.n(o),s=i(/*! @babel/runtime/regenerator */"./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i(/*! ../types/main */"./src/types/main.ts");function l(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var h=function(){function e(e){this._gl=null,this._filters=[],this._first=void 0,this._last=void 0,this._inputWidth=0,this._inputHeight=0,this._input=void 0,this._grapha=!1,this._gl=e}var t=e.prototype;return t.addFilter=function(e){this._filters.length||(this._first=e),this._last=e,this._filters.push(e)},t.init=function(){var e=n()(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._filters.map((function(e){return e.init()})),e.abrupt("return",Promise.all(t).then((function(e){var t=e.filter((function(e){return!!e.error}));return t.length?t[0]:e[0]})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.active=function(){this._filters.forEach((function(e){return e.active()}))},t.setInput=function(e,t,i,r){if(this._input=e,this._filters.length){var n=this._filters[0];if(n.active(),n.setInput(e),!(this._grapha&&r||(this._grapha=!0,n===this._last))){n.drawToFBO();for(var o=n.outputResource,a=1;a<this._filters.length-1;a++){var s=this._filters[a];s.active(),o&&s.setInput(o),s.drawToFBO(),o=s.outputResource}this._last&&(this._last.active(),o&&this._last.setInput(o))}}},t.rebuildGraph=function(){if(this._input){var e=this._filters[0];if(e.active(),e.setInput(this._input),e!==this._last){e.drawToFBO();for(var t=e.outputResource,i=1;i<this._filters.length-1;i++){var r=this._filters[i];r.active(),t&&r.setInput(t),r.drawToFBO(),t=r.outputResource}this._last&&(this._last.active(),t&&this._last.setInput(t))}}},t.setInputSize=function(e){var t=this;this._inputWidth=e.width,this._inputHeight=e.height,this._filters.forEach((function(i,r){0===r?i.setInputSize(e):t._gl&&i.setInputSize({width:t._gl.canvas.width,height:t._gl.canvas.height})}))},t.draw=function(){for(var e,t=l(this._filters);!(e=t()).done;){var i=e.value;i.active();var r=i.draw();if(r&&r.code===u.DrawStatuCode.skip)return r}},t.drawToFBO=function(){this._last&&this._last.drawToFBO()},t.onResize=function(){this._input&&this.setInput(this._input)},t.destroy=function(e){void 0===e&&(e=!1),this._filters.forEach((function(t){t.destroy(e)})),this._gl=null},a()(e,[{key:"outputResource",get:function(){return this._last?this._last.outputResource:null}},{key:"gl",get:function(){return this._gl}}]),e}();t.default=h},"./src/filter/filter-kuwahara.ts":
/*!***************************************!*\
  !*** ./src/filter/filter-kuwahara.ts ***!
  \***************************************/
/*! exports provided: FILTER_KUWAHARA_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_KUWAHARA_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\nuniform sampler2D inputImageTexture;\nuniform int radius;\n\nprecision highp float;\n\nconst vec2 src_size = vec2 (1.0 / 768.0, 1.0 / 1024.0);\nconst int R1 = 3;\nconst int R2 = -3;\nvoid main (void) \n{\n    vec2 uv = textureCoordinate;\n    float n = float((radius + 1) * (radius + 1));\n    vec3 m0 = vec3(0.0); vec3 m1 = vec3(0.0); vec3 m2 = vec3(0.0); vec3 m3 = vec3(0.0);\n    vec3 s0 = vec3(0.0); vec3 s1 = vec3(0.0); vec3 s2 = vec3(0.0); vec3 s3 = vec3(0.0);\n    vec3 c;\n\n    for (int j = R2; j <= 0; ++j)  {\n        for (int i = R2; i <= 0; ++i)  {\n            c = texture2D(inputImageTexture, uv + vec2(i,j) * src_size).rgb;\n            m0 += c;\n            s0 += c * c;\n        }\n    }\n\n    for (int j = R2; j <= 0; ++j)  {\n        for (int i = 0; i <= R1; ++i)  {\n            c = texture2D(inputImageTexture, uv + vec2(i,j) * src_size).rgb;\n            m1 += c;\n            s1 += c * c;\n        }\n    }\n\n    for (int j = 0; j <= R1; ++j)  {\n        for (int i = 0; i <= R1; ++i)  {\n            c = texture2D(inputImageTexture, uv + vec2(i,j) * src_size).rgb;\n            m2 += c;\n            s2 += c * c;\n        }\n    }\n\n    for (int j = 0; j <= R1; ++j)  {\n        for (int i = R2; i <= 0; ++i)  {\n            c = texture2D(inputImageTexture, uv + vec2(i,j) * src_size).rgb;\n            m3 += c;\n            s3 += c * c;\n        }\n    }\n\n\n    float min_sigma2 = 1e+2;\n    m0 /= n;\n    s0 = abs(s0 / n - m0 * m0);\n\n    float sigma2 = s0.r + s0.g + s0.b;\n    if (sigma2 < min_sigma2) {\n        min_sigma2 = sigma2;\n        gl_FragColor = vec4(m0, 1.0);\n    }\n\n    m1 /= n;\n    s1 = abs(s1 / n - m1 * m1);\n\n    sigma2 = s1.r + s1.g + s1.b;\n    if (sigma2 < min_sigma2) {\n        min_sigma2 = sigma2;\n        gl_FragColor = vec4(m1, 1.0);\n    }\n\n    m2 /= n;\n    s2 = abs(s2 / n - m2 * m2);\n\n    sigma2 = s2.r + s2.g + s2.b;\n    if (sigma2 < min_sigma2) {\n        min_sigma2 = sigma2;\n        gl_FragColor = vec4(m2, 1.0);\n    }\n\n    m3 /= n;\n    s3 = abs(s3 / n - m3 * m3);\n\n    sigma2 = s3.r + s3.g + s3.b;\n    if (sigma2 < min_sigma2) {\n        min_sigma2 = sigma2;\n        gl_FragColor = vec4(m3, 1.0);\n    }\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._radius=3,i._radiusUniform=null,i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._radiusUniform=this._gl.getUniformLocation(this._program,"radius"),this.radius=this._radius)},n()(t,[{key:"radius",set:function(e){this._radius=e,this._gl&&this._isActivated&&this._gl.uniform1i(this._radiusUniform,e)}}]),t}(s.default);t.default=u},"./src/filter/filter-pixellate.ts":
/*!****************************************!*\
  !*** ./src/filter/filter-pixellate.ts ***!
  \****************************************/
/*! exports provided: FILTER_PIXELLATE_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_PIXELLATE_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\n\nuniform highp float fractionalWidthOfPixel;\nuniform highp float aspectRatio;\n\nvoid main()\n{\n    highp vec2 sampleDivisor = vec2(fractionalWidthOfPixel, fractionalWidthOfPixel / aspectRatio);\n    \n    highp vec2 samplePos = textureCoordinate - mod(textureCoordinate, sampleDivisor) + 0.5 * sampleDivisor;\n    gl_FragColor = texture2D(inputImageTexture, samplePos );\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._fractionalWidthOfAPixelUniform=null,i._aspectRatioUniform=null,i._fractionalWidthOfAPixel=.008,i._aspectRatio=1,i._fragmentShader=c,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._fractionalWidthOfAPixelUniform=this._gl.getUniformLocation(this._program,"fractionalWidthOfPixel"),this._aspectRatioUniform=this._gl.getUniformLocation(this._program,"aspectRatio"),this.fractionalWidthOfAPixel=this._fractionalWidthOfAPixel,this.aspectRatio=this._aspectRatio)},i.setInputSize=function(t,i){void 0===i&&(i=0),e.prototype.setInputSize.call(this,t,i),this._aspectRatio=this._inputHeight/this._inputWidth,this.aspectRatio=this._aspectRatio},n()(t,[{key:"fractionalWidthOfAPixel",set:function(e){if(this._gl&&this._isActivated){var t=0;t=this._inputWidth?1/this._inputWidth:1/2048,this._fractionalWidthOfAPixel=e<t?t:e,this._gl.uniform1f(this._fractionalWidthOfAPixelUniform,this._fractionalWidthOfAPixel)}}},{key:"aspectRatio",set:function(e){this._aspectRatio=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._aspectRatioUniform,e)}}]),t}(s.default);t.default=u},"./src/filter/filter-saturation.ts":
/*!*****************************************!*\
  !*** ./src/filter/filter-saturation.ts ***!
  \*****************************************/
/*! exports provided: FILTER_SATURATION_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_SATURATION_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c='\nvarying highp vec2 textureCoordinate;\n \nuniform sampler2D inputImageTexture;\nuniform lowp float saturation;\n\n// Values from "Graphics Shaders: Theory and Practice" by Bailey and Cunningham\nconst mediump vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main()\n{\n   lowp vec4 textureColor = texture2D(inputImageTexture, textureCoordinate);\n   lowp float luminance = dot(textureColor.rgb, luminanceWeighting);\n   lowp vec3 greyScaleColor = vec3(luminance);\n   \n   gl_FragColor = vec4(mix(greyScaleColor, textureColor.rgb, saturation), textureColor.w);\n    \n}\n',u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._saturationUniform=null,i._saturation=1,i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._saturationUniform=this._gl.getUniformLocation(this._program,"saturation"),this.saturation=this._saturation)},n()(t,[{key:"saturation",set:function(e){e<0||e>2||(this._saturation=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._saturationUniform,e))}}]),t}(s.default);t.default=u},"./src/filter/filter-sepia.ts":
/*!************************************!*\
  !*** ./src/filter/filter-sepia.ts ***!
  \************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),n=i.n(r),o=function(e){function t(){return e.apply(this,arguments)||this}return n()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this.intensity=1,this.colorMatrix=[.3588,.7044,.1368,0,.299,.587,.114,0,.2392,.4696,.0912,0,0,0,0,1]},t}(i(/*! ./filter-color-matrix */"./src/filter/filter-color-matrix.ts").default);t.default=o},"./src/filter/filter-sharpen.ts":
/*!**************************************!*\
  !*** ./src/filter/filter-sharpen.ts ***!
  \**************************************/
/*! exports provided: FILTER_SHARPEN_VERTEX, FILTER_SHARPEN_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_SHARPEN_VERTEX",(function(){return c})),i.d(t,"FILTER_SHARPEN_FRAGMENT",(function(){return u}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\n\nuniform float imageWidthFactor; \nuniform float imageHeightFactor; \nuniform float sharpness;\n\nvarying vec2 textureCoordinate;\nvarying vec2 leftTextureCoordinate;\nvarying vec2 rightTextureCoordinate; \nvarying vec2 topTextureCoordinate;\nvarying vec2 bottomTextureCoordinate;\n\nvarying float centerMultiplier;\nvarying float edgeMultiplier;\n\nvoid main() {\n    gl_Position = position;\n\n    vec2 widthStep = vec2(imageWidthFactor, 0.0);\n    vec2 heightStep = vec2(0.0, imageHeightFactor);\n\n    textureCoordinate = inputTextureCoordinate.xy;\n    leftTextureCoordinate = inputTextureCoordinate.xy - widthStep;\n    rightTextureCoordinate = inputTextureCoordinate.xy + widthStep;\n    topTextureCoordinate = inputTextureCoordinate.xy + heightStep;     \n    bottomTextureCoordinate = inputTextureCoordinate.xy - heightStep;\n\n    centerMultiplier = 1.0 + 4.0 * sharpness;\n    edgeMultiplier = sharpness;\n}\n",u="\nprecision highp float;\n\nvarying highp vec2 textureCoordinate;\nvarying highp vec2 leftTextureCoordinate;\nvarying highp vec2 rightTextureCoordinate; \nvarying highp vec2 topTextureCoordinate;\nvarying highp vec2 bottomTextureCoordinate;\n\nvarying highp float centerMultiplier;\nvarying highp float edgeMultiplier;\n\nuniform sampler2D inputImageTexture;\n\nvoid main() {\n    mediump vec3 textureColor = texture2D(inputImageTexture, textureCoordinate).rgb;\n    mediump vec3 leftTextureColor = texture2D(inputImageTexture, leftTextureCoordinate).rgb;\n    mediump vec3 rightTextureColor = texture2D(inputImageTexture, rightTextureCoordinate).rgb;\n    mediump vec3 topTextureColor = texture2D(inputImageTexture, topTextureCoordinate).rgb;\n    mediump vec3 bottomTextureColor = texture2D(inputImageTexture, bottomTextureCoordinate).rgb;\n\n    gl_FragColor = vec4((textureColor * centerMultiplier - (leftTextureColor * edgeMultiplier + rightTextureColor * edgeMultiplier + topTextureColor * edgeMultiplier + bottomTextureColor * edgeMultiplier)), texture2D(inputImageTexture, bottomTextureCoordinate).w);\n}\n",l=function(e){function t(t){var i;return(i=e.call(this,t)||this)._imageWidthFactorUniform=null,i._imageHeightFactorUniform=null,i._sharpnessUniform=null,i._sharpness=0,i._texelWidth=0,i._texelHeight=0,i._vertexShader=c,i._fragmentShader=u,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._imageWidthFactorUniform=this._gl.getUniformLocation(this._program,"imageWidthFactor"),this._imageHeightFactorUniform=this._gl.getUniformLocation(this._program,"imageHeightFactor"),this._sharpnessUniform=this._gl.getUniformLocation(this._program,"sharpness"),this.sharpness=this._sharpness,this._gl.uniform1f(this._imageWidthFactorUniform,this._texelWidth),this._gl.uniform1f(this._imageHeightFactorUniform,this._texelHeight))},i.setInputSize=function(t){e.prototype.setInputSize.call(this,t),this._texelWidth=1/this._inputWidth,this._texelHeight=1/this._inputHeight,this._gl&&this._isActivated&&(this._gl.uniform1f(this._imageWidthFactorUniform,this._texelWidth),this._gl.uniform1f(this._imageHeightFactorUniform,this._texelHeight))},n()(t,[{key:"sharpness",set:function(e){e<-4||e>4||(this._sharpness=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._sharpnessUniform,e))}}]),t}(s.default);t.default=l},"./src/filter/filter-three-input.ts":
/*!******************************************!*\
  !*** ./src/filter/filter-three-input.ts ***!
  \******************************************/
/*! exports provided: FILTER_THREE_INPUT_VERTEX, default */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_THREE_INPUT_VERTEX",(function(){return d}));var r=i(/*! @babel/runtime/helpers/asyncToGenerator */"./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! @babel/runtime/regenerator */"./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i(/*! ../types/filter */"./src/types/filter.ts"),l=i(/*! ./filter-two-input */"./src/filter/filter-two-input.ts"),d="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\nattribute vec4 inputTextureCoordinate2;\nattribute vec4 inputTextureCoordinate3;\n\nvarying vec2 textureCoordinate;\nvarying vec2 textureCoordinate2;\nvarying vec2 textureCoordinate3;\n\nvoid main()\n{\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n    textureCoordinate2 = inputTextureCoordinate2.xy;\n    textureCoordinate3 = inputTextureCoordinate3.xy;\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._thirdTexture=null,i._inputTextureUniform3=null,i._thirdInput=void 0,i._thirdInputType=u.ResourceType.texture,i._texcoordBuffer3=null,i._inputTextureCoordinateAttrib3=0,i._vertexShader=d,i}a()(t,e);var i=t.prototype;return i.init=function(){var t=n()(c.a.mark((function t(i){var r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.prototype.init.call(this,i).then((function(e){if(!e.error){var t=r._gl;t&&(r._texcoordBuffer3=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r._texcoordBuffer3),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW))}return e})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;t&&i&&(this._inputTextureCoordinateAttrib3=t.getAttribLocation(i,"inputTextureCoordinate3"),t.enableVertexAttribArray(this._inputTextureCoordinateAttrib3),t.bindBuffer(t.ARRAY_BUFFER,this._texcoordBuffer3),t.vertexAttribPointer(this._inputTextureCoordinateAttrib3,2,t.FLOAT,!1,0,0),this._inputTextureUniform3=t.getUniformLocation(i,"inputImageTexture3"))},i.setInput=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=!1),e.prototype.setInput.call(this,t,i,r);var n=this._gl;if(n&&2===i)if(this._thirdInput=t,this._thirdInputType=this._getInputType(t),this._thirdInputType===u.ResourceType.texture){var o=this._thirdInput;this._thirdTexture=o.texture,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer),n.bindTexture(n.TEXTURE_2D,o.texture),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o.texture,0)}else this._thirdTexture=this._createAndSetupTexture(n),r&&(this._thirdInputType=u.ResourceType.texImageSourceStatic,n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this._thirdInput))},i.draw=function(){var e=this._gl;e&&this._input&&this._thirdInput&&(this._updateSize(),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this._thirdTexture),this._thirdInputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._thirdInput)):this._thirdInputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._thirdInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._thirdInput.texture,0)),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),this._secondInputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._secondInput)):this._secondInputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._secondInput.texture,0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),e.uniform1i(this._inputTextureUniform2,1),e.uniform1i(this._inputTextureUniform3,2),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._gl&&(this._gl.disableVertexAttribArray(this._inputTextureCoordinateAttrib3),this._thirdTexture&&this._gl.deleteTexture(this._thirdTexture),this._texcoordBuffer3&&this._gl.deleteBuffer(this._texcoordBuffer3)),e.prototype.destroy.call(this,t)},t}(l.default);t.default=h},"./src/filter/filter-two-input.ts":
/*!****************************************!*\
  !*** ./src/filter/filter-two-input.ts ***!
  \****************************************/
/*! exports provided: FILTER_TWO_INPUT_VERTEX, default */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_TWO_INPUT_VERTEX",(function(){return d}));var r=i(/*! @babel/runtime/helpers/asyncToGenerator */"./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! @babel/runtime/regenerator */"./node_modules/@babel/runtime/regenerator/index.js"),c=i.n(s),u=i(/*! ../types/filter */"./src/types/filter.ts"),l=i(/*! ./filter-base */"./src/filter/filter-base.ts"),d="\nattribute vec4 position;\nattribute vec4 inputTextureCoordinate;\nattribute vec4 inputTextureCoordinate2;\n\nvarying vec2 textureCoordinate;\nvarying vec2 textureCoordinate2;\n\nvoid main()\n{\n    gl_Position = position;\n    textureCoordinate = inputTextureCoordinate.xy;\n    textureCoordinate2 = inputTextureCoordinate2.xy;\n}\n",h=function(e){function t(t){var i;return(i=e.call(this,t)||this)._secondTexture=null,i._inputTextureUniform2=null,i._secondInput=void 0,i._secondInputType=u.ResourceType.texture,i._texcoordBuffer2=null,i._inputTextureCoordinateAttrib2=0,i._vertexShader=d,i}a()(t,e);var i=t.prototype;return i.init=function(){var t=n()(c.a.mark((function t(i){var r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.prototype.init.call(this,i).then((function(e){if(!e.error){var t=r._gl;t&&(r._texcoordBuffer2=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r._texcoordBuffer2),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW))}return e})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.active=function(){e.prototype.active.call(this);var t=this._gl,i=this._program;t&&i&&(this._inputTextureCoordinateAttrib2=t.getAttribLocation(i,"inputTextureCoordinate2"),t.enableVertexAttribArray(this._inputTextureCoordinateAttrib2),t.bindBuffer(t.ARRAY_BUFFER,this._texcoordBuffer2),t.vertexAttribPointer(this._inputTextureCoordinateAttrib2,2,t.FLOAT,!1,0,0),this._inputTextureUniform2=t.getUniformLocation(i,"inputImageTexture2"))},i.setInput=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!1);var r=this._gl;if(r)if(0===t)if(this._input=e,this._inputType=this._getInputType(e),this._inputType===u.ResourceType.texture){var n=this._input;this._texture=n.texture,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer),r.bindTexture(r.TEXTURE_2D,n.texture),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n.texture,0)}else this._texture=this._createAndSetupTexture(r),i&&(this._inputType=u.ResourceType.texImageSourceStatic,r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,this._input));else if(1===t)if(this._secondInput=e,this._secondInputType=this._getInputType(e),this._secondInputType===u.ResourceType.texture){var o=this._secondInput;this._secondTexture=o.texture,r.bindFramebuffer(r.FRAMEBUFFER,o.framebuffer),r.bindTexture(r.TEXTURE_2D,o.texture),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o.texture,0)}else this._secondTexture=this._createAndSetupTexture(r),i&&(this._secondInputType=u.ResourceType.texImageSourceStatic,r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,this._secondInput))},i.draw=function(){var e=this._gl;e&&this._input&&this._secondInput&&(this._updateSize(),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),this._secondInputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._secondInput)):this._secondInputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInput.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._secondInput.texture,0)),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===u.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===u.ResourceType.texture&&(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.bindFramebuffer(e.FRAMEBUFFER,this._input.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._input.texture,0)),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.uniform1i(this._inputTextureUniform,0),e.uniform1i(this._inputTextureUniform2,1),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._outputFBO||(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._gl&&(this._gl.disableVertexAttribArray(this._inputTextureCoordinateAttrib2),this._program&&this._gl.deleteProgram(this._program),this._texture&&this._inputType!==u.ResourceType.texture&&this._gl.deleteTexture(this._texture),this._secondTexture&&this._gl.deleteTexture(this._secondTexture),this._texcoordBuffer2&&this._gl.deleteBuffer(this._texcoordBuffer2)),e.prototype.destroy.call(this,t)},t}(l.default);t.default=h},"./src/filter/filter-two-pass-texture-sampling.ts":
/*!********************************************************************!*\
  !*** ./src/filter/filter-two-pass-texture-sampling.ts + 1 modules ***!
  \********************************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/asyncToGenerator.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/createClass.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/regenerator/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-base.ts because of ./src/index.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/types/filter.ts because of ./src/filter/adv/filter-background.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/webgl-utils.ts because of ./src/index.ts */function(e,t,i){"use strict";i.r(t);var r=i("./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),c=i.n(s),u=i("./node_modules/@babel/runtime/regenerator/index.js"),l=i.n(u),d=i("./src/types/filter.ts"),h=i("./src/utils/webgl-utils.ts"),p=function(e){function t(t){var i;return(i=e.call(this,t)||this)._verticalPassTexelWidthOffsetUniform=null,i._verticalPassTexelHeightOffsetUniform=null,i._horizontalPassTexelWidthOffsetUniform=null,i._horizontalPassTexelHeightOffsetUniform=null,i._verticalPassTexelWidthOffset=0,i._verticalPassTexelHeightOffset=0,i._horizontalPassTexelWidthOffset=0,i._horizontalPassTexelHeightOffset=0,i._verticalTexelSpacing=0,i._horizontalTexelSpacing=0,i._verticalTexelSpacing=0,i._horizontalTexelSpacing=0,i}a()(t,e);var i=t.prototype;return i.active=function(){e.prototype.active.call(this),this._gl&&this._program&&this._secondProgram&&(this._verticalPassTexelWidthOffsetUniform=this._gl.getUniformLocation(this._program,"texelWidthOffset"),this._verticalPassTexelHeightOffsetUniform=this._gl.getUniformLocation(this._program,"texelHeightOffset"),this._horizontalPassTexelWidthOffsetUniform=this._gl.getUniformLocation(this._secondProgram,"texelWidthOffset"),this._horizontalPassTexelHeightOffsetUniform=this._gl.getUniformLocation(this._secondProgram,"texelHeightOffset"),this.verticalTexelSpacing=1,this.horizontalTexelSpacing=1)},i.setInputSize=function(e){this._inputWidth=e.width,this._inputHeight=e.height,this._verticalPassTexelWidthOffset=0,this._verticalPassTexelHeightOffset=this._verticalTexelSpacing/this._inputHeight,this._horizontalPassTexelWidthOffset=this._horizontalTexelSpacing/this._inputWidth,this._horizontalPassTexelHeightOffset=0},i._setUniformsForProgramAtIndex=function(e){this._gl&&(0===e?(this._gl.uniform1f(this._verticalPassTexelWidthOffsetUniform,this._verticalPassTexelWidthOffset),this._gl.uniform1f(this._verticalPassTexelHeightOffsetUniform,this._verticalPassTexelHeightOffset),this._gl.viewport(0,0,this._gl.canvas.width,this._gl.canvas.height)):(this._gl.uniform1f(this._horizontalPassTexelWidthOffsetUniform,this._horizontalPassTexelWidthOffset),this._gl.uniform1f(this._horizontalPassTexelHeightOffsetUniform,this._horizontalPassTexelHeightOffset),this._updateSize()))},n()(t,[{key:"verticalTexelSpacing",set:function(e){this._verticalTexelSpacing=e,this._inputWidth&&this._inputHeight&&this.setInputSize({width:this._inputWidth,height:this._inputHeight})}},{key:"horizontalTexelSpacing",set:function(e){this._horizontalTexelSpacing=e,this._inputWidth&&this._inputHeight&&this.setInputSize({width:this._inputWidth,height:this._inputHeight})}}]),t}(function(e){function t(t){var i;return(i=e.call(this,t)||this)._secondProgram=null,i._secondPositionBuffer=null,i._secondTexcoordBuffer=null,i._secondTexture=null,i._secondInputFramebuffer=null,i._secondInputTextureUniform=null,i._secondInputTextureUniform2=null,i._secondVertexShader="",i._secondFragmentShader="",i._secondVShader=null,i._secondFShader=null,i._secondPositionAttrib=0,i._secondInputTextureCoordinateAttrib=0,i}a()(t,e);var i=t.prototype;return i.init=function(){var t=c()(l.a.mark((function t(i){var r=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.prototype.init.call(this,i).then((function(e){return e.error||(i&&(r._secondVertexShader=i.secondVertex||r._secondVertexShader,r._secondFragmentShader=i.secondFragment||r._secondFragmentShader),r._gl&&r._initSecond()),e})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.active=function(){e.prototype.active.call(this);var t=this._gl;t&&this._program&&this._secondProgram&&(this._secondInputTextureUniform=t.getUniformLocation(this._program,"inputImageTexture"),this._secondInputTextureUniform2=t.getUniformLocation(this._program,"inputImageTexture2"),this._secondPositionAttrib=t.getAttribLocation(this._secondProgram,"position"),this._secondInputTextureCoordinateAttrib=t.getAttribLocation(this._secondProgram,"inputTextureCoordinate"),t.enableVertexAttribArray(this._secondPositionAttrib),t.bindBuffer(t.ARRAY_BUFFER,this._positionBuffer),t.vertexAttribPointer(this._secondPositionAttrib,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this._secondInputTextureCoordinateAttrib),t.bindBuffer(t.ARRAY_BUFFER,this._texcoordBuffer),t.vertexAttribPointer(this._secondInputTextureCoordinateAttrib,2,t.FLOAT,!1,0,0))},i.setInput=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var n=this._gl;n&&(e.prototype.setInput.call(this,t,i,r),n.bindTexture(n.TEXTURE_2D,this._secondTexture),this._secondInputFramebuffer=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,this._secondInputFramebuffer),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.canvas.width,n.canvas.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this._secondTexture,0),n.bindFramebuffer(n.FRAMEBUFFER,null))},i.draw=function(){var e=this._gl;e&&this._program&&this._secondProgram&&(this._updateSize(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(this._program),this._setUniformsForProgramAtIndex(0),e.bindTexture(e.TEXTURE_2D,this._texture),this._inputType===d.ResourceType.texImageSource?(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._input)):this._inputType===d.ResourceType.texture&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.bindFramebuffer(e.FRAMEBUFFER,this._secondInputFramebuffer),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.useProgram(this._secondProgram),this._setUniformsForProgramAtIndex(1),e.bindTexture(e.TEXTURE_2D,this._secondTexture),e.bindFramebuffer(e.FRAMEBUFFER,this._outputFBO),e.drawArrays(e.TRIANGLE_STRIP,0,4),this._output&&(e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null)))},i.destroy=function(t){void 0===t&&(t=!1),this._gl&&(this._gl.disableVertexAttribArray(this._secondPositionAttrib),this._gl.disableVertexAttribArray(this._secondInputTextureCoordinateAttrib),this._secondProgram&&this._gl.deleteProgram(this._secondProgram),this._secondPositionBuffer&&this._gl.deleteBuffer(this._secondPositionBuffer),this._secondTexcoordBuffer&&this._gl.deleteBuffer(this._secondTexcoordBuffer),this._secondTexture&&this._gl.deleteTexture(this._secondTexture),this._secondInputFramebuffer&&this._gl.deleteFramebuffer(this._secondInputFramebuffer),this._secondVShader&&this._gl.deleteShader(this._secondVShader),this._secondFShader&&this._gl.deleteShader(this._secondFShader)),e.prototype.destroy.call(this,t)},i._initSecond=function(){var e=this._gl;if(e){var t=Object(h.createProgramFromSources)(e,this._secondVertexShader||this._vertexShader,this._secondFragmentShader||this._fragmentShader);this._secondVShader=t.vertexShader,this._secondFShader=t.fragmentShader,this._secondProgram=t.program,this._secondProgram&&(this._secondTexture=this._createAndSetupTexture(e))}},i._setUniformsForProgramAtIndex=function(e){},t}(i("./src/filter/filter-base.ts").default));t.default=p},"./src/filter/filter-unsharp-mask.ts":
/*!*******************************************!*\
  !*** ./src/filter/filter-unsharp-mask.ts ***!
  \*******************************************/
/*! exports provided: FILTER_UNSHARP_MASK_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_UNSHARP_MASK_FRAGMENT",(function(){return m}));var r=i(/*! @babel/runtime/helpers/asyncToGenerator */"./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),a=i.n(o),s=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),c=i.n(s),u=i(/*! @babel/runtime/regenerator */"./node_modules/@babel/runtime/regenerator/index.js"),l=i.n(u),d=i(/*! ./filter-base */"./src/filter/filter-base.ts"),h=i(/*! ./filter-gaussian-blur */"./src/filter/filter-gaussian-blur.ts"),p=i(/*! ./filter-group */"./src/filter/filter-group.ts"),f=i(/*! ./filter-two-input */"./src/filter/filter-two-input.ts"),m="\nvarying highp vec2 textureCoordinate;\nvarying highp vec2 textureCoordinate2;\n\nuniform sampler2D inputImageTexture;\nuniform sampler2D inputImageTexture2; \n\nuniform highp float intensity;\n\nvoid main()\n{\n    lowp vec4 sharpImageColor = texture2D(inputImageTexture, textureCoordinate);\n    lowp vec3 blurredImageColor = texture2D(inputImageTexture2, textureCoordinate2).rgb;\n    \n    gl_FragColor = vec4(sharpImageColor.rgb * intensity + blurredImageColor * (1.0 - intensity), sharpImageColor.a);\n//     gl_FragColor = mix(blurredImageColor, sharpImageColor, intensity);\n//     gl_FragColor = vec4(sharpImageColor.rgb - (blurredImageColor.rgb * intensity), 1.0);\n}\n",g=function(e){function t(t){var i;return(i=e.call(this,t)||this)._blurFilter=void 0,i._baseFilter=void 0,i._twoInputFilter=void 0,i._intensity=1,i._blurRadiusInPixels=5,i._blurFilter=new h.default(i._gl),i._baseFilter=new d.default(i._gl),i._twoInputFilter=new v(i._gl),i}c()(t,e);var i=t.prototype;return i.init=function(){var e=n()(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this._blurFilter.init(),this._baseFilter.init(),this._twoInputFilter.init()]).then((function(e){var i=e.filter((function(e){return!!e.error}));return i.length?i[0]:(t.addFilter(t._blurFilter),t.addFilter(t._baseFilter),t.addFilter(t._twoInputFilter),e[0])})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.setInput=function(e,t,i,r){this._input=e,this._blurFilter.active(),this._blurFilter.setInput(e),this._grapha&&r||(this._grapha=!0,this._blurFilter.drawToFBO(),this._baseFilter.active(),this._baseFilter.setInput(e),this._baseFilter.drawToFBO(),this._blurFilter.outputResource&&this._baseFilter.outputResource&&(this._twoInputFilter.active(),this._twoInputFilter.setInput(this._baseFilter.outputResource,0),this._twoInputFilter.setInput(this._blurFilter.outputResource,1)))},i.setInputSize=function(e){this._inputWidth=e.width,this._inputHeight=e.height,this._gl&&(this._blurFilter.setInputSize(e),this._baseFilter.setInputSize(e),this._twoInputFilter.setInputSize({width:this._gl.canvas.width,height:this._gl.canvas.height}))},i.active=function(){this._blurFilter&&this._twoInputFilter&&(this._blurFilter.active(),this._twoInputFilter.active(),this.blurRadiusInPixels=this._blurRadiusInPixels,this.intensity=this._intensity)},a()(t,[{key:"blurRadiusInPixels",set:function(e){e!==this._blurRadiusInPixels&&(this._blurRadiusInPixels=e,this._blurFilter.blurRadiusInPixels=e)}},{key:"intensity",set:function(e){e!==this._intensity&&(this._intensity=e,this._twoInputFilter.intensity=e)}}]),t}(p.default),v=function(e){function t(t){var i;return(i=e.call(this,t)||this)._intensity=1,i._intensityUniform=null,i._fragmentShader=m,i}return c()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._gl&&this._program&&(this._intensityUniform=this._gl.getUniformLocation(this._program,"intensity"),this.intensity=this._intensity)},a()(t,[{key:"intensity",set:function(e){this._intensity=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._intensityUniform,e)}}]),t}(f.default);t.default=g},"./src/filter/filter-white-balance.ts":
/*!********************************************!*\
  !*** ./src/filter/filter-white-balance.ts ***!
  \********************************************/
/*! exports provided: FILTER_WHITE_BALANCE_FRAGMENT, default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve) */function(e,t,i){"use strict";i.r(t),i.d(t,"FILTER_WHITE_BALANCE_FRAGMENT",(function(){return c}));var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! ./filter-base */"./src/filter/filter-base.ts"),c="\nuniform sampler2D inputImageTexture;\nvarying highp vec2 textureCoordinate;\n \nuniform lowp float temperature;\nuniform lowp float tint;\n\nconst lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);\n\nconst mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);\nconst mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);\n\nvoid main()\n{\n\tlowp vec4 source = texture2D(inputImageTexture, textureCoordinate);\n\t\n\tmediump vec3 yiq = RGBtoYIQ * source.rgb; //adjusting tint\n\tyiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);\n\tlowp vec3 rgb = YIQtoRGB * yiq;\n\n\tlowp vec3 processed = vec3(\n\t\t(rgb.r < 0.5 ? (2.0 * rgb.r * warmFilter.r) : (1.0 - 2.0 * (1.0 - rgb.r) * (1.0 - warmFilter.r))), //adjusting temperature\n\t\t(rgb.g < 0.5 ? (2.0 * rgb.g * warmFilter.g) : (1.0 - 2.0 * (1.0 - rgb.g) * (1.0 - warmFilter.g))), \n\t\t(rgb.b < 0.5 ? (2.0 * rgb.b * warmFilter.b) : (1.0 - 2.0 * (1.0 - rgb.b) * (1.0 - warmFilter.b))));\n\n\tgl_FragColor = vec4(mix(rgb, processed, temperature), source.a);\n}\n",u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._temperatureUniform=null,i._tintUniform=null,i._temperature=5e3,i._tint=0,i._fragmentShader=c,i}return a()(t,e),t.prototype.active=function(){e.prototype.active.call(this),this._program&&this._gl&&(this._temperatureUniform=this._gl.getUniformLocation(this._program,"temperature"),this._tintUniform=this._gl.getUniformLocation(this._program,"tint"),this.temperature=this._temperature,this.tint=this._tint)},n()(t,[{key:"temperature",set:function(e){this._temperature=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._temperatureUniform,e<5e3?4e-4*(e-5e3):6e-5*(e-5e3))}},{key:"tint",set:function(e){e<-100||e>100||(this._tint=e,this._gl&&this._isActivated&&this._gl.uniform1f(this._tintUniform,e/100))}}]),t}(s.default);t.default=u},"./src/index.ts":
/*!**********************************!*\
  !*** ./src/index.ts + 7 modules ***!
  \**********************************/
/*! exports provided: Processor, mix, background, virtualBackgroundKwai, dilation, bicubic, sepia, grayscale, pixellate, brightness, contrast, saturation, whiteBalance, gamma, sharpen, sketch, crayon, kuwahara, lomo, n1977, earlybird, hudson, kelvin, valencia, inkwell, redBlindCurrect, blueBlindCurrect, greenBlindCurrect, sketchInteractive, USM, beauty, beauty2, alpha */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/createClass.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@babel/runtime/helpers/inheritsLoose.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/config.ts because of ./src/filter/adv/filter-virtual-background-kwai.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/errors.ts because of ./src/core/renderer-worker.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/events.ts because of ./src/filter/adv/filter-background.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/filter-list.ts because of ./src/core/renderer-worker.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/renderer.ts because of ./src/core/renderer-worker.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/core/worker-cmd.ts because of ./src/core/renderer-worker.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-1977.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-background.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-beauty-tx.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-beauty.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-blue-blind-currect.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-crayon.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-earlybird.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-green-blind-currect.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-hudson.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-inkwell.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-kelvin.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-lomo.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-mix.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-red-blind-currect.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-sketch-2.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-sketch-interactive.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-valencia.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/adv/filter-virtual-background-kwai.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-alpha.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-bicubic.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-brightness.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-contrast.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-dilation.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-gamma.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-grayscale.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-kuwahara.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-pixellate.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-saturation.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-sepia.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-sharpen.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-unsharp-mask.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/filter/filter-white-balance.ts (<- Module is referenced from these modules with unsupported syntax: ./src/index.ts (referenced with require.resolve)) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/browser-helper.ts because of ./src/filter/adv/filter-virtual-background-kwai.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/log.ts because of ./src/filter/adv/filter-virtual-background-kwai.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/pixel-ratio.ts because of ./src/filter/adv/filter-virtual-background-kwai.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/tex-helper.ts because of ./src/filter/adv/filter-background.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/tex-proxy.ts because of ./src/filter/adv/filter-background.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/webgl-utils.ts because of ./src/core/renderer-worker.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/webworkify-webpack.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/worker-utils.ts because of ./src/filter/adv/filter-virtual-background-kwai.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/events/events.js (<- Module is not an ECMAScript module) */function(e,t,i){"use strict";i.r(t),i.d(t,"Processor",(function(){return Ae})),i.d(t,"mix",(function(){return Te})),i.d(t,"background",(function(){return _e})),i.d(t,"virtualBackgroundKwai",(function(){return xe})),i.d(t,"dilation",(function(){return ye})),i.d(t,"bicubic",(function(){return Ce})),i.d(t,"sepia",(function(){return be})),i.d(t,"grayscale",(function(){return Ee})),i.d(t,"pixellate",(function(){return Se})),i.d(t,"brightness",(function(){return Ie})),i.d(t,"contrast",(function(){return we})),i.d(t,"saturation",(function(){return Re})),i.d(t,"whiteBalance",(function(){return ke})),i.d(t,"gamma",(function(){return Pe})),i.d(t,"sharpen",(function(){return De})),i.d(t,"sketch",(function(){return Oe})),i.d(t,"crayon",(function(){return Le})),i.d(t,"kuwahara",(function(){return Me})),i.d(t,"lomo",(function(){return Ne})),i.d(t,"n1977",(function(){return Ue})),i.d(t,"earlybird",(function(){return Be})),i.d(t,"hudson",(function(){return Fe})),i.d(t,"kelvin",(function(){return Ve})),i.d(t,"valencia",(function(){return He})),i.d(t,"inkwell",(function(){return je})),i.d(t,"redBlindCurrect",(function(){return Ge})),i.d(t,"blueBlindCurrect",(function(){return ze})),i.d(t,"greenBlindCurrect",(function(){return We})),i.d(t,"sketchInteractive",(function(){return qe})),i.d(t,"USM",(function(){return Ye})),i.d(t,"beauty",(function(){return Qe})),i.d(t,"beauty2",(function(){return Ke})),i.d(t,"alpha",(function(){return Je}));var r=i("./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i("./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i("./node_modules/events/events.js"),c=i("./src/config.ts"),u=i("./src/core/errors.ts"),l=i("./src/core/events.ts"),d=i("./src/core/filter-list.ts"),h=i("./src/utils/log.ts"),p="keep-alive",f=function(){var e=t.prototype;function t(){var e;this._cb=void 0,this._ctx=void 0,this._gain=void 0,this._oscillator=void 0,this._tickScriptNode=void 0,this._alwaysWorking=!(!(navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent)||navigator.userAgent.match("CriOS")),this._alwaysWorking&&(this._init(),this._connectAll(),null==(e=this._oscillator)||e.start())}return e.setFPS=function(e){},e.start=function(e){var t;h.Log.i(p,"start"),this._cb=e,this._ctx||this._init(),!this._oscillator&&this._ctx&&(this._oscillator=this._ctx.createOscillator()),this._alwaysWorking||(this._connectAll(),null==(t=this._oscillator)||t.start())},e.stop=function(){h.Log.i(p,"stop"),this._cb=void 0,this._alwaysWorking||(this._disconnectAll(),this._removeOscillator())},e.destroy=function(){this._cb=void 0,this._disconnectAll(),this._removeOscillator(),this._ctx&&(this._ctx.close(),this._ctx=void 0)},e._removeOscillator=function(){this._oscillator&&(this._oscillator.disconnect(),this._oscillator.stop(),this._oscillator=void 0)},e._init=function(){var e=this,t=window.AudioContext||window.webkitAudioContext;if(!this._ctx&&t){var i=this._ctx=new t;this._gain||(this._gain=i.createGain()),this._gain.gain.value=0,this._oscillator||(this._oscillator=i.createOscillator()),i.createScriptProcessor&&ScriptProcessorNode&&(h.Log.i(p,"script tick"),(this._tickScriptNode=i.createScriptProcessor(512,1,1)).onaudioprocess=function(){e._cb&&e._cb()})}},e._connectAll=function(){var e=this._tickScriptNode;this._ctx&&e&&this._oscillator&&this._gain&&(this._oscillator.connect(e),e.connect(this._gain),this._gain.connect(this._ctx.destination))},e._disconnectAll=function(){var e,t,i;null==(e=this._oscillator)||e.disconnect(),null==(t=this._tickScriptNode)||t.disconnect(),null==(i=this._gain)||i.disconnect()},t}(),m=i("./src/utils/pixel-ratio.ts"),g=i("./src/utils/tex-helper.ts"),v=i("./src/utils/webgl-utils.ts"),A=i("./src/utils/webworkify-webpack.js"),T=i.n(A),_=/console\.log\(1001\)(,|;)+/i,x=/console\.log\(1002\)(,|;)+/i,y=/console\.log\(1003\)(,|;)+/i,C={},b={};function E(e,t){C[e]=t,b[t]=e}function S(e,t){return function(e){var t="",i="";return I().forEach((function(e,r){var n=C[e];if(n){var o="_filter_filter_"+e+"__WEBPACK_IMPORTED_MODULE_"+(1e3+r)+"__";t+="var "+o+' = __webpack_require__("'+n+'");',i+="flist['"+e+"'] = { id: '"+e+"', filter: "+o+'["default"]};'}})),t&&i&&(e=(e=(e=e.replace(_,t)).replace(x,"")).replace(y,i)),e}(e)}function I(){var e=Object.keys(d.FilterList),t=e.indexOf("base");return t>=0&&e.splice(t,1),e}var w=i("./src/utils/worker-utils.ts"),R=function(){function e(){var e=this;this._video=null,this._isVideoPlaybackQualityAvailable=!1,this._sourceFPS=0,this._lastCalculateFPSFrames=0,this._lastCalculateFPSTime=0,this._lastRenderTime=0,this._lastRenderDuration=0,this._autoSkip=!0,this._frameDuration=Math.floor(40),this._hasOverriddenFPS=!1,this._skip=0,this._seeked=function(){e._lastCalculateFPSTime=0,e._lastCalculateFPSFrames=0}}var t=e.prototype;return t.destroy=function(){this.detachMedia()},t.attachMedia=function(e){this.destroy();var t=this._video=e instanceof window.HTMLVideoElement?e:null;t&&(this._isVideoPlaybackQualityAvailable="function"==typeof t.getVideoPlaybackQuality,t.addEventListener("seeked",this._seeked))},t.detachMedia=function(){this._video&&this._video.removeEventListener("seeked",this._seeked),this._video=null},t.setFPS=function(e){e>0&&(this._hasOverriddenFPS=!0,this._frameDuration=Math.floor(1e3/e))},t.setAutoSkip=function(e){this._autoSkip=e},t.update=function(){var e=this._video;if(e){var t=performance.now();if(!this._hasOverriddenFPS){var i=0;if(this._isVideoPlaybackQualityAvailable){var r=e.getVideoPlaybackQuality();i=r.totalVideoFrames+r.droppedVideoFrames}else i=e.webkitDecodedFrameCount||0+e.webkitDroppedFrameCount||0;if(this._lastCalculateFPSTime){if(t-this._lastCalculateFPSTime>=2e3){var n=(i-this._lastCalculateFPSFrames)/(t-this._lastCalculateFPSTime)*1e3;this._frameDuration=Math.floor(1e3/Math.max(25,this._sourceFPS,n)),this._sourceFPS=n,this._lastCalculateFPSFrames=i,this._lastCalculateFPSTime=t}}else this._lastCalculateFPSTime=t,this._lastCalculateFPSFrames=i}return!this._lastRenderTime||t-this._lastRenderTime>=this._frameDuration-1&&this._skip<=0?(this._lastRenderTime=t,this._autoSkip&&this._lastRenderDuration&&1e3/this._lastRenderDuration<15&&(this._skip=this._lastRenderDuration>this._frameDuration?1:0),this._lastRenderDuration=0,!0):(this._autoSkip&&this._skip--,!1)}return this._sourceFPS=0,!1},t.onDraw=function(e){this._lastRenderDuration=e.duration},n()(e,[{key:"frameDuration",get:function(){return this._frameDuration}}]),e}(),k=function(){function e(e){this._eventEmitter=void 0,this._drawTimeRec=[],this._now=performance.now(),this._rec=void 0,this._avgDrawTime=0,this._lastDrawTime=0,this._lastDrawDuration=0,this._lastHBTime=0,this._fps=0,this._animationCnt=0,this._eventEmitter=e}var t=e.prototype;return t.destroy=function(){},t.startTimeLog=function(){this._rec={data:[],st:performance.now(),ed:0}},t.stopTimeLog=function(){var e=this._rec;return e&&(e.ed=performance.now()),this._rec=void 0,e},t.drawStart=function(){this._now=performance.now()},t.drawEnd=function(e){var t=performance.now(),i={ts:this._now,duration:t-this._now};e&&(i.details=e),this._drawTimeRec.push(i),this._rec&&this._rec.data.push(i),this._drawTimeRec.length>2400&&this._drawTimeRec.shift()},t.recDrawTime=function(e){this._lastDrawTime=e.ts,this._lastDrawDuration=e.duration,this._drawTimeRec.push(e),this._rec&&this._rec.data.push(e),this._drawTimeRec.length>2400&&this._drawTimeRec.shift()},t.loop=function(){this._animationCnt++;var e=performance.now();if(this._lastHBTime||(this._lastHBTime=e),this._drawTimeRec.length&&e-this._lastHBTime>1e3){this._lastHBTime=e,this._avgDrawTime=this._drawTimeRec.reduce((function(e,t){return e+t.duration}),0)/this._drawTimeRec.length;var t=this._drawTimeRec.length;this._drawTimeRec=[],this._eventEmitter.emit(l.default.HEARTBEAT,{animationFps:this._animationCnt,fps:t,avgDrawTime:this._avgDrawTime}),this._animationCnt=0}},n()(e,[{key:"avgDrawTime",get:function(){return this._avgDrawTime}},{key:"lastDrawDuration",get:function(){return this._lastDrawDuration}},{key:"lastDrawTime",get:function(){return this._lastDrawTime}},{key:"fps",get:function(){return this._fps}}]),e}(),P=i("./src/core/renderer.ts"),D=i("./src/core/worker-cmd.ts"),O="renderer-m",L=function(){function e(e,t){var i=this;this._config=void 0,this._eventEmiter=void 0,this._w=void 0,this._wFrameQueue=[],this._renderer=void 0,this._rEvent=void 0,this._output=void 0,this._outputSize={width:0,height:0},this._animation=!1,this._source=void 0,this._fps=void 0,this._monitor=void 0,this._keepAliveFrame=new f,this._filterName="base",this._dynamicTextureParams=void 0,this._drawing=!1,this._outputCtx=null,this._pendingFilter=void 0,this._loop=function(){i._animation&&(i._loopDraw(),requestAnimationFrame(i._loop))},this._loopDraw=function(){if(i._w){var e=i._wFrameQueue.shift();i._outputCtx&&i._output&&e&&!(i._output instanceof WebGLRenderingContext)&&(i._outputCtx.clearRect(0,0,i._output.width,i._output.height),i._outputCtx.drawImage(e.bitmap,0,0),i._monitor.recDrawTime(e.time))}i._monitor.loop(),!i._drawing&&i._fps.update()&&i.draw()},this._onVisibilitychange=function(){document.hidden?i._keepAliveFrame.start((function(){i._loopDraw()})):i._keepAliveFrame.stop()},this._onWorkMessage=function(e){var t=e.data;i._onMessage(e.data.event,t.data)},this._onMessage=function(e,t){switch(e){case l.default.DRAWN:i._drawing=!1,t&&(t.time.duration=performance.now()-t.time.ts,i._w?t.bitmap&&(i._wFrameQueue.push(t),i._wFrameQueue.length>3&&(i._wFrameQueue.shift(),h.Log.i(O,"drop")),i._fps.onDraw(t.time)):(i._fps.onDraw(t.time),i._monitor.recDrawTime(t.time)));break;case l.default.FILTER_SELECTED:i._filterName=t.name,i._eventEmiter.emit(e,t);break;default:i._eventEmiter.emit(e,t)}},this._eventEmiter=e,this._config=t,this._monitor=new k(e),this._fps=new R}var t=e.prototype;return t._initRenderer=function(){var e=this;if(this._source&&this._output){var t,i;if(this._config.webWorker&&(this._output instanceof HTMLCanvasElement||this._output instanceof OffscreenCanvas)&&Object(w.isWorkerSupported)()){this._outputCtx||(this._outputCtx=this._output.getContext("2d"));try{var r=[/*! ./renderer-worker */"./src/core/renderer-worker.ts"].concat((t=Object.keys(d.FilterList),i=[],t.forEach((function(e){var t=C[e];t&&i.push(t)})),i));this._w=T()(r,{inject:S})}catch(e){}}if(!this._w||this._output instanceof WebGLRenderingContext){h.Log.i(O,"init renderer");var n=this._rEvent=new s.EventEmitter;this._renderer=new P.default(n),n.on(l.default.ERROR,(function(t){return e._onMessage(l.default.ERROR,t)})),n.on(l.default.DRAWN,(function(t){return e._onMessage(l.default.DRAWN,t)})),n.on(l.default.FILTER_SELECTED,(function(t){return e._onMessage(l.default.FILTER_SELECTED,t)})),this._renderer.init(this._config,this._output),this._attachRendererSource()}else h.Log.i(O,"init renderer worker"),this._w.addEventListener("message",this._onWorkMessage),this._w.postMessage({cmd:D.WorkerCmd.INIT,config:this._config,output:{width:this._output.width,height:this._output.height}});this._fps.setAutoSkip(!this._w),this._eventEmiter.emit(l.default.INIT,{worker:!!this._w}),this._pendingFilter&&(this.select(this._pendingFilter.name,!0),this._pendingFilter.params&&this.setParams(this._pendingFilter.params),this._pendingFilter=void 0)}},t.attachSource=function(e){h.Log.i(O,"attachSource"),this._source=e,this._drawing=!1,this._w||this._renderer||this._initRenderer(),this._attachRendererSource()},t.detachSource=function(){this._fps.detachMedia(),this._source=void 0},t.attachOutput=function(e){this._output=e,this._checkOutputSizeUpdate(),(this._w||this._renderer)&&this._destroyRenderer(),this._w||this._renderer||this._initRenderer()},t.detachOutput=function(){this._output=void 0},t.select=function(e,t){h.Log.i(O,"select",e),this._drawing=!1,this._dynamicTextureParams=void 0,this._w?this._w.postMessage({cmd:D.WorkerCmd.SELECT,name:e,immediate:t}):this._renderer?this._renderer.select(e,t):this._pendingFilter={name:e}},t.setFPS=function(e){h.Log.i(O,"setFPS",e),this._fps.setFPS(e)},t.start=function(){h.Log.i(O,"start",this._animation),this._animation||(this._setAnimation(!0),requestAnimationFrame(this._loop))},t.end=function(e){void 0===e&&(e=!0),h.Log.i(O,"end updateBeforeEnd:"+e),this._setAnimation(!1),e&&this.draw()},t.pause=function(){h.Log.i(O,"pause"),this._setAnimation(!1)},t.draw=function(){this._drawing=!0;var e=this._w,t=performance.now();if(this._checkOutputSizeUpdate(),e){if(!this._source)return;if(this._dynamicTextureParams)return void Promise.all([Object(g.getParamsTex4Trans)(this._dynamicTextureParams),Object(g.tex2ImageBitmap)(this._source)]).then((function(i){i[0]&&e.postMessage({cmd:D.WorkerCmd.SET_PARAMS,params:i[0].params},i[0].tex),e.postMessage({cmd:D.WorkerCmd.DRAW,data:i[1],ts:t},Object(g.tex4Trans)([i[1]]))}));Object(g.tex2ImageBitmap)(this._source).then((function(i){i&&e.postMessage({cmd:D.WorkerCmd.DRAW,data:i,ts:t},Object(g.tex4Trans)([i]))}))}else this._renderer&&this._renderer.draw(t,void 0)},t.setParams=function(e){var t=this._w;t?(this._dynamicTextureParams=Object(g.getTexParams)(e),Object(g.getParamsTex4Trans)(e).then((function(i){i?t.postMessage({cmd:D.WorkerCmd.SET_PARAMS,params:i.params},i.tex):t.postMessage({cmd:D.WorkerCmd.SET_PARAMS,params:e})}))):this._renderer?this._renderer.setParams(e):this._pendingFilter&&(this._pendingFilter.params=e)},t.setFilters=function(e){e.forEach((function(e){e&&!d.FilterList[e.id]&&(d.FilterList[e.id]=e)}))},t.destroy=function(){h.Log.i(O,"destroy"),this._rEvent&&(this._rEvent.removeAllListeners(),this._rEvent=void 0),this._destroyRenderer(),this._monitor.destroy(),this._fps.destroy(),this._keepAliveFrame.destroy(),document.removeEventListener("visibilitychange",this._onVisibilitychange)},t.startTimeLog=function(){this._monitor.startTimeLog()},t.stopTimeLog=function(){return this._monitor.stopTimeLog()},t._checkOutputSizeUpdate=function(){var e=m.PixelRatio.pixelRatio;this._output instanceof HTMLCanvasElement&&(this._output.width!==this._output.clientWidth*e||this._outputSize.height!==this._output.clientHeight*e)&&(this._recordCanvasSize(e),Object(v.resizeCanvasToDisplaySize)(this._output,e),this._w?this._w.postMessage({cmd:D.WorkerCmd.UPDATE_OUTPUT_SIZE,w:this._outputSize.width,h:this._outputSize.height}):this._renderer&&this._renderer.updateOutputSize(this._outputSize.width,this._outputSize.height))},t._destroyRenderer=function(){this._w?(this._w.removeEventListener("message",this._onWorkMessage),this._w.terminate(),this._w=void 0):this._renderer&&(this._renderer.destroy(),this._renderer=void 0)},t._attachRendererSource=function(){this._source&&(this._renderer&&this._renderer.attachSource(this._source),this._source instanceof HTMLVideoElement&&this._fps.attachMedia(this._source))},t._recordCanvasSize=function(e){void 0===e&&(e=1),this._output&&this._output instanceof HTMLCanvasElement&&(this._outputSize.width=this._output.clientWidth*e||this._output.width||0,this._outputSize.height=this._output.clientHeight*e||this._output.height||0)},t._setAnimation=function(e){this._animation=e,this._config.keepAlive&&(this._animation?document.addEventListener("visibilitychange",this._onVisibilitychange):(this._keepAliveFrame.stop(),document.removeEventListener("visibilitychange",this._onVisibilitychange)))},n()(e,[{key:"isAnimation",get:function(){return this._animation}},{key:"currentFilterName",get:function(){return this._filterName}}]),e}(),M=i("./src/filter/adv/filter-1977.ts"),N=i("./src/filter/adv/filter-background.ts"),U=i("./src/filter/adv/filter-beauty.ts"),B=i("./src/filter/adv/filter-beauty-tx.ts"),F=i("./src/filter/adv/filter-blue-blind-currect.ts"),V=i("./src/filter/adv/filter-crayon.ts"),H=i("./src/filter/adv/filter-earlybird.ts"),j=i("./src/filter/adv/filter-green-blind-currect.ts"),G=i("./src/filter/adv/filter-hudson.ts"),z=i("./src/filter/adv/filter-inkwell.ts"),W=i("./src/filter/adv/filter-kelvin.ts"),q=i("./src/filter/adv/filter-lomo.ts"),Y=i("./src/filter/adv/filter-mix.ts"),Q=i("./src/filter/adv/filter-red-blind-currect.ts"),K=i("./src/filter/adv/filter-sketch-2.ts"),J=i("./src/filter/adv/filter-sketch-interactive.ts"),X=i("./src/filter/adv/filter-valencia.ts"),Z=i("./src/filter/adv/filter-virtual-background-kwai.ts"),$=i("./src/filter/filter-alpha.ts"),ee=i("./src/filter/filter-bicubic.ts"),te=i("./src/filter/filter-brightness.ts"),ie=i("./src/filter/filter-contrast.ts"),re=i("./src/filter/filter-dilation.ts"),ne=i("./src/filter/filter-gamma.ts"),oe=i("./src/filter/filter-grayscale.ts"),ae=i("./src/filter/filter-kuwahara.ts"),se=i("./src/filter/filter-pixellate.ts"),ce=i("./src/filter/filter-saturation.ts"),ue=i("./src/filter/filter-sepia.ts"),le=i("./src/filter/filter-sharpen.ts"),de=i("./src/filter/filter-unsharp-mask.ts"),he=i("./src/filter/filter-white-balance.ts"),pe=i("./src/utils/browser-helper.ts"),fe=function(){function e(){this.timeout=6048e5}var t=e.prototype;return t.write=function(t,i){e.available&&localStorage.setItem(t,JSON.stringify({value:i,time:Date.now()}))},t.read=function(t){if(e.available)try{var i=localStorage.getItem(t);if(i){var r=JSON.parse(i),n=r.value,o=r.time,a=void 0===o?0:o;if(Date.now()-a<this.timeout)return n}}catch(e){}},n()(e,null,[{key:"available",get:function(){if(void 0===e._available)try{localStorage.setItem("kwai-h5","test"),e._available=!0}catch(t){e._available=!1}return e._available}}]),e}();fe._available=void 0;var me=fe,ge=i("./src/utils/tex-proxy.ts"),ve="kwai-vpp",Ae=function(e){function t(i){var r;(r=e.call(this)||this)._source=void 0,r._render=void 0,r._eventEmiter=void 0,r._config=void 0,r._texProxy=void 0,r._onTexImageReady=function(){r._source instanceof HTMLVideoElement?r._render.isAnimation||r._render.start():r._render.draw()},r._onTexImageEmptied=function(){r._render.end(!1)},r._onError=function(e){h.Log.i(ve,"error",JSON.stringify(e)),r.emit(l.default.ERROR,e)},r._config=c.ConfigHelper.processConfig(i),r._eventEmiter=new s.EventEmitter,r._eventEmiter.on(l.default.INIT,(function(e){return r.emit(l.default.INIT,e)})),r._eventEmiter.on(l.default.FILTER_SELECTED,(function(e){return r.emit(l.default.FILTER_SELECTED,e)})),r._eventEmiter.on(l.default.ERROR,r._onError),r._eventEmiter.on(l.default.HEARTBEAT,(function(e){return r.emit(l.default.HEARTBEAT,e)})),r._render=new L(r._eventEmiter,r._config),r._texProxy=new ge.default,r._texProxy.on(l.default.RES_READY,r._onTexImageReady),r._texProxy.on(l.default.RES_EMPTIED,r._onTexImageEmptied);var n=(new me).read("kwai-vpp-log");return n&&(r._config.log=n),h.Log.level(r._config.log),h.Log.i(ve,t.version,i,r._config),r}a()(t,e),t.isSupported=function(e){return void 0===e&&(e=!1),!pe.default.isMSIE&&Object(v.isSupported)(e)};var i=t.prototype;return i.setFilters=function(e){h.Log.i(ve,"setFilters"),this._render.setFilters(e)},i.setMediaInfo=function(e){h.Log.i(ve,"setMediaInfo",e),e.fps&&this._render.setFPS(e.fps)},i.attachSource=function(e){h.Log.i(ve,"attachSource"),this._source=e,this._render.attachSource(e),Object(g.isTexImageSource)(e)&&this._texProxy.init(e),Object(g.isSourceReady)(this._source)&&(e instanceof HTMLVideoElement?this._render.start():this._render.draw())},i.detachSource=function(){h.Log.i(ve,"detachSource"),this._render.pause(),this._render.detachSource(),this._texProxy.unbindSource()},i.draw=function(){h.Log.i(ve,"draw"),this._render.draw()},i.attachOutputCanvas=function(e,t){h.Log.i(ve,"attachOutputCanvas"),this._render.attachOutput(t||e)},i.detachOutputCanvas=function(){h.Log.i(ve,"detachOutputCanvas"),this._render.detachOutput()},i.select=function(e){if(h.Log.i(ve,"select",e),Array.isArray(e))if(0===e.length)e="base";else{var t=e.filter((function(e){return!d.FilterList[e]}));if(t.length)return void this._onError({code:u.ErrorCode.FILTER_SELECT_ERROR,reason:"选择的滤镜"+t+"不可用"});1===e.length&&(e=e[0])}else if(!d.FilterList[e])return void this._onError({code:u.ErrorCode.FILTER_SELECT_ERROR,reason:"选择的滤镜"+e+"不可用"});var i=this._source&&Object(g.isSourceReady)(this._source);this._render.select(e,!0),i&&this._render.draw()},i.setParams=function(e){if(h.Log.i(ve,"setParams",e),Array.isArray(e)){if(0===e.length)return;1===e.length&&e[0]&&!Array.isArray(this._render.currentFilterName)&&(e=e[0])}this._render.setParams(e)},i.destroy=function(){h.Log.i(ve,"destroy"),this._texProxy.destroy(),this._render.destroy(),this._eventEmiter.removeAllListeners(),this.removeAllListeners()},i.startTimeLog=function(){this._render.startTimeLog()},i.stopTimeLog=function(){return this._render.stopTimeLog()},n()(t,[{key:"currentFilterName",get:function(){return this._render.currentFilterName}},{key:"filters",get:function(){var e=[];return Object.keys(d.FilterList).forEach((function(t){e.push({name:t,paramsInfo:d.FilterList[t].paramsInfo,extra:d.FilterList[t].extra})})),e}}],[{key:"version",get:function(){return"1.2.2"}}]),t}(s.EventEmitter),Te={id:"mix",filter:Y.default,paramsInfo:{mixCanvas:{}},extra:{filterColorMap:{base:[1,0,0],sepia:[15,0,0],grayscale:[25,0,0],sketch:[35,0,0],binary:[45,0,0]}}};E(Te.id,/*! ./filter/adv/filter-mix */"./src/filter/adv/filter-mix.ts");var _e={id:"background",filter:N.default,paramsInfo:{background:{}}};E(_e.id,/*! ./filter/adv/filter-background */"./src/filter/adv/filter-background.ts");var xe={id:"virtualBackgroundKwai",filter:Z.default,paramsInfo:{background:{},backgroundType:{min:0,default:1,max:2}}};E(xe.id,/*! ./filter/adv/filter-virtual-background-kwai */"./src/filter/adv/filter-virtual-background-kwai.ts");var ye={id:"dilation",filter:re.default};E(ye.id,/*! ./filter/filter-dilation */"./src/filter/filter-dilation.ts");var Ce={id:"bicubic",filter:ee.default};E(Ce.id,/*! ./filter/filter-bicubic */"./src/filter/filter-bicubic.ts");var be={id:"sepia",filter:ue.default};E(be.id,/*! ./filter/filter-sepia */"./src/filter/filter-sepia.ts");var Ee={id:"grayscale",filter:oe.default};E(Ee.id,/*! ./filter/filter-grayscale */"./src/filter/filter-grayscale.ts");var Se={id:"pixellate",filter:se.default};E(Se.id,/*! ./filter/filter-pixellate */"./src/filter/filter-pixellate.ts");var Ie={id:"brightness",filter:te.default,paramsInfo:{brightness:{min:-1,max:1,default:0}}};E(Ie.id,/*! ./filter/filter-brightness */"./src/filter/filter-brightness.ts");var we={id:"contrast",filter:ie.default,paramsInfo:{contrast:{min:0,max:4,default:1}}};E(we.id,/*! ./filter/filter-contrast */"./src/filter/filter-contrast.ts");var Re={id:"saturation",filter:ce.default,paramsInfo:{saturation:{min:0,max:2,default:1}}};E(Re.id,/*! ./filter/filter-saturation */"./src/filter/filter-saturation.ts");var ke={id:"whiteBalance",filter:he.default,paramsInfo:{temperature:{min:1e3,max:1e4,default:5e3},tint:{min:-100,max:100,default:0}}};E(ke.id,/*! ./filter/filter-white-balance */"./src/filter/filter-white-balance.ts");var Pe={id:"gamma",filter:ne.default,paramsInfo:{gamma:{min:0,max:3,default:1}}};E(Pe.id,/*! ./filter/filter-gamma */"./src/filter/filter-gamma.ts");var De={id:"sharpen",filter:le.default,paramsInfo:{sharpness:{min:-4,max:4,default:0}}};E(De.id,/*! ./filter/filter-sharpen */"./src/filter/filter-sharpen.ts");var Oe={id:"sketch",filter:K.default};E(Oe.id,/*! ./filter/adv/filter-sketch-2 */"./src/filter/adv/filter-sketch-2.ts");var Le={id:"crayon",filter:V.default};E(Le.id,/*! ./filter/adv/filter-crayon */"./src/filter/adv/filter-crayon.ts");var Me={id:"kuwahara",filter:ae.default};E(Me.id,/*! ./filter/filter-kuwahara */"./src/filter/filter-kuwahara.ts");var Ne={id:"lomo",filter:q.default};E(Ne.id,/*! ./filter/adv/filter-lomo */"./src/filter/adv/filter-lomo.ts");var Ue={id:"n1977",filter:M.default};E(Ue.id,/*! ./filter/adv/filter-1977 */"./src/filter/adv/filter-1977.ts");var Be={id:"earlybird",filter:H.default};E(Be.id,/*! ./filter/adv/filter-earlybird */"./src/filter/adv/filter-earlybird.ts");var Fe={id:"hudson",filter:G.default};E(Fe.id,/*! ./filter/adv/filter-hudson */"./src/filter/adv/filter-hudson.ts");var Ve={id:"kelvin",filter:W.default};E(Ve.id,/*! ./filter/adv/filter-kelvin */"./src/filter/adv/filter-kelvin.ts");var He={id:"valencia",filter:X.default};E(He.id,/*! ./filter/adv/filter-valencia */"./src/filter/adv/filter-valencia.ts");var je={id:"inkwell",filter:z.default};E(je.id,/*! ./filter/adv/filter-inkwell */"./src/filter/adv/filter-inkwell.ts");var Ge={id:"redBlindCurrect",filter:Q.default,paramsInfo:{intensity:{min:0,max:10,default:8}}};E(Ge.id,/*! ./filter/adv/filter-red-blind-currect */"./src/filter/adv/filter-red-blind-currect.ts");var ze={id:"blueBlindCurrect",filter:F.default,paramsInfo:{intensity:{min:0,max:10,default:8}}};E(Ge.id,/*! ./filter/adv/filter-blue-blind-currect */"./src/filter/adv/filter-blue-blind-currect.ts");var We={id:"greenBlindCurrect",filter:j.default,paramsInfo:{intensity:{min:0,max:10,default:8}}};E(Ge.id,/*! ./filter/adv/filter-green-blind-currect */"./src/filter/adv/filter-green-blind-currect.ts");var qe={id:"sketchInteractive",filter:J.default,paramsInfo:{mouse:{}}};E(qe.id,/*! ./filter/adv/filter-sketch-interactive */"./src/filter/adv/filter-sketch-interactive.ts");var Ye={id:"USM",filter:de.default,paramsInfo:{intensity:{min:0,default:1.3,max:3}}};E(Ye.id,/*! ./filter/filter-unsharp-mask */"./src/filter/filter-unsharp-mask.ts");var Qe={id:"beauty",filter:U.default,paramsInfo:{intensity:{min:0,max:1,default:.5}}};E(Qe.id,/*! ./filter/adv/filter-beauty */"./src/filter/adv/filter-beauty.ts");var Ke={id:"beauty2",filter:B.default,paramsInfo:{brightness:{min:-1,max:1,default:.5},beauty:{min:-1,max:1,default:.5},ruddy:{min:-1,max:1,default:.5}}};E(Ke.id,/*! ./filter/adv/filter-beauty-tx */"./src/filter/adv/filter-beauty-tx.ts");var Je={id:"alpha",filter:$.default};E(Je.id,/*! ./filter/filter-alpha */"./src/filter/filter-alpha.ts")},"./src/res/vignette-map.ts":
/*!*********************************!*\
  !*** ./src/res/vignette-map.ts ***!
  \*********************************/
/*! exports provided: VIGNETTE_MAP */function(e,t,i){"use strict";i.r(t),i.d(t,"VIGNETTE_MAP",(function(){return r}));var r="data:image/png;base64,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"},"./src/types/filter.ts":
/*!*****************************!*\
  !*** ./src/types/filter.ts ***!
  \*****************************/
/*! exports provided: ResourceType */function(e,t,i){"use strict";var r;i.r(t),i.d(t,"ResourceType",(function(){return r})),function(e){e[e.texture=0]="texture",e[e.texImageSource=1]="texImageSource",e[e.texImageSourceStatic=2]="texImageSourceStatic"}(r||(r={}))},"./src/types/main.ts":
/*!***************************!*\
  !*** ./src/types/main.ts ***!
  \***************************/
/*! exports provided: DrawStatuCode, TFModelType */function(e,t,i){"use strict";var r,n;i.r(t),i.d(t,"DrawStatuCode",(function(){return r})),i.d(t,"TFModelType",(function(){return n})),function(e){e[e.skip=0]="skip",e[e.success=1]="success"}(r||(r={})),function(e){e.full="full",e.lite="lite"}(n||(n={}))},"./src/utils/browser-helper.ts":
/*!*************************************!*\
  !*** ./src/utils/browser-helper.ts ***!
  \*************************************/
/*! exports provided: getTXBrowserCore, default */function(e,t,i){"use strict";i.r(t),i.d(t,"getTXBrowserCore",(function(){return o}));var r,n=(r=navigator.userAgent,{isTBS:/ TBS\//.test(r),isAndroid:r.indexOf("Android")>-1||r.indexOf("Adr")>-1,isIOS:r.indexOf("(iPhone;")>-1||r.indexOf("(iPad;")>-1,isMSIE:r.indexOf("Trident")>=0&&/(rv)(?::| )([\w.]+)/.test(r)||r.indexOf("MSIE")>=0});function o(){var e=navigator.userAgent.match(/ (TBS|XWEB)\/(\d+)/);if(e&&e.length>2)return{name:e[1],version:e[2]}}t.default=n},"./src/utils/log.ts":
/*!**************************!*\
  !*** ./src/utils/log.ts ***!
  \**************************/
/*! exports provided: Log, LOG_LEVEL */function(e,t,i){"use strict";i.r(t),i.d(t,"Log",(function(){return a})),i.d(t,"LOG_LEVEL",(function(){return r}));var r,n="kwai-vpp";function o(e,t){return t&&0!==t.length||(t=[e],e=""),e=n+(e?"::"+e:""),t.unshift("["+e+"] > "),t}!function(e){e.LEVEL_ERROR="e",e.LEVEL_WARN="w",e.LEVEL_INFO="i",e.LEVEL_DEBUG="d",e.LEVEL_VERBOSE="v"}(r||(r={}));var a=function(){function e(){}return e.level=function(t){switch(e.ENABLE_ERROR=e.ENABLE_WARN=e.ENABLE_INFO=e.ENABLE_DEBUG=e.ENABLE_VERBOSE=!1,t){case r.LEVEL_ERROR:e.ENABLE_ERROR=!0;break;case r.LEVEL_WARN:e.ENABLE_ERROR=e.ENABLE_WARN=!0;break;case r.LEVEL_INFO:e.ENABLE_ERROR=e.ENABLE_WARN=e.ENABLE_INFO=!0;break;case r.LEVEL_DEBUG:e.ENABLE_ERROR=e.ENABLE_WARN=e.ENABLE_INFO=e.ENABLE_DEBUG=!0;break;case r.LEVEL_VERBOSE:e.ENABLE_ERROR=e.ENABLE_WARN=e.ENABLE_INFO=e.ENABLE_DEBUG=e.ENABLE_VERBOSE=!0}},e.e=function(t){if(e.ENABLE_ERROR){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var a=o(t,r);(console.error||console.warn||console.log).apply(console,a)}},e.w=function(t){if(e.ENABLE_WARN){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var a=o(t,r);(console.warn||console.log).apply(console,a)}},e.i=function(t){if(e.ENABLE_INFO){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var a=o(t,r);(console.info||console.log).apply(console,a)}},e.d=function(t){if(e.ENABLE_DEBUG){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var a=o(t,r);(console.debug||console.log).apply(console,a)}},e.v=function(t){if(e.ENABLE_VERBOSE){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var a=o(t,r);console.log.apply(console,a)}},e}();a.ENABLE_ERROR=!0,a.ENABLE_WARN=!1,a.ENABLE_INFO=!1,a.ENABLE_DEBUG=!1,a.ENABLE_VERBOSE=!1},"./src/utils/pixel-ratio.ts":
/*!**********************************!*\
  !*** ./src/utils/pixel-ratio.ts ***!
  \**********************************/
/*! exports provided: PixelRatio */function(e,t,i){"use strict";i.r(t),i.d(t,"PixelRatio",(function(){return r}));var r=function(){function e(){}return e.setPixelRatioByDevice=function(t){e.pixelRatioByDevice=t,e.pixelRatio=t?window.devicePixelRatio:1},e}();r.pixelRatioByDevice=!0,r.pixelRatio=1},"./src/utils/tex-helper.ts":
/*!*********************************!*\
  !*** ./src/utils/tex-helper.ts ***!
  \*********************************/
/*! exports provided: isSourceReady, getSourceSize, updateView, isTexImageSource, getTexParams, getParamsTex4Trans, tex2ImageBitmap, tex4Trans */function(e,t,i){"use strict";i.r(t),i.d(t,"isSourceReady",(function(){return o})),i.d(t,"getSourceSize",(function(){return a})),i.d(t,"updateView",(function(){return s})),i.d(t,"isTexImageSource",(function(){return c})),i.d(t,"getTexParams",(function(){return u})),i.d(t,"getParamsTex4Trans",(function(){return l})),i.d(t,"tex2ImageBitmap",(function(){return d})),i.d(t,"tex4Trans",(function(){return h}));var r=i(/*! @babel/runtime/helpers/extends */"./node_modules/@babel/runtime/helpers/extends.js"),n=i.n(r);function o(e){return"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?e.readyState>1:!("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)||!!e.src&&e.complete}function a(e){return"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth||e.width,height:e.videoHeight||e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:e.width,height:e.height}}function s(e,t,i,r,n,o){if(void 0===o&&(o="default"),r&&n){var a=t/i,s=r/n,c=0,u=0,l=r,d=n;e[0]=0,e[1]=0,e[2]=1,e[3]=1,"cut"===o?a>s?(u=(n-(d=r/a))/2,e[1]=u/n,e[3]=d/n):(c=(r-(l=n*a))/2,e[0]=c/r,e[2]=l/r):a>s?(c=(r-(l=n/s))/2,e[0]=c/r,e[2]=l/r):(u=(n-(d=r/a))/2,e[1]=u/n,e[3]=d/n)}}function c(e){return"undefined"==typeof HTMLImageElement?"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||e instanceof ImageData:"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement}function u(e,t){var i;if(void 0===t&&(t=!0),Array.isArray(e))e.forEach((function(e,r){for(var n in e)if(t?p(e[n]):c(e[n])){i||(i=[]);var o=i[r];o||(o=i[r]={}),o[n]=e[n]}}));else for(var r in e)(t?p(e[r]):c(e[r]))&&(i||(i={}),i[r]=e[r]);return i}function l(e){if(!e)return new Promise((function(e){return e(void 0)}));var t,i;if(Array.isArray(e))i=[],e.forEach((function(e,r){var o=i[r]=n()({},e);for(var a in o)c(o[a])&&(t||(t=[]),t.push({src:o,key:a,tex:o[a]}))}));else for(var r in i=n()({},e))c(i[r])&&(t||(t=[]),t.push({src:i,key:r,tex:i[r]}));if(t&&t.length){var o=t;return Promise.all(t.map((function(e){return d(e.tex)}))).then((function(e){return o.forEach((function(t,i){t.src[t.key]=e[i]})),{params:i,tex:h(e)}}))}return new Promise((function(e){return e(void 0)}))}function d(e,t){var i;if(void 0===t&&(t=!0),e instanceof ImageData||e instanceof ImageBitmap)i=e;else if(e instanceof HTMLVideoElement||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return createImageBitmap(e,t?{imageOrientation:"flipY"}:void 0);return new Promise((function(e){e(i)}))}function h(e){return e.map((function(e){return e instanceof ImageBitmap?e:e.data.buffer}))}function p(e){return e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement}},"./src/utils/tex-proxy.ts":
/*!********************************!*\
  !*** ./src/utils/tex-proxy.ts ***!
  \********************************/
/*! exports provided: default */function(e,t,i){"use strict";i.r(t);var r=i(/*! @babel/runtime/helpers/createClass */"./node_modules/@babel/runtime/helpers/createClass.js"),n=i.n(r),o=i(/*! @babel/runtime/helpers/inheritsLoose */"./node_modules/@babel/runtime/helpers/inheritsLoose.js"),a=i.n(o),s=i(/*! events */"./node_modules/events/events.js"),c=i(/*! ../core/events */"./src/core/events.ts"),u=i(/*! ./tex-helper */"./src/utils/tex-helper.ts"),l=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this)._source=void 0,t._onVideoStateChange=function(){t.source&&"undefined"!=typeof HTMLVideoElement&&t._source instanceof HTMLVideoElement&&(Object(u.isSourceReady)(t.source)?(t._source.removeEventListener("timeupdate",t._onVideoStateChange),t.emit(c.default.RES_READY)):t._source.addEventListener("timeupdate",t._onVideoStateChange))},t._onVideoEmptied=function(){t.emit(c.default.RES_EMPTIED)},t._updateInputSize=function(){t._source&&t.emit(c.default.RES_RESIZE)},t._onImageStateChange=function(e){t._source&&("undefined"!=typeof HTMLVideoElement&&t._source instanceof HTMLVideoElement||"undefined"!=typeof HTMLImageElement&&t._source instanceof HTMLImageElement)&&Object(u.isSourceReady)(t._source)&&t.emit(c.default.RES_READY)},t}a()(t,e);var i=t.prototype;return i.init=function(e){this._source&&this.unbindSource(),this._source=e,Object(u.isSourceReady)(e)?this.emit(c.default.RES_READY):"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?this._bindVideo(e):"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement&&this._bindImage(e)},i.destroy=function(){this.removeAllListeners(),this._source&&("undefined"!=typeof HTMLVideoElement&&this._source instanceof HTMLVideoElement?this._unbindVideo(this._source):"undefined"!=typeof HTMLImageElement&&this._source instanceof HTMLImageElement&&this._unbindImage(this._source),this._source=void 0)},i.unbindSource=function(){this._source&&("undefined"!=typeof HTMLVideoElement&&this._source instanceof HTMLVideoElement?this._unbindVideo(this._source):"undefined"!=typeof HTMLImageElement&&this._source instanceof HTMLImageElement&&this._unbindImage(this._source),this._source=void 0)},i._bindVideo=function(e){e&&(e.addEventListener("canplay",this._onVideoStateChange),e.addEventListener("playing",this._onVideoStateChange),e.addEventListener("play",this._onVideoStateChange),e.addEventListener("ended",this._onVideoStateChange),e.addEventListener("error",this._onVideoStateChange),e.addEventListener("resize",this._updateInputSize),e.addEventListener("emptied",this._onVideoEmptied))},i._unbindVideo=function(e){e&&(e.removeEventListener("canplay",this._onVideoStateChange),e.removeEventListener("playing",this._onVideoStateChange),e.removeEventListener("play",this._onVideoStateChange),e.removeEventListener("ended",this._onVideoStateChange),e.removeEventListener("error",this._onVideoStateChange),e.removeEventListener("resize",this._updateInputSize),e.removeEventListener("emptied",this._onVideoEmptied),e.removeEventListener("timeupdate",this._onVideoStateChange))},i._bindImage=function(e){e&&e.addEventListener("load",this._onImageStateChange)},i._unbindImage=function(e){e&&e.removeEventListener("load",this._onImageStateChange)},n()(t,[{key:"source",get:function(){return this._source}}]),t}(s.EventEmitter);t.default=l},"./src/utils/tf-utils.ts":
/*!*******************************!*\
  !*** ./src/utils/tf-utils.ts ***!
  \*******************************/
/*! exports provided: getIsSupportThread, getIsSupportSIMD, uploadMask, getThreadNum */function(e,t,i){"use strict";i.r(t),i.d(t,"getIsSupportThread",(function(){return a})),i.d(t,"getIsSupportSIMD",(function(){return s})),i.d(t,"uploadMask",(function(){return c})),i.d(t,"getThreadNum",(function(){return u}));var r=[5,4,3,2,1],n=void 0,o=void 0;function a(){return void 0===n&&(n=function(){try{return"undefined"!=typeof WebAssembly&&"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}}()),n}function s(){return void 0===o&&(o="undefined"!=typeof WebAssembly&&WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))),o}function c(e,t){if(t.data){var i=t.data instanceof Float32Array;1===t.channel?e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,t.w,t.h,0,e.LUMINANCE,i?e.FLOAT:e.UNSIGNED_BYTE,t.data):2===t.channel?e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE_ALPHA,t.w,t.h,0,e.LUMINANCE_ALPHA,i?e.FLOAT:e.UNSIGNED_BYTE,t.data):4===t.channel&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.w,t.h,0,e.RGBA,i?e.FLOAT:e.UNSIGNED_BYTE,t.data)}}function u(e){if(!a()||1===e)return 1;for(var t=e>1?Math.min(e,navigator.hardwareConcurrency):navigator.hardwareConcurrency,i=0;i<r.length;i++)if(t>=r[i])return r[i];return r[r.length-1]}},"./src/utils/webgl-utils.ts":
/*!**********************************!*\
  !*** ./src/utils/webgl-utils.ts ***!
  \**********************************/
/*! exports provided: resizeCanvasToDisplaySize, createProgramFromSources, getWebGLRenderingContext, isSupported, createAndSetupTexture */function(e,t,i){"use strict";function r(e,t){t=t||1;var i=e.clientWidth*t|0,r=e.clientHeight*t|0;return!(!i||!r||e.width===i&&e.height===r||(e.width=i,e.height=r,0))}function n(e,t,i,r,n){var o=n||s,a=e.createProgram();return a?(t.forEach((function(t){e.attachShader(a,t)})),i&&i.forEach((function(t,i){e.bindAttribLocation(a,r?r[i]:i,t)})),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)?a:(o("Error in program linking:"+e.getProgramInfoLog(a)),e.deleteProgram(a),null)):null}function o(e,t,i,r){var n=r||s,o=e.createShader(i);return o?(e.shaderSource(o,t),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)?o:(n("*** Error compiling shader '"+o+"':"+e.getShaderInfoLog(o)),e.deleteShader(o),null)):null}function a(e,t,i,r,a,s){void 0===r&&(r=[]),void 0===a&&(a=[]);var c=[],u=o(e,t,e.VERTEX_SHADER,s),l=o(e,i,e.FRAGMENT_SHADER,s);return u&&c.push(u),l&&c.push(l),{program:n(e,c,r,a,s),vertexShader:u,fragmentShader:l}}function s(e){console&&(console.error?console.error(e):console.log&&console.log(e))}function c(e){var t={preferLowPowerToHighPerformance:!0,powerPreference:"default",preserveDrawingBuffer:!0};return e.getContext("webgl",t)||e.getContext("experimental-webgl",t)}i.r(t),i.d(t,"resizeCanvasToDisplaySize",(function(){return r})),i.d(t,"createProgramFromSources",(function(){return a})),i.d(t,"getWebGLRenderingContext",(function(){return c})),i.d(t,"isSupported",(function(){return d})),i.d(t,"createAndSetupTexture",(function(){return h}));var u=void 0,l=void 0;function d(e){if(void 0===e&&(e=!1),e){if(void 0!==l)return l}else if(void 0!==u)return u;var t=!1;try{var i=document.createElement("canvas"),r={preferLowPowerToHighPerformance:!0,failIfMajorPerformanceCaveat:e,preserveDrawingBuffer:!0};if("undefined"!=typeof WebGLRenderingContext){var n=i.getContext("webgl",r)||i.getContext("experimental-webgl",r);if(n){var o=n.getExtension("WEBGL_lose_context");o&&o.loseContext(),t=!0}else t=!1}else t=!1}catch(e){}return e?l=t:u=t,t}function h(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t}},"./src/utils/webworkify-webpack.js":
/*!*****************************************!*\
  !*** ./src/utils/webworkify-webpack.js ***!
  \*****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,i){function r(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var r=i(i.s=ENTRY_MODULE);return r.default||r}var n="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,r){var s={};s[r]=[];var c=t.toString(),u=c.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return s;for(var l,d=u[1],h=new RegExp("(\\\\n|\\W)"+a(d)+o,"g");l=h.exec(c);)"dll-reference"!==l[3]&&s[r].push(l[3]);for(h=new RegExp("\\("+a(d)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+o,"g");l=h.exec(c);)e[l[2]]||(s[r].push(l[1]),e[l[2]]=i(l[1]).m),s[l[2]]=s[l[2]]||[],s[l[2]].push(l[4]);for(var p,f=Object.keys(s),m=0;m<f.length;m++)for(var g=0;g<s[f[m]].length;g++)p=s[f[m]][g],isNaN(1*p)||(s[f[m]][g]=1*s[f[m]][g]);return s}function c(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var n,o={main:i.m};Array.isArray(e)&&(n=e.slice(1));var a=t.all?{main:Object.keys(o.main)}:function(e,t){for(var i={main:Array.isArray(t)?t:[t]},r={main:[]},n={main:{}};c(i);)for(var o=Object.keys(i),a=0;a<o.length;a++){var u=o[a],l=i[u].pop();if(n[u]=n[u]||{},!n[u][l]&&e[u][l]){n[u][l]=!0,r[u]=r[u]||[],r[u].push(l);for(var d=s(e,e[u][l],u),h=Object.keys(d),p=0;p<h.length;p++)i[h[p]]=i[h[p]]||[],i[h[p]]=i[h[p]].concat(d[h[p]])}}return r}(o,e);Array.isArray(e)&&(e=e[0]);var u="";Object.keys(a).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;a[e][t];)t++;a[e].push(t),o[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map((function(t){return JSON.stringify(t)+": "+o[e][t].toString()})).join(",")+"});\n"})),u=u+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map((function(e){return JSON.stringify(e)+": "+o.main[e].toString()})).join(",")+"}))(self);",t.inject&&Array.isArray(n)&&n.length&&(u=t.inject(u,n));var l=new window.Blob([u],{type:"text/javascript"});if(t.bare)return l;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),h=new window.Worker(d);return h.objectURL=d,h}},"./src/utils/worker-utils.ts":
/*!***********************************!*\
  !*** ./src/utils/worker-utils.ts ***!
  \***********************************/
/*! exports provided: isWorkerSupported, isInWorker */function(e,t,i){"use strict";function r(){return"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof createImageBitmap}function n(){return"undefined"==typeof HTMLElement}i.r(t),i.d(t,"isWorkerSupported",(function(){return r})),i.d(t,"isInWorker",(function(){return n}))}})},e.exports=t())},9669:(e,t,i)=>{e.exports=i(1609)},5448:(e,t,i)=>{"use strict";var r=i(4867),n=i(6026),o=i(4372),a=i(5327),s=i(4097),c=i(4109),u=i(7985),l=i(5061),d=i(5655),h=i(5263);e.exports=function(e){return new Promise((function(t,i){var p,f=e.data,m=e.headers,g=e.responseType;function v(){e.cancelToken&&e.cancelToken.unsubscribe(p),e.signal&&e.signal.removeEventListener("abort",p)}r.isFormData(f)&&delete m["Content-Type"];var A=new XMLHttpRequest;if(e.auth){var T=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(T+":"+_)}var x=s(e.baseURL,e.url);function y(){if(A){var r="getAllResponseHeaders"in A?c(A.getAllResponseHeaders()):null,o={data:g&&"text"!==g&&"json"!==g?A.response:A.responseText,status:A.status,statusText:A.statusText,headers:r,config:e,request:A};n((function(e){t(e),v()}),(function(e){i(e),v()}),o),A=null}}if(A.open(e.method.toUpperCase(),a(x,e.params,e.paramsSerializer),!0),A.timeout=e.timeout,"onloadend"in A?A.onloadend=y:A.onreadystatechange=function(){A&&4===A.readyState&&(0!==A.status||A.responseURL&&0===A.responseURL.indexOf("file:"))&&setTimeout(y)},A.onabort=function(){A&&(i(l("Request aborted",e,"ECONNABORTED",A)),A=null)},A.onerror=function(){i(l("Network Error",e,null,A)),A=null},A.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||d.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),i(l(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",A)),A=null},r.isStandardBrowserEnv()){var C=(e.withCredentials||u(x))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;C&&(m[e.xsrfHeaderName]=C)}"setRequestHeader"in A&&r.forEach(m,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete m[t]:A.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(A.withCredentials=!!e.withCredentials),g&&"json"!==g&&(A.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&A.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&A.upload&&A.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(p=function(e){A&&(i(!e||e&&e.type?new h("canceled"):e),A.abort(),A=null)},e.cancelToken&&e.cancelToken.subscribe(p),e.signal&&(e.signal.aborted?p():e.signal.addEventListener("abort",p))),f||(f=null),A.send(f)}))}},1609:(e,t,i)=>{"use strict";var r=i(4867),n=i(1849),o=i(321),a=i(7185);var s=function e(t){var i=new o(t),s=n(o.prototype.request,i);return r.extend(s,o.prototype,i),r.extend(s,i),s.create=function(i){return e(a(t,i))},s}(i(5655));s.Axios=o,s.Cancel=i(5263),s.CancelToken=i(4972),s.isCancel=i(6502),s.VERSION=i(7288).version,s.all=function(e){return Promise.all(e)},s.spread=i(8713),s.isAxiosError=i(6268),e.exports=s,e.exports.default=s},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,i)=>{"use strict";var r=i(5263);function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var i=this;this.promise.then((function(e){if(i._listeners){var t,r=i._listeners.length;for(t=0;t<r;t++)i._listeners[t](e);i._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){i.subscribe(e),t=e})).then(e);return r.cancel=function(){i.unsubscribe(t)},r},e((function(e){i.reason||(i.reason=new r(e),t(i.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},n.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},n.source=function(){var e;return{token:new n((function(t){e=t})),cancel:e}},e.exports=n},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,i)=>{"use strict";var r=i(4867),n=i(5327),o=i(782),a=i(3572),s=i(7185),c=i(4875),u=c.validators;function l(e){this.defaults=e,this.interceptors={request:new o,response:new o}}l.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var i=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,i.unshift(t.fulfilled,t.rejected))}));var n,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!r){var l=[a,void 0];for(Array.prototype.unshift.apply(l,i),l=l.concat(o),n=Promise.resolve(e);l.length;)n=n.then(l.shift(),l.shift());return n}for(var d=e;i.length;){var h=i.shift(),p=i.shift();try{d=h(d)}catch(e){p(e);break}}try{n=a(d)}catch(e){return Promise.reject(e)}for(;o.length;)n=n.then(o.shift(),o.shift());return n},l.prototype.getUri=function(e){return e=s(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,i){return this.request(s(i||{},{method:e,url:t,data:(i||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,i,r){return this.request(s(r||{},{method:e,url:t,data:i}))}})),e.exports=l},782:(e,t,i)=>{"use strict";var r=i(4867);function n(){this.handlers=[]}n.prototype.use=function(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=n},4097:(e,t,i)=>{"use strict";var r=i(1793),n=i(7303);e.exports=function(e,t){return e&&!r(t)?n(e,t):t}},5061:(e,t,i)=>{"use strict";var r=i(481);e.exports=function(e,t,i,n,o){var a=new Error(e);return r(a,t,i,n,o)}},3572:(e,t,i)=>{"use strict";var r=i(4867),n=i(8527),o=i(6502),a=i(5655),s=i(5263);function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=n.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return c(e),t.data=n.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(c(e),t&&t.response&&(t.response.data=n.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,i,r,n){return e.config=t,i&&(e.code=i),e.request=r,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},7185:(e,t,i)=>{"use strict";var r=i(4867);e.exports=function(e,t){t=t||{};var i={};function n(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function o(i){return r.isUndefined(t[i])?r.isUndefined(e[i])?void 0:n(void 0,e[i]):n(e[i],t[i])}function a(e){if(!r.isUndefined(t[e]))return n(void 0,t[e])}function s(i){return r.isUndefined(t[i])?r.isUndefined(e[i])?void 0:n(void 0,e[i]):n(void 0,t[i])}function c(i){return i in t?n(e[i],t[i]):i in e?n(void 0,e[i]):void 0}var u={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||o,n=t(e);r.isUndefined(n)&&t!==c||(i[e]=n)})),i}},6026:(e,t,i)=>{"use strict";var r=i(5061);e.exports=function(e,t,i){var n=i.config.validateStatus;i.status&&n&&!n(i.status)?t(r("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}},8527:(e,t,i)=>{"use strict";var r=i(4867),n=i(5655);e.exports=function(e,t,i){var o=this||n;return r.forEach(i,(function(i){e=i.call(o,e,t)})),e}},5655:(e,t,i)=>{"use strict";var r=i(4867),n=i(6016),o=i(481),a={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=i(5448)),c),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(s(t,"application/json"),function(e,t,i){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(i||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||u.transitional,i=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,a=!i&&"json"===this.responseType;if(a||n&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(a){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){u.headers[e]=r.merge(a)})),e.exports=u},7288:e=>{e.exports={version:"0.24.0"}},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var i=new Array(arguments.length),r=0;r<i.length;r++)i[r]=arguments[r];return e.apply(t,i)}}},5327:(e,t,i)=>{"use strict";var r=i(4867);function n(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,i){if(!t)return e;var o;if(i)o=i(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(n(t)+"="+n(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,i)=>{"use strict";var r=i(4867);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,i,n,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),r.isString(n)&&s.push("path="+n),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},7985:(e,t,i)=>{"use strict";var r=i(4867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function n(e){var r=e;return t&&(i.setAttribute("href",r),r=i.href),i.setAttribute("href",r),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=n(window.location.href),function(t){var i=r.isString(t)?n(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return!0}},6016:(e,t,i)=>{"use strict";var r=i(4867);e.exports=function(e,t){r.forEach(e,(function(i,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[r])}))}},4109:(e,t,i)=>{"use strict";var r=i(4867),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,i,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),i=r.trim(e.substr(o+1)),t){if(a[t]&&n.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([i]):a[t]?a[t]+", "+i:i}})),a):a}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4875:(e,t,i)=>{"use strict";var r=i(7288).version,n={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){n[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}}));var o={};n.transitional=function(e,t,i){function n(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(i?". "+i:"")}return function(i,r,a){if(!1===e)throw new Error(n(r," has been removed"+(t?" in "+t:"")));return t&&!o[r]&&(o[r]=!0,console.warn(n(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(i,r,a)}},e.exports={assertOptions:function(e,t,i){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),n=r.length;n-- >0;){var o=r[n],a=t[o];if(a){var s=e[o],c=void 0===s||a(s,o,e);if(!0!==c)throw new TypeError("option "+o+" must be "+c)}else if(!0!==i)throw Error("Unknown option "+o)}},validators:n}},4867:(e,t,i)=>{"use strict";var r=i(1849),n=Object.prototype.toString;function o(e){return"[object Array]"===n.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==n.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===n.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:u,isStream:function(e){return s(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function e(){var t={};function i(i,r){c(t[r])&&c(i)?t[r]=e(t[r],i):c(i)?t[r]=e({},i):o(i)?t[r]=i.slice():t[r]=i}for(var r=0,n=arguments.length;r<n;r++)l(arguments[r],i);return t},extend:function(e,t,i){return l(t,(function(t,n){e[n]=i&&"function"==typeof t?r(t,i):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},487:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t},bytesToString:function(e){for(var t=[],i=0;i<e.length;i++)t.push(String.fromCharCode(e[i]));return t.join("")}}};e.exports=t},1012:e=>{var t,i;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&i.rotl(e,8)|4278255360&i.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=i.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],i=0,r=0;i<e.length;i++,r+=8)t[r>>>5]|=e[i]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],i=0;i<32*e.length;i+=8)t.push(e[i>>>5]>>>24-i%32&255);return t},bytesToHex:function(e){for(var t=[],i=0;i<e.length;i++)t.push((e[i]>>>4).toString(16)),t.push((15&e[i]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],i=0;i<e.length;i+=2)t.push(parseInt(e.substr(i,2),16));return t},bytesToBase64:function(e){for(var i=[],r=0;r<e.length;r+=3)for(var n=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?i.push(t.charAt(n>>>6*(3-o)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],r=0,n=0;r<e.length;n=++r%4)0!=n&&i.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|t.indexOf(e.charAt(r))>>>6-2*n);return i}},e.exports=i},8738:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},2568:(e,t,i)=>{var r,n,o,a,s;r=i(1012),n=i(487).utf8,o=i(8738),a=i(487).bin,(s=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?a.stringToBytes(e):n.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var i=r.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,d=-1732584194,h=271733878,p=0;p<i.length;p++)i[p]=16711935&(i[p]<<8|i[p]>>>24)|4278255360&(i[p]<<24|i[p]>>>8);i[c>>>5]|=128<<c%32,i[14+(c+64>>>9<<4)]=c;var f=s._ff,m=s._gg,g=s._hh,v=s._ii;for(p=0;p<i.length;p+=16){var A=u,T=l,_=d,x=h;u=f(u,l,d,h,i[p+0],7,-680876936),h=f(h,u,l,d,i[p+1],12,-389564586),d=f(d,h,u,l,i[p+2],17,606105819),l=f(l,d,h,u,i[p+3],22,-1044525330),u=f(u,l,d,h,i[p+4],7,-176418897),h=f(h,u,l,d,i[p+5],12,1200080426),d=f(d,h,u,l,i[p+6],17,-1473231341),l=f(l,d,h,u,i[p+7],22,-45705983),u=f(u,l,d,h,i[p+8],7,1770035416),h=f(h,u,l,d,i[p+9],12,-1958414417),d=f(d,h,u,l,i[p+10],17,-42063),l=f(l,d,h,u,i[p+11],22,-1990404162),u=f(u,l,d,h,i[p+12],7,1804603682),h=f(h,u,l,d,i[p+13],12,-40341101),d=f(d,h,u,l,i[p+14],17,-1502002290),u=m(u,l=f(l,d,h,u,i[p+15],22,1236535329),d,h,i[p+1],5,-165796510),h=m(h,u,l,d,i[p+6],9,-1069501632),d=m(d,h,u,l,i[p+11],14,643717713),l=m(l,d,h,u,i[p+0],20,-373897302),u=m(u,l,d,h,i[p+5],5,-701558691),h=m(h,u,l,d,i[p+10],9,38016083),d=m(d,h,u,l,i[p+15],14,-660478335),l=m(l,d,h,u,i[p+4],20,-405537848),u=m(u,l,d,h,i[p+9],5,568446438),h=m(h,u,l,d,i[p+14],9,-1019803690),d=m(d,h,u,l,i[p+3],14,-187363961),l=m(l,d,h,u,i[p+8],20,1163531501),u=m(u,l,d,h,i[p+13],5,-1444681467),h=m(h,u,l,d,i[p+2],9,-51403784),d=m(d,h,u,l,i[p+7],14,1735328473),u=g(u,l=m(l,d,h,u,i[p+12],20,-1926607734),d,h,i[p+5],4,-378558),h=g(h,u,l,d,i[p+8],11,-2022574463),d=g(d,h,u,l,i[p+11],16,1839030562),l=g(l,d,h,u,i[p+14],23,-35309556),u=g(u,l,d,h,i[p+1],4,-1530992060),h=g(h,u,l,d,i[p+4],11,1272893353),d=g(d,h,u,l,i[p+7],16,-155497632),l=g(l,d,h,u,i[p+10],23,-1094730640),u=g(u,l,d,h,i[p+13],4,681279174),h=g(h,u,l,d,i[p+0],11,-358537222),d=g(d,h,u,l,i[p+3],16,-722521979),l=g(l,d,h,u,i[p+6],23,76029189),u=g(u,l,d,h,i[p+9],4,-640364487),h=g(h,u,l,d,i[p+12],11,-421815835),d=g(d,h,u,l,i[p+15],16,530742520),u=v(u,l=g(l,d,h,u,i[p+2],23,-995338651),d,h,i[p+0],6,-198630844),h=v(h,u,l,d,i[p+7],10,1126891415),d=v(d,h,u,l,i[p+14],15,-1416354905),l=v(l,d,h,u,i[p+5],21,-57434055),u=v(u,l,d,h,i[p+12],6,1700485571),h=v(h,u,l,d,i[p+3],10,-1894986606),d=v(d,h,u,l,i[p+10],15,-1051523),l=v(l,d,h,u,i[p+1],21,-2054922799),u=v(u,l,d,h,i[p+8],6,1873313359),h=v(h,u,l,d,i[p+15],10,-30611744),d=v(d,h,u,l,i[p+6],15,-1560198380),l=v(l,d,h,u,i[p+13],21,1309151649),u=v(u,l,d,h,i[p+4],6,-145523070),h=v(h,u,l,d,i[p+11],10,-1120210379),d=v(d,h,u,l,i[p+2],15,718787259),l=v(l,d,h,u,i[p+9],21,-343485551),u=u+A>>>0,l=l+T>>>0,d=d+_>>>0,h=h+x>>>0}return r.endian([u,l,d,h])})._ff=function(e,t,i,r,n,o,a){var s=e+(t&i|~t&r)+(n>>>0)+a;return(s<<o|s>>>32-o)+t},s._gg=function(e,t,i,r,n,o,a){var s=e+(t&r|i&~r)+(n>>>0)+a;return(s<<o|s>>>32-o)+t},s._hh=function(e,t,i,r,n,o,a){var s=e+(t^i^r)+(n>>>0)+a;return(s<<o|s>>>32-o)+t},s._ii=function(e,t,i,r,n,o,a){var s=e+(i^(t|~r))+(n>>>0)+a;return(s<<o|s>>>32-o)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var i=r.wordsToBytes(s(e,t));return t&&t.asBytes?i:t&&t.asString?a.bytesToString(i):r.bytesToHex(i)}},2238:function(e,t,i){var r;
/*!@license
 * UAParser.js v0.7.28
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright © 2012-2021 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */!function(n,o){"use strict";var a="function",s="undefined",c="object",u="string",l="model",d="name",h="type",p="vendor",f="version",m="architecture",g="console",v="mobile",A="tablet",T="smarttv",_="wearable",x="embedded",y={extend:function(e,t){var i={};for(var r in e)t[r]&&t[r].length%2==0?i[r]=t[r].concat(e[r]):i[r]=e[r];return i},has:function(e,t){return typeof e===u&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===u?e.replace(/[^\d\.]/g,"").split(".")[0]:o},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),typeof t===s?e:e.substring(0,255)}},C={rgx:function(e,t){for(var i,r,n,s,u,l,d=0;d<t.length&&!u;){var h=t[d],p=t[d+1];for(i=r=0;i<h.length&&!u;)if(u=h[i++].exec(e))for(n=0;n<p.length;n++)l=u[++r],typeof(s=p[n])===c&&s.length>0?2==s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,l):this[s[0]]=s[1]:3==s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=l?l.replace(s[1],s[2]):o:this[s[0]]=l?s[1].call(this,l,s[2]):o:4==s.length&&(this[s[0]]=l?s[3].call(this,l.replace(s[1],s[2])):o):this[s]=l||o;d+=2}},str:function(e,t){for(var i in t)if(typeof t[i]===c&&t[i].length>0){for(var r=0;r<t[i].length;r++)if(y.has(t[i][r],e))return"?"===i?o:i}else if(y.has(t[i],e))return"?"===i?o:i;return e}},b={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},E={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[d,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[d,f],[/opios[\/\s]+([\w\.]+)/i],[f,[d,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[f,[d,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[d,f],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[f,[d,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[f,[d,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[d,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[f,[d,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[d,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure Browser"],f],[/focus\/([\w\.]+)/i],[f,[d,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[f,[d,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[f,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[d,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[f,[d,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[f,[d,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[d,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1 Browser"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],f],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[d,f],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[d],[/;fbav\/([\w\.]+);/i],[f,[d,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[d,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[d,f],[/\bgsa\/([\w\.]+)\s.*safari\//i],[f,[d,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[f,[d,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[d,"Chrome WebView"],f],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[f,[d,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[d,f],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[f,[d,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[f,d],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[d,[f,C.str,b.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[d,f],[/(navigator|netscape)\/([\w\.-]+)/i],[[d,"Netscape"],f],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[f,[d,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[d,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,y.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[l,[p,"Samsung"],[h,A]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[l,[p,"Samsung"],[h,v]],[/\((ip(?:hone|od)[\s\w]*);/i],[l,[p,"Apple"],[h,v]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[p,"Apple"],[h,A]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[l,[p,"Huawei"],[h,A]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[l,[p,"Huawei"],[h,v]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[l,/_/g," "],[p,"Xiaomi"],[h,v]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[l,/_/g," "],[p,"Xiaomi"],[h,A]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[l,[p,"OPPO"],[h,v]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[l,[p,"Vivo"],[h,v]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[l,[p,"Realme"],[h,v]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[l,[p,"Motorola"],[h,v]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[l,[p,"Motorola"],[h,A]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[l,[p,"LG"],[h,A]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[l,[p,"LG"],[h,v]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[l,[p,"Lenovo"],[h,A]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[l,/_/g," "],[p,"Nokia"],[h,v]],[/droid.+;\s(pixel\sc)[\s)]/i],[l,[p,"Google"],[h,A]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[l,[p,"Google"],[h,v]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[p,"Sony"],[h,v]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[l,"Xperia Tablet"],[p,"Sony"],[h,A]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[l,[p,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[l,[p,"Amazon"],[h,A]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[l,"Fire Phone"],[p,"Amazon"],[h,v]],[/\((playbook);[\w\s\),;-]+(rim)/i],[l,p,[h,A]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[l,[p,"BlackBerry"],[h,v]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[l,[p,"ASUS"],[h,A]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[l,[p,"ASUS"],[h,v]],[/(nexus\s9)/i],[l,[p,"HTC"],[h,A]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[p,[l,/_/g," "],[h,v]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[l,[p,"Acer"],[h,A]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[l,[p,"Meizu"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[p,l,[h,v]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[p,l,[h,A]],[/\s(surface\sduo)\s/i],[l,[p,"Microsoft"],[h,A]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[l,[p,"Fairphone"],[h,v]],[/\s(u304aa)\sbuild/i],[l,[p,"AT&T"],[h,v]],[/sie-(\w*)/i],[l,[p,"Siemens"],[h,v]],[/[;\/]\s?(rct\w+)\sbuild/i],[l,[p,"RCA"],[h,A]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[l,[p,"Dell"],[h,A]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[l,[p,"Verizon"],[h,A]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[l,[p,"Barnes & Noble"],[h,A]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[l,[p,"NuVision"],[h,A]],[/;\s(k88)\sbuild/i],[l,[p,"ZTE"],[h,A]],[/;\s(nx\d{3}j)\sbuild/i],[l,[p,"ZTE"],[h,v]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[l,[p,"Swiss"],[h,v]],[/[;\/]\s?(zur\d{3})\sbuild/i],[l,[p,"Swiss"],[h,A]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[l,[p,"Zeki"],[h,A]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[p,"Dragon Touch"],l,[h,A]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[l,[p,"Insignia"],[h,A]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[l,[p,"NextBook"],[h,A]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[p,"Voice"],l,[h,v]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[p,"LvTel"],l,[h,v]],[/;\s(ph-1)\s/i],[l,[p,"Essential"],[h,v]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[l,[p,"Envizen"],[h,A]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[l,[p,"MachSpeed"],[h,A]],[/[;\/]\s?tu_(1491)\sbuild/i],[l,[p,"Rotor"],[h,A]],[/(shield[\w\s]+)\sbuild/i],[l,[p,"Nvidia"],[h,A]],[/(sprint)\s(\w+)/i],[p,l,[h,v]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[p,"Microsoft"],[h,v]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[p,"Zebra"],[h,A]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[p,"Zebra"],[h,v]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[p,l,[h,g]],[/droid.+;\s(shield)\sbuild/i],[l,[p,"Nvidia"],[h,g]],[/(playstation\s[345portablevi]+)/i],[l,[p,"Sony"],[h,g]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[l,[p,"Microsoft"],[h,g]],[/smart-tv.+(samsung)/i],[p,[h,T]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[p,"Samsung"],[h,T]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[p,"LG"],[h,T]],[/(apple)\s?tv/i],[p,[l,"Apple TV"],[h,T]],[/crkey/i],[[l,"Chromecast"],[p,"Google"],[h,T]],[/droid.+aft([\w])(\sbuild\/|\))/i],[l,[p,"Amazon"],[h,T]],[/\(dtv[\);].+(aquos)/i],[l,[p,"Sharp"],[h,T]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[p,y.trim],[l,y.trim],[h,T]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[h,T]],[/((pebble))app\/[\d\.]+\s/i],[p,l,[h,_]],[/droid.+;\s(glass)\s\d/i],[l,[p,"Google"],[h,_]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[l,[p,"Zebra"],[h,_]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[p,[h,x]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[l,[h,v]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[l,[h,A]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[h,y.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[l,[p,"Generic"]],[/(phone)/i],[[h,v]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[f,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[d,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,d]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[d,f],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[d,[f,C.str,b.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[d,"Windows"],[f,C.str,b.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[d,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[d,"Mac OS"],[f,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[d,f],[/\(bb(10);/i],[f,[d,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[f,[d,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[d,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[d,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[d,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[d,"Chromium OS"],f],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[d,f],[/(sunos)\s?([\w\.\d]*)/i],[[d,"Solaris"],f],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[d,f]]},S=function(e,t){if("object"==typeof e&&(t=e,e=o),!(this instanceof S))return new S(e,t).getResult();var i=e||(void 0!==n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),r=t?y.extend(E,t):E;return this.getBrowser=function(){var e={name:o,version:o};return C.rgx.call(e,i,r.browser),e.major=y.major(e.version),e},this.getCPU=function(){var e={architecture:o};return C.rgx.call(e,i,r.cpu),e},this.getDevice=function(){var e={vendor:o,model:o,type:o};return C.rgx.call(e,i,r.device),e},this.getEngine=function(){var e={name:o,version:o};return C.rgx.call(e,i,r.engine),e},this.getOS=function(){var e={name:o,version:o};return C.rgx.call(e,i,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===u&&e.length>255?y.trim(e,255):e,this},this.setUA(i),this};S.VERSION="0.7.28",S.BROWSER={NAME:d,MAJOR:"major",VERSION:f},S.CPU={ARCHITECTURE:m},S.DEVICE={MODEL:l,VENDOR:p,TYPE:h,CONSOLE:g,MOBILE:v,SMARTTV:T,TABLET:A,WEARABLE:_,EMBEDDED:x},S.ENGINE={NAME:d,VERSION:f},S.OS={NAME:d,VERSION:f},typeof t!==s?(e.exports&&(t=e.exports=S),t.UAParser=S):(r=function(){return S}.call(t,i,t,e))===o||(e.exports=r);var I=void 0!==n&&(n.jQuery||n.Zepto);if(I&&!I.ua){var w=new S;I.ua=w.getResult(),I.ua.get=function(){return w.getUA()},I.ua.set=function(e){w.setUA(e);var t=w.getResult();for(var i in t)I.ua[i]=t[i]}}}("object"==typeof window?window:this)},5547:e=>{e.exports=function(){function e(t,i,r){function n(a,s){if(!i[a]){if(!t[a]){if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[a]={exports:{}};t[a][0].call(u.exports,(function(e){return n(t[a][1][e]||e)}),u,u.exports,e,t,i,r)}return i[a].exports}for(var o=void 0,a=0;a<r.length;a++)n(r[a]);return n}return e}()({1:[function(e,t,i){"use strict";var r=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});t.exports=r},{"./adapter_factory.js":2}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.adapterFactory=l;var r=u(e("./utils")),n=u(e("./chrome/chrome_shim")),o=u(e("./edge/edge_shim")),a=u(e("./firefox/firefox_shim")),s=u(e("./safari/safari_shim")),c=u(e("./common_shim"));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function l(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},i=r.log,u=r.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(u.browser){case"chrome":if(!n||!n.shimPeerConnection||!t.shimChrome)return i("Chrome shim is not included in this adapter release."),l;if(null===u.version)return i("Chrome shim can not determine version, not shimming."),l;i("adapter.js shimming chrome."),l.browserShim=n,n.shimGetUserMedia(e),n.shimMediaStream(e),n.shimPeerConnection(e),n.shimOnTrack(e),n.shimAddTrackRemoveTrack(e),n.shimGetSendersWithDtmf(e),n.shimGetStats(e),n.shimSenderReceiverGetStats(e),n.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return i("Firefox shim is not included in this adapter release."),l;i("adapter.js shimming firefox."),l.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimGetParameters(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return i("MS edge shim is not included in this adapter release."),l;i("adapter.js shimming edge."),l.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return i("Safari shim is not included in this adapter release."),l;i("adapter.js shimming safari."),l.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),s.shimAudioContext(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:i("Unsupported browser!")}return l}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),i.shimMediaStream=u,i.shimOnTrack=l,i.shimGetSendersWithDtmf=d,i.shimGetStats=h,i.shimSenderReceiverGetStats=p,i.shimAddTrackRemoveTrackWithNative=f,i.shimAddTrackRemoveTrack=m,i.shimPeerConnection=g,i.fixNegotiationNeeded=v;var a=s(e("../utils.js"));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function l(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var n=void 0;n=e.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=n,o.transceiver={receiver:n},o.streams=[t.stream],i.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var n=void 0;n=e.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=n,o.transceiver={receiver:n},o.streams=[t.stream],i.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else a.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function d(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var n=i.apply(this,arguments);return n||(n=t(this,e),this._senders.push(n)),n};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var i=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){i._senders.push(t(i,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){var i=t._senders.find((function(t){return t.track===e}));i&&t._senders.splice(t._senders.indexOf(i),1)}))}}else if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function h(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,i=Array.prototype.slice.call(arguments),r=i[0],n=i[1],o=i[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){i[t]=e.stat(t)})),t[i.id]=i})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){n(s(a(e)))};return t.apply(this,[c,r])}return new Promise((function(i,r){t.apply(e,[function(e){i(s(a(e)))},r])})).then(n,o)}}}function p(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),a.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],i=void 0,r=void 0,n=void 0;return this.getSenders().forEach((function(e){e.track===t&&(i?n=!0:i=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(r?n=!0:r=e),e.track===t})),n||i&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}}function f(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(r)&&this._shimmedLocalStreams[i.id].push(r):this._shimmedLocalStreams[i.id]=[i,r],r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();i.apply(this,arguments);var n=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(n)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(i){var r=t._shimmedLocalStreams[i].indexOf(e);-1!==r&&t._shimmedLocalStreams[i].splice(r,1),1===t._shimmedLocalStreams[i].length&&delete t._shimmedLocalStreams[i]})),n.apply(this,arguments)}}function m(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return f(e);var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var i=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(i.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,i){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[i.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[i.id]=a,this._reverseStreams[a.id]=i,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],r=c({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[function(i){var r=u(e,i);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):i.apply(this,arguments).then((function(t){return u(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=l(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:u(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var i=void 0;Object.keys(this._streams).forEach((function(r){t._streams[r].getTracks().find((function(t){return e.track===t}))&&(i=t._streams[r])})),i&&(1===i.getTracks().length?this.removeStream(this._reverseStreams[i.id]):i.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function u(e,t){var i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],n=e._streams[r.id];i=i.replace(new RegExp(n.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:i})}function l(e,t){var i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],n=e._streams[r.id];i=i.replace(new RegExp(r.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}}function g(e){var t=a.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){var i=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],r=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return i||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}function v(e){var t=a.detectBrowser(e);a.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var i=e.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return e}))}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,i){"use strict";function r(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(i){return t(i).then((function(t){var r=i.video&&i.video.width,n=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(i.video.mandatory.maxWidth=r),n&&(i.video.mandatory.maxHeight=n),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=r},{}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.shimGetUserMedia=s;var n=o(e("../utils.js"));function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var a=n.log;function s(e){var t=e&&e.navigator;if(t.mediaDevices){var i=n.detectBrowser(e),o=function(e){if("object"!==(void 0===e?"undefined":r(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(i){if("require"!==i&&"advanced"!==i&&"mediaSource"!==i){var n="object"===r(e[i])?e[i]:{ideal:e[i]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var a={};"number"==typeof n.ideal?(a[o("min",i)]=n.ideal,t.optional.push(a),(a={})[o("max",i)]=n.ideal,t.optional.push(a)):(a[o("",i)]=n.ideal,t.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",i)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,i)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,n){if(i.version>=61)return n(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===r(e.audio)){var s=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"===r(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":r(c))?c:{ideal:c});var u=i.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||u)){delete e.video.facingMode;var l=void 0;if("environment"===c.exact||"environment"===c.ideal?l=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(l=["front"]),l)return t.mediaDevices.enumerateDevices().then((function(t){var i=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return l.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!i&&t.length&&l.includes("back")&&(i=t[t.length-1]),i&&(e.video.deviceId=c.exact?{exact:i.deviceId}:{ideal:i.deviceId}),e.video=o(e.video),a("chrome: "+JSON.stringify(e)),n(e)}))}e.video=o(e.video)}return a("chrome: "+JSON.stringify(e)),n(e)},c=function(e){return i.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},u=function(e,i,r){s(e,(function(e){t.webkitGetUserMedia(e,i,(function(e){r&&r(c(e))}))}))};if(t.getUserMedia=u.bind(t),t.mediaDevices.getUserMedia){var l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return l(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}}},{"../utils.js":15}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.shimRTCIceCandidate=c,i.shimMaxMessageSize=u,i.shimSendThrowTypeError=l,i.shimConnectionState=d,i.removeAllowExtmapMixed=h;var n=s(e("sdp")),o=a(e("./utils"));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}function c(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":r(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var i=new t(e),o=n.default.parseCandidate(e.candidate),a=Object.assign(i,o);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,o.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function u(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var i=function(e){if(!e||!e.sdp)return!1;var t=n.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=n.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var i=parseInt(t[1],10);return i!=i?-1:i},a=function(e){var i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i},s=function(e,i){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var o=n.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?r=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(r=2147483637),r},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),i(arguments[0])){var e=r(arguments[0]),n=a(e),o=s(arguments[0],e),u=void 0;u=0===n&&0===o?Number.POSITIVE_INFINITY:0===n||0===o?Math.max(n,o):Math.min(n,o);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return u}}),this._sctp=l}return c.apply(this,arguments)}}}function l(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return i(e,this),e},o.wrapPeerConnectionEvent(e,"datachannel",(function(e){return i(e.channel,e.target),e}))}function i(e,t){var i=e.send;e.send=function(){var r=arguments[0],n=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}}function d(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}}function h(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),i.apply(this,arguments)}}}}},{"./utils":15,sdp:17}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var r=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var n=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}}),i.shimPeerConnection=l,i.shimReplaceTrack=d;var o=u(e("../utils")),a=e("./filtericeservers"),s=c(e("rtcpeerconnection-shim"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function l(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var i=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){i.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var r=(0,s.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,a.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype}function d(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.filterIceServers=o;var r=n(e("../utils"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function o(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t;return n&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!i?(i=!0,!0):t&&!i})),delete e.url,e.urls=n?t[0]:t,!!t.length}}))}},{"../utils":15}],9:[function(e,t,i){"use strict";function r(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=r},{}],10:[function(e,t,i){"use strict";function r(e){var t=e&&e.navigator,i=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return Promise.reject(i(e))}))}}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetUserMedia=r},{}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),i.shimOnTrack=u,i.shimPeerConnection=l,i.shimSenderGetStats=d,i.shimReceiverGetStats=h,i.shimRemoveStream=p,i.shimRTCDataChannel=f,i.shimAddTransceiver=m,i.shimGetParameters=g,i.shimCreateOffer=v,i.shimCreateAnswer=A;var a=s(e("../utils"));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e){"object"===(void 0===e?"undefined":r(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function l(e){var t=a.detectBrowser(e);if("object"===(void 0===e?"undefined":r(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var i=e.RTCPeerConnection.prototype[t],r=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],r=e[1],a=e[2];return o.apply(this,[i||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,i){e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,a)}}}function d(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i});var i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function h(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,i=t.apply(this,[]);return i.forEach((function(t){return t._pc=e})),i}),a.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function p(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;a.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(i){i.track&&e.getTracks().includes(i.track)&&t.removeTrack(i)}))})}function f(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function m(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],i=e&&"sendEncodings"in e;i&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(i){var n=r.sender,o=n.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e.sendEncodings,n.sendEncodings=e.sendEncodings,this.setParametersPromises.push(n.setParameters(o).then((function(){delete n.sendEncodings})).catch((function(){delete n.sendEncodings}))))}return r})}}function g(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function v(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,i=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,i)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}}function A(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,i=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,i)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}}},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,i){"use strict";function r(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})}Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=r},{}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.shimGetUserMedia=a;var n=o(e("../utils"));function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){var t=n.detectBrowser(e),i=e&&e.navigator,o=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,r){n.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){var a=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},s=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":r(e))&&"object"===r(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var u=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":r(e))&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}}},{"../utils":15}],14:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.shimLocalStreamsAPI=a,i.shimRemoteStreamsAPI=s,i.shimCallbacksAPI=c,i.shimGetUserMedia=u,i.shimConstraints=l,i.shimRTCIceServerUrls=d,i.shimTrackEventTransceiver=h,i.shimCreateOfferLegacy=p,i.shimAudioContext=f;var n=o(e("../utils"));function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var i=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(i,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(i,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var i=this,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n&&n.forEach((function(e){i._localStreams?i._localStreams.includes(e)||i._localStreams.push(e):i._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var i=this._localStreams.indexOf(e);if(-1!==i){this._localStreams.splice(i,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}}function s(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var i=new Event("addstream");i.stream=e,t.dispatchEvent(i)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}}))}),t.apply(e,arguments)}}}function c(e){if("object"===(void 0===e?"undefined":r(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,i=t.createOffer,n=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r};var c=function(e,t,i){var r=o.apply(this,[e]);return i?(r.then(t,i),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,i){var r=a.apply(this,[e]);return i?(r.then(t,i),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,i){var r=s.apply(this,[e]);return i?(r.then(t,i),Promise.resolve()):r},t.addIceCandidate=c}}function u(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var i=t.mediaDevices,r=i.getUserMedia.bind(i);t.mediaDevices.getUserMedia=function(e){return r(l(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,i,r){t.mediaDevices.getUserMedia(e).then(i,r)}.bind(t))}function l(e){return e&&void 0!==e.video?Object.assign({},e,{video:n.compactObject(e.video)}):e}function d(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,i){if(e&&e.iceServers){for(var r=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(n.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,r.push(a)):r.push(e.iceServers[o])}e.iceServers=r}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function h(e){"object"===(void 0===e?"undefined":r(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function p(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var i=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveAudio||i||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}}function f(e){"object"!==(void 0===e?"undefined":r(e))||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}},{"../utils":15}],15:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.extractVersion=s,i.wrapPeerConnectionEvent=c,i.disableLog=u,i.disableWarnings=l,i.log=d,i.deprecated=h,i.detectBrowser=p,i.compactObject=m,i.walkStats=g,i.filterStats=v;var o=!0,a=!0;function s(e,t,i){var r=e.match(t);return r&&r.length>=i&&parseInt(r[i],10)}function c(e,t,i){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,n=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return n.apply(this,arguments);var o=function(e){var t=i(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),n.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(i))return o.apply(this,arguments);var r=this._eventMap[t].get(i);return this._eventMap[t].delete(i),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function u(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":r(e))+". Please use a boolean."):(o=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function l(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":r(e))+". Please use a boolean."):(a=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function d(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(o)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function h(e,t){a&&console.warn(e+" is deprecated, please use "+t+" instead.")}function p(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var i=e.navigator;if(i.mozGetUserMedia)t.browser="firefox",t.version=s(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=s(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(i.mediaDevices&&i.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=s(i.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=s(i.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function m(e){return f(e)?Object.keys(e).reduce((function(t,i){var r=f(e[i]),o=r?m(e[i]):e[i],a=r&&!Object.keys(o).length;return void 0===o||a?t:Object.assign(t,n({},i,o))}),{}):e}function g(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?g(e,e.get(t[r]),i):r.endsWith("Ids")&&t[r].forEach((function(t){g(e,e.get(t),i)}))})))}function v(e,t,i){var r=i?"outbound-rtp":"inbound-rtp",n=new Map;if(null===t)return n;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(i){i.type===r&&i.trackId===t.id&&g(e,i,n)}))})),n}},{}],16:[function(e,t,i){"use strict";var r=e("sdp");function n(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function o(e,t,i,n,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(n?n.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function a(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var n="string"==typeof r;return n&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||i?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(i=!0,!0)})),delete e.url,e.urls=n?r[0]:r,!!r.length}}))}function s(e,t){var i={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var i=0;i<t.length;i++)if(t[i].payloadType===e||t[i].preferredPayloadType===e)return t[i]},n=function(e,t,i,n){var o=r(e.parameters.apt,i),a=r(t.parameters.apt,n);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!n(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),i.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var n=t.headerExtensions[r];if(e.uri===n.uri){i.headerExtensions.push(n);break}}})),i}function c(e,t,i){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(i)}function u(e,t){var i=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return i||e.addRemoteCandidate(t),!i}function l(e,t){var i=new Error(t);return i.name=e,i.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],i}t.exports=function(e,t){function i(t,i){i.addTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,i){i.removeTrack(t),i.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function h(t,i,r,n){var o=new Event("track");o.track=i,o.receiver=r,o.transceiver={receiver:r},o.streams=n,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var p=function(i){var n=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){n[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",i=JSON.parse(JSON.stringify(i||{})),this.usingBundle="max-bundle"===i.bundlePolicy,"negotiate"===i.rtcpMuxPolicy)throw l("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(i.rtcpMuxPolicy||(i.rtcpMuxPolicy="require"),i.iceTransportPolicy){case"all":case"relay":break;default:i.iceTransportPolicy="all"}switch(i.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:i.bundlePolicy="balanced"}if(i.iceServers=a(i.iceServers||[],t),this._iceGatherers=[],i.iceCandidatePoolSize)for(var s=i.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:i.iceServers,gatherPolicy:i.iceTransportPolicy}));else i.iceCandidatePoolSize=0;this._config=i,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(p.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(p.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),p.prototype.onicecandidate=null,p.prototype.onaddstream=null,p.prototype.ontrack=null,p.prototype.onremovestream=null,p.prototype.onsignalingstatechange=null,p.prototype.oniceconnectionstatechange=null,p.prototype.onconnectionstatechange=null,p.prototype.onicegatheringstatechange=null,p.prototype.onnegotiationneeded=null,p.prototype.ondatachannel=null,p.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},p.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},p.prototype.getConfiguration=function(){return this._config},p.prototype.getLocalStreams=function(){return this.localStreams},p.prototype.getRemoteStreams=function(){return this.remoteStreams},p.prototype._createTransceiver=function(e,t){var i=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&i)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var n=this._createIceAndDtlsTransports();r.iceTransport=n.iceTransport,r.dtlsTransport=n.dtlsTransport}return t||this.transceivers.push(r),r},p.prototype.addTrack=function(t,i){if(this._isClosed)throw l("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw l("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(r=this.transceivers[n]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(i)&&this.localStreams.push(i),r.track=t,r.stream=i,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},p.prototype.addStream=function(e){var i=this;if(t>=15025)e.getTracks().forEach((function(t){i.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var i=r.getTracks()[t];e.addEventListener("enabled",(function(e){i.enabled=e.enabled}))})),r.getTracks().forEach((function(e){i.addTrack(e,r)}))}},p.prototype.removeTrack=function(t){if(this._isClosed)throw l("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var i=this.transceivers.find((function(e){return e.rtpSender===t}));if(!i)throw l("InvalidAccessError","Sender was not created by this connection.");var r=i.stream;i.rtpSender.stop(),i.rtpSender=null,i.track=null,i.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},p.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var i=t.getSenders().find((function(t){return t.track===e}));i&&t.removeTrack(i)}))},p.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},p.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},p.prototype._createIceGatherer=function(t,i){var r=this;if(i&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var n=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(n,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var i=!e.candidate||0===Object.keys(e.candidate).length;n.state=i?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},n.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),n},p.prototype._gather=function(t,i){var n=this,o=this.transceivers[i].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[i].bufferedCandidateEvents;this.transceivers[i].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[i].bufferCandidates),o.onlocalcandidate=function(e){if(!(n.usingBundle&&i>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:i};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(n._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",n._localDescription.sdp=r.getDescription(n._localDescription.sdp)+l.join("");var d=n.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),c||n._dispatchEvent("icecandidate",a),d&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},p.prototype._createIceAndDtlsTransports=function(){var t=this,i=new e.RTCIceTransport(null);i.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(i);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:i,dtlsTransport:r}},p.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var i=this.transceivers[e].iceTransport;i&&(delete i.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},p.prototype._transceive=function(e,i,n){var o=s(e.localCapabilities,e.remoteCapabilities);i&&e.rtpSender&&(o.encodings=e.sendEncodingParameters,o.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(o.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(o)),n&&e.rtpReceiver&&o.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?o.encodings=e.recvEncodingParameters:o.encodings=[{}],o.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(o.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(o.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(o))},p.prototype.setLocalDescription=function(e){var t,i,n=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(l("TypeError",'Unsupported type "'+e.type+'"'));if(!c("setLocalDescription",e.type,n.signalingState)||n._isClosed)return Promise.reject(l("InvalidStateError","Can not set local "+e.type+" in state "+n.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),i=t.shift(),t.forEach((function(e,t){var i=r.parseRtpParameters(e);n.transceivers[t].localCapabilities=i})),n.transceivers.forEach((function(e,t){n._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(n._remoteDescription.sdp),i=t.shift();var o=r.matchPrefix(i,"a=ice-lite").length>0;t.forEach((function(e,t){var a=n.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,d=a.localCapabilities,h=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=r.getIceParameters(e,i),f=r.getDtlsParameters(e,i);o&&(f.role="server"),n.usingBundle&&0!==t||(n._gather(a.mid,t),"new"===u.state&&u.start(c,p,o?"controlling":"controlled"),"new"===l.state&&l.start(f));var m=s(d,h);n._transceive(a,m.codecs.length>0,!1)}}))}return n._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?n._updateSignalingState("have-local-offer"):n._updateSignalingState("stable"),Promise.resolve()},p.prototype.setRemoteDescription=function(n){var o=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(l("TypeError",'Unsupported type "'+n.type+'"'));if(!c("setRemoteDescription",n.type,o.signalingState)||o._isClosed)return Promise.reject(l("InvalidStateError","Can not set remote "+n.type+" in state "+o.signalingState));var a={};o.remoteStreams.forEach((function(e){a[e.id]=e}));var p=[],f=r.splitSections(n.sdp),m=f.shift(),g=r.matchPrefix(m,"a=ice-lite").length>0,v=r.matchPrefix(m,"a=group:BUNDLE ").length>0;o.usingBundle=v;var A=r.matchPrefix(m,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!A&&A.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(c,l){var h=r.splitLines(c),f=r.getKind(c),A=r.isRejected(c)&&0===r.matchPrefix(c,"a=bundle-only").length,T=h[0].substr(2).split(" ")[2],_=r.getDirection(c,m),x=r.parseMsid(c),y=r.getMid(c)||r.generateIdentifier();if(A||"application"===f&&("DTLS/SCTP"===T||"UDP/DTLS/SCTP"===T))o.transceivers[l]={mid:y,kind:f,protocol:T,rejected:!0};else{var C,b,E,S,I,w,R,k,P;!A&&o.transceivers[l]&&o.transceivers[l].rejected&&(o.transceivers[l]=o._createTransceiver(f,!0));var D,O,L=r.parseRtpParameters(c);A||(D=r.getIceParameters(c,m),(O=r.getDtlsParameters(c,m)).role="client"),R=r.parseRtpEncodingParameters(c);var M=r.parseRtcpParameters(c),N=r.matchPrefix(c,"a=end-of-candidates",m).length>0,U=r.matchPrefix(c,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!A&&v&&l>0&&o.transceivers[l]&&(o._disposeIceAndDtlsTransports(l),o.transceivers[l].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[l].iceTransport=o.transceivers[0].iceTransport,o.transceivers[l].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[l].rtpSender&&o.transceivers[l].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[l].rtpReceiver&&o.transceivers[l].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==n.type||A)"answer"!==n.type||A||(b=(C=o.transceivers[l]).iceGatherer,E=C.iceTransport,S=C.dtlsTransport,I=C.rtpReceiver,w=C.sendEncodingParameters,k=C.localCapabilities,o.transceivers[l].recvEncodingParameters=R,o.transceivers[l].remoteCapabilities=L,o.transceivers[l].rtcpParameters=M,U.length&&"new"===E.state&&(!g&&!N||v&&0!==l?U.forEach((function(e){u(C.iceTransport,e)})):E.setRemoteCandidates(U)),v&&0!==l||("new"===E.state&&E.start(b,D,"controlling"),"new"===S.state&&S.start(O)),!s(C.localCapabilities,C.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx,o._transceive(C,"sendrecv"===_||"recvonly"===_,"sendrecv"===_||"sendonly"===_),!I||"sendrecv"!==_&&"sendonly"!==_?delete C.rtpReceiver:(P=I.track,x?(a[x.stream]||(a[x.stream]=new e.MediaStream),i(P,a[x.stream]),p.push([P,I,a[x.stream]])):(a.default||(a.default=new e.MediaStream),i(P,a.default),p.push([P,I,a.default]))));else{(C=o.transceivers[l]||o._createTransceiver(f)).mid=y,C.iceGatherer||(C.iceGatherer=o._createIceGatherer(l,v)),U.length&&"new"===C.iceTransport.state&&(!N||v&&0!==l?U.forEach((function(e){u(C.iceTransport,e)})):C.iceTransport.setRemoteCandidates(U)),k=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(k.codecs=k.codecs.filter((function(e){return"rtx"!==e.name}))),w=C.sendEncodingParameters||[{ssrc:1001*(2*l+2)}];var B,F=!1;"sendrecv"===_||"sendonly"===_?(F=!C.rtpReceiver,I=C.rtpReceiver||new e.RTCRtpReceiver(C.dtlsTransport,f),F&&(P=I.track,x&&"-"===x.stream||(x?(a[x.stream]||(a[x.stream]=new e.MediaStream,Object.defineProperty(a[x.stream],"id",{get:function(){return x.stream}})),Object.defineProperty(P,"id",{get:function(){return x.track}}),B=a[x.stream]):(a.default||(a.default=new e.MediaStream),B=a.default)),B&&(i(P,B),C.associatedRemoteMediaStreams.push(B)),p.push([P,I,B]))):C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach((function(e){var t=e.getTracks().find((function(e){return e.id===C.rtpReceiver.track.id}));t&&d(t,e)})),C.associatedRemoteMediaStreams=[]),C.localCapabilities=k,C.remoteCapabilities=L,C.rtpReceiver=I,C.rtcpParameters=M,C.sendEncodingParameters=w,C.recvEncodingParameters=R,o._transceive(o.transceivers[l],!1,F)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===n.type?"active":"passive"),o._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(a).forEach((function(t){var i=a[t];if(i.getTracks().length){if(-1===o.remoteStreams.indexOf(i)){o.remoteStreams.push(i);var r=new Event("addstream");r.stream=i,e.setTimeout((function(){o._dispatchEvent("addstream",r)}))}p.forEach((function(e){var t=e[0],r=e[1];i.id===e[2].id&&h(o,t,r,[i])}))}})),p.forEach((function(e){e[2]||h(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},p.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},p.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},p.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},p.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var i=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",i)}},p.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var i=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",i)}},p.prototype.createOffer=function(){var i=this;if(i._isClosed)return Promise.reject(l("InvalidStateError","Can not call createOffer after close"));var n=i.transceivers.filter((function(e){return"audio"===e.kind})).length,a=i.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(n=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(i.transceivers.forEach((function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));n>0||a>0;)n>0&&(i._createTransceiver("audio"),n--),a>0&&(i._createTransceiver("video"),a--);var c=r.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.transceivers.forEach((function(n,o){var a=n.track,s=n.kind,c=n.mid||r.generateIdentifier();n.mid=c,n.iceGatherer||(n.iceGatherer=i._createIceGatherer(o,i.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=n.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,s)),n.localCapabilities=u,n.sendEncodingParameters=l})),"max-compat"!==i._config.bundlePolicy&&(c+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",i.transceivers.forEach((function(e,t){c+=o(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),c+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,c+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var u=new e.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(u)},p.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(l("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(l("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var n=r.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(n+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n";var a=r.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach((function(e,r){if(!(r+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?n+="m=application 0 DTLS/SCTP 5000\r\n":n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=s(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=o(e,u,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(c)},p.prototype.addIceCandidate=function(e){var t,i=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(n,o){if(!i._remoteDescription)return o(l("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<i.transceivers.length;s++)if(i.transceivers[s].mid===e.sdpMid){a=s;break}var c=i.transceivers[a];if(!c)return o(l("OperationError","Can not add ICE candidate"));if(c.rejected)return n();var d=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return n();if(d.component&&1!==d.component)return n();if((0===a||a>0&&c.iceTransport!==i.transceivers[0].iceTransport)&&!u(c.iceTransport,d))return o(l("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=r.getMediaSections(i._remoteDescription.sdp))[a]+="a="+(d.type?h:"end-of-candidates")+"\r\n",i._remoteDescription.sdp=r.getDescription(i._remoteDescription.sdp)+t.join("")}else for(var p=0;p<i.transceivers.length&&(i.transceivers[p].rejected||(i.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(i._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",i._remoteDescription.sdp=r.getDescription(i._remoteDescription.sdp)+t.join(""),!i.usingBundle));p++);n()}))},p.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var i=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?i=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(i=e.rtpReceiver)})),!i)throw l("InvalidAccessError","Invalid selector.");return i.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var i=e[t];if(i&&i.prototype&&i.prototype.getStats){var r=i.prototype.getStats;i.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(i){e[i].type=n(e[i]),t.set(i,e[i])})),t}))}}}));var f=["createOffer","createAnswer"];return f.forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(f=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),p}},{sdp:17}],17:[function(e,t,i){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,i={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":i.relatedAddress=t[r+1];break;case"rport":i.relatedPort=parseInt(t[r+1],10);break;case"tcptype":i.tcpType=t[r+1];break;case"ufrag":i.ufrag=t[r+1],i.usernameFragment=t[r+1];break;default:i[t[r]]=t[r+1]}return i},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,i={},r=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<r.length;n++)i[(t=r[n].trim().split("="))[0].trim()]=t[1];return i},r.writeFmtp=function(e){var t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+i+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),i={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(i.attribute=e.substr(t+1,r-t-1),i.value=e.substr(r+1)):i.attribute=e.substr(t+1),i},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},r.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var i=r.matchPrefix(e+t,"a=ice-ufrag:")[0],n=r.matchPrefix(e+t,"a=ice-pwd:")[0];return i&&n?{usernameFragment:i.substr(12),password:n.substr(10)}:null},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=r.splitLines(e)[0].split(" "),n=3;n<i.length;n++){var o=i[n],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var i="";i+="m="+e+" ",i+=t.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){i+=r.writeRtpMap(e),i+=r.writeFmtp(e),i+=r.writeRtcpFb(e)}));var n=0;return t.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(i+="a=maxptime:"+n+"\r\n"),i+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){i+=r.writeExtmap(e)})),i},r.parseRtpEncodingParameters=function(e){var t,i=[],n=r.parseRtpParameters(e),o=-1!==n.fecMechanisms.indexOf("RED"),a=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),i.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},i.push(r))}})),0===i.length&&c&&i.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=l}))),i},r.parseRtcpParameters=function(e){var t={},i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(t.cname=i.value,t.ssrc=i.ssrc);var n=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,i=r.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(t=i[0].substr(7).split(" "))[0],track:t[1]};var n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,i=r.parseMLine(e),n=r.matchPrefix(e,"a=max-message-size:");n.length>0&&(t=parseInt(n[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:i.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,i){var n=void 0!==t?t:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,i,n){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var i=r.splitLines(e),n=0;n<i.length;n++)switch(i[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[n].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),i=0;i<t.length;i++)if(t[i].length<2||"="!==t[i].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}]},{},[1])(1)},8902:(e,t,i)=>{const{isAndroid:r,isChrome:n}=i(5237);function o(e,t,i){return{sampleRate:e,stereo:t,bitrate:i}}const a={speech_low_quality:o(16e3,!1),speech_standard:o(32e3,!1,18),music_standard:o(48e3,!1),standard_stereo:o(48e3,!0,56),high_quality:o(48e3,!1,128),high_quality_stereo:o(48e3,!0,192)};e.exports={audioTrackInitConfig:function(e){let t={};if("boolean"==typeof e.AGC&&(t.autoGainControl=e.AGC,n()&&(t.googAutoGainControl=e.AGC,t.googAutoGainControl2=e.AGC)),"boolean"==typeof e.AEC&&(t.echoCancellation=e.AEC),"boolean"==typeof e.ANS&&(t.noiseSuppression=e.ANS,n()&&(t.googNoiseSuppression=e.ANS)),e.encoderConfig){let i=function(e){return"string"==typeof e?Object.assign({},a[e]):e}(e.encoderConfig);t.channelCount=i.stereo?2:1,t.sampleRate=i.sampleRate,t.sampleSize=i.sampleSize}return e.deviceId&&(t.deviceId={exact:e.deviceId}),n()&&2===t.channelCount&&(t.googAutoGainControl=!1,t.googAutoGainControl2=!1,t.echoCancellation=!1,t.googNoiseSuppression=!1),r()&&(t.sampleRate=void 0),t}}},8567:(e,t,i)=>{const r=i(485),{isIOS:n,isSafari:o,isSafariAndMT:a,BrowserDetect:s}=i(5237),{AudioEvent:c}=i(9648),u=i(7247),{waitTime:l}=i(4891),d=window.AudioContext||window.webkitAudioContext;class h extends r{constructor(e){if(super(),this.context=new d,this.outputNode=this.context.createGain(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.smoothingTimeConstant=.4,this.analyserNode.fftSize=2048,e){let t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t)}this.connect()}updateTrack(e){this.disconnect();const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),this.connect()}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{let t=function(e){let t=e.outputBuffer;for(let e=0;e<t.numberOfChannels;e+=1){let i=t.getChannelData(e);for(let e=0;e<i.length;e+=1)i[e]=0}return e.inputBuffer}(e);this.emit(c.ON_AUDIO_BUFFER,t)})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!s.webAudioMediaStreamDest)throw new Error("[AryaAudio] your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){if(this.context&&(n()||o()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume()),!this.analyserNode)return 0;let e=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(e);let t=0;for(let i=0;i<e.length;i++)t+=64>i?Math.abs(10*e[i]):Math.abs(6*e[i]/15);return t/e.length/255}async checkHasAudioInput(e=0){if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;if(n()||a()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return!1;let t=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(t);let i=!1;for(let e=0;e<t.length;e++)0!==t[e]&&(i=!0);return i?(this.isNoAudioInput=!1,!0):(await l(200),await this.checkHasAudioInput(e?e+1:1)&&i)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}setMute(e){e?(this.disconnect(),this.audioOutputLevel=0):this.connect()}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){this.sourceNode&&this.sourceNode.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){this.sourceNode&&this.sourceNode.connect(this.outputNode),this.outputNode.connect(this.analyserNode)}}e.exports={AudioSource:h,AudioBufferSource:class extends h{constructor(e,t={}){super(),this.currentLoopCount=this.pausePlayTime=this.startPlayOffset=this.startPlayTime=0,this._currentState="stopped",this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}set currentState(e){this._currentState!==e&&(this._currentState=e,this.emit(c.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):u.warning("[AudioBufferSource] can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){let e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}},createOscillator:function(e,t){let i=1/t,r=new d,n=r.createGain();n.gain.value=0,n.connect(r.destination);let o=!1,a=()=>{if(o)return void(n=null);const t=r.createOscillator();t.onended=a,t.connect(n),t.start(0),t.stop(r.currentTime+i),e(r.currentTime)};return a(),()=>{o=!0}}}},4982:(e,t,i)=>{const r=i(1277),n=i(7247),{waitTime:o,generateId:a}=i(4891),{browserInfo:s}=i(5237);class c{constructor(){this.recordedFrameCount=this.targetFrameRate=0,this.recordingTime=2,this.fps=15,this.enabled=!1}async startRecordBeautyEffectOutput(e,t=4){if(this.recordID)throw new Error("[arya_beauty] another beauty effect recording is in progress");let i=a(6,"");return this.recordID=i,this.targetFrameRate=e,this.recordedFrameCount=0,this.recordingTime=t,await o(1e3*this.recordingTime),this.recordID!==i?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(n.warning("[arya_beauty] detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(n.debug("[arya_beauty] beauty effect current framerate",this.recordedFrameCount/2),!0))}stopRecordBeautyEffectOutput(){this.recordedFrameCount=0,this.targetFrameRate=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}e.exports=class{constructor(){this.initVideoPostProcessor(),this.overloadDetector=new c,this.lastRenderTime=0,this.config={beauty:.5,brightness:.5,ruddy:.5}}static isSupported(){return r.Processor.isSupported()}initVideoPostProcessor(){this.vpp=new r.Processor({keepAlive:!0,pixelRatioByDevice:!1}),this.vpp.setFilters([r.beauty2]),this.vpp.select("beauty2"),this.vpp.setParams(this.config)}setBeautyParam(e={}){if("{}"===JSON.stringify(e))return;let{beauty:t,brightness:i,ruddy:r}=e;t=t&&Math.min(Math.max(0,t),1),i=i&&Math.min(Math.max(0,i),1),r=r&&Math.min(Math.max(0,r),1);let n={beauty:t,brightness:i,ruddy:r};n=JSON.parse(JSON.stringify(n)),this.config=n,this.vpp.setParams(n)}async generateBeautyTrack(e){this.remove(),this.video=document.createElement("video"),this.canvas=document.createElement("canvas"),this.vpp.attachSource(this.video),this.vpp.attachOutputCanvas(this.canvas),this.vpp.select("beauty2");const t=e.getSettings();this.fps=t.frameRate||15,this.vpp.setMediaInfo({fps:this.fps}),this.setRect(t),this.video.srcObject=new MediaStream([e]);var i=new Promise((e=>{const t=()=>{this.video&&this.video.removeEventListener("playing",t),e()};this.video&&this.video.addEventListener("playing",t)}));return this.video.play(),await i,this.enabled=!0,this.startRecord(),this.beautyTrack=this.generateVideoTrackFromCanvasCapture(this.fps),this.beautyTrack}setRect({width:e=640,height:t=480}){this.video.height=t,this.video.width=e,this.canvas.height=t,this.canvas.width=e,this.canvas.style=`visibility: hidden; width: ${e}px; height: ${t}px;`,"Safari"==s.name&&Number(s.version)<15&&document.body.appendChild(this.canvas)}generateVideoTrackFromCanvasCapture(e){return this.canvas.captureStream(e).getVideoTracks()[0]}startRecord(){this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then((e=>{e||this.onOverload&&this.onOverload()}));let e=()=>{this.enabled&&requestAnimationFrame(e);const t=Date.now(),i=1e3/this.fps,r=this.lastRenderTime?t-this.lastRenderTime:i;r>=i&&(this.lastRenderTime=t-(r-i),this.video&&this.video.paused&&this.video.play(),this.overloadDetector.addFrame())};requestAnimationFrame(e)}stopRecord(){this.enabled=!1,this.overloadDetector.stopRecordBeautyEffectOutput()}remove(){this.canvas&&(this.canvas.width=0,this.canvas.height=0,this.canvas.remove(),delete this.canvas),this.video&&(this.video.pause(),this.video.removeAttribute("srcObject"),this.video.removeAttribute("src"),this.video.load(),this.video.width=0,this.video.height=0,this.video.remove(),delete this.video),this.beautyTrack&&this.beautyTrack.stop(),this.stopRecord(),this.vpp.detachSource(),this.vpp.detachOutputCanvas()}destroy(){this.remove(),this.vpp.destroy(),this.vpp=null}}},7247:(e,t,i)=>{const{getLocaltime:r,getAppInstanceId:n}=i(4891),o=i(3487),{version:a}=i(4147),s=i(2568),c={staging:"https://log-rtc.test.gifshow.com",prod:"https://log-rtc.kuaishou.com"};function u(e){const t=e.filter((e=>!!e)).join("&&");return s(t).toUpperCase()}const l=0,d=1,h=2,p=3,f=Date.now();e.exports=new class{constructor(){this.env="prod",this.httpRequest=new o,this.level=d,this.enableUpload=!0,this.enableDebug=!0,this._init(),console.log(`The KRTC Web SDK version is ${a}`)}setData(e){Object.assign(this,e)}_init(){this.uploadState="collecting",this.uploadLogWaitingList=[],this.uploadLogUploadingList=[],this.currentLogID=0,this.uploadErrorCount=0,this.appId=null,this.uid=null,this.channelId=null,this.logInterval&&clearInterval(this.logInterval),this.logInterval=null}async close(){await this.uploadAllLog(),this._init()}debug(...e){if(this.level<=l){const t=`[V1][${r()}][D][Tid:0][Event][K]`;this.log([`%c${t}`,l,...e]),this.uploadLog("debug",`${t}${e}`)}}info(...e){if(this.level<=d){const t=`[V1][${r()}][I][Tid:0][Event][K]`;this.log([`%c${t}`,d,...e]),this.uploadLog("info",`${t}${e}`)}}warning(...e){if(this.level<=h){const t=`[V1][${r()}][W][Tid:0][Event][K]`;this.log([`%c${t}`,h,...e]),this.uploadLog("warning",`${t}${e}`)}}error(...e){if(this.level<=p){const t=`[V1][${r()}][E][Tid:0][Event][K]`;this.log([`%c${t}`,p,...e]),this.uploadLog("error",`${t}${e}`)}}log(e){if(!this.enableDebug)return;const t=Date.now()-f;if(t<100)return setTimeout((()=>this.log(e)),t);switch(e[1]){case l:e[1]="color: #64B5F6;",console.log.apply(console,e);break;case d:e[1]="color: #1E88E5; font-weight: bold;",console.log.apply(console,e);break;case h:e[1]="color: #FB8C00; font-weight: bold;",console.warn.apply(console,e);break;case p:e[1]="color: #B00020; font-weight: bold;",console.error.apply(console,e)}}appendLogToWaitingList(e,t){this.uploadLogWaitingList.push(t)}startUpload(){"prod"===this.env&&"uploading"!==this.uploadState&&(this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval())}async uploadLogs(){if(!1===navigator.onLine||"prod"!==this.env)return;if(!this.appId||!this.uid)return this.uploadLogWaitingList.length=0,void(this.uploadLogUploadingList.length=0);const e=Date.now(),t=u([this.uid,this.channelId]),i=u(["i!believe@kwai#laotie",this.appId,this.uid,t,e,"wefd8g7345kj09dh345r8yn2k3598eu945rh3489"]),r=`${c[this.env]}/log/webReport?app=${this.appId}&user=${this.uid}&device=${t}&timestamp=${e}&sign=${i}&instanceId=${n()}`,a=await this.httpRequest.post(r,{msgs:this.uploadLogUploadingList,type:"web"},o.ContentType.Json);if(200!==a.status)throw Error("unexpected upload log response: "+a.message);this.uploadLogUploadingList=[]}uploadLogInterval(){this.logInterval=setInterval((()=>{(this.uploadLogUploadingList.length||this.uploadLogWaitingList.length)&&(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,10)),this.uploadLogs().then((()=>{this.uploadErrorCount=0})).catch((e=>{this.uploadErrorCount+=1,this.uploadErrorCount>2?window.setTimeout((()=>this.uploadLogs()),1e3*Math.pow(2,this.uploadErrorCount)):window.setTimeout((()=>this.uploadLogs()),1e3)})))}),3e3)}async uploadAllLog(){if(this.uploadLogWaitingList.length){this.uploadLogUploadingList=this.uploadLogWaitingList;try{await this.uploadLogs()}catch(e){console.log(e)}}}enbaleLogDebug(e){this.enableDebug=e}uploadLog(e,t){this.enableUpload&&this.appendLogToWaitingList(e,t)}setLogLevel(e){this.level=Math.min(Math.max(0,e),4)}enableLogUpload(){this.enableUpload=!0}disableLogUpload(){this.enableUpload=!1,this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}}},8069:e=>{e.exports=class{constructor(e){this.audioTrack=void 0,this.videoTrack=void 0,this.contentAudioTrack=void 0,this.contentVideoTrack=void 0,this.hasAudio=null,this.hasVideo=null,this.hasContent=!1,this.netQuality={downlinkNetworkQuality:1,uplinkNetworkQuality:1},this.uid=e}}},1719:(e,t,i)=>{i(5547);const{AryaRTCClient:r}=i(627),n=i(7247),o=i(201),{LocalVideoTrack:a,LocalAudioTrack:s,CameraVideoTrack:c,MicrophoneAudioTrack:u,RemoteAudioTrack:l,RemoteVideoTrack:d,BufferSourceAudioTrack:h}=i(3405),p=i(1749),{AudioBufferSource:f,createOscillator:m}=i(8567),{SourceType:g,DeviceEvent:v,ClientError:A,VideoProfile:T,ScreenProfile:_,DebugParam:x}=i(9648),{version:y}=i(4147),{checkSystem:C,isSafari:b,isAppleNotSafari:E}=i(5237),{getSupportedCodec:S}=i(4891),I={width:640,height:360,frameRate:15,bitrateMax:500},w={width:1920,height:1080,frameRate:15,bitrateMax:1500};e.exports=new class{constructor(){this.onMicrophoneChanged=null,this.onCameraChanged=null,this.onPlaybackDeviceChanged=null,this.onDefaultSpeakerChanged=null,this.onDefaultMicrophoneChanged=null,this.onCommunicationSpeakerChanged=null,this.onCommunicationMicrophoneChanged=null,this.setDeviceManagerObserver()}setDeviceManagerObserver(){o.on(v.CAMERA_CHANGED,(e=>{this.onCameraChanged&&this.onCameraChanged(e)})),o.on(v.SPEAKED_CHANGED,(e=>{this.onPlaybackDeviceChanged&&this.onPlaybackDeviceChanged(e)})),o.on(v.MICROPHONE_CHANGED,(e=>{this.onMicrophoneChanged&&this.onMicrophoneChanged(e)})),o.on(v.DEFAULT_SPEAKER_CHANGED,(e=>{this.onDefaultSpeakerChanged&&this.onDefaultSpeakerChanged(e)})),o.on(v.DEFAULT_MICROPHONE_CHANGED,(e=>{this.onDefaultMicrophoneChanged&&this.onDefaultMicrophoneChanged(e)})),o.on(v.COMMUNICATION_SPEAKER_CHANGED,(e=>{this.onCommunicationSpeakerChanged&&this.onCommunicationSpeakerChanged(e)})),o.on(v.COMMUNICATION_MIROPHONE_CHANGED,(e=>{this.onCommunicationMicrophoneChanged&&this.onCommunicationMicrophoneChanged(e)}))}createClient(e={}){return new r({...e})}async createCameraVideoTrack(e){try{(e=e||{}).encoderConfig&&"string"==typeof e.encoderConfig&&e.encoderConfig in T?e.encoderConfig=T[e.encoderConfig]:e.encoderConfig=e.encoderConfig||I;let t=await o.createCameraVideoTrack(e);return new c(t,e)}catch(e){throw e}}async createMicrophoneAudioTrack(e){try{e=e||{};let t=await o.createMicrophoneAudioTrack(e);return new u(t,e)}catch(e){throw e}}createCustomAudioTrack(e){if((e=e||{}).mediaStreamTrack instanceof MediaStreamTrack&&"audio"===e.mediaStreamTrack.kind){let t={};return t.encoderConfig=e.encoderConfig,t.sourceType=e.sourceType,new s(e.mediaStreamTrack,t)}return null}createCustomVideoTrack(e){if((e=e||{}).mediaStreamTrack instanceof MediaStreamTrack&&"video"===e.mediaStreamTrack.kind){let t={};return t.encoderConfig={bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},t.optimizationMode=e.optimizationMode,t.sourceType=e.sourceType,new a(e.mediaStreamTrack,t)}return null}async createMicrophoneAndCameraTracks(e,t){try{(t=t||{}).encoderConfig&&"string"==typeof t.encoderConfig&&t.encoderConfig in T?t.encoderConfig=T[t.encoderConfig]:t.encoderConfig=t.encoderConfig||I,e=e||{};let[i,r]=await o.createMicrophoneAndCameraTracks(e,t);return[new u(i,e),new c(r,t)]}catch(e){throw e}}async createScreenVideoTrack(e,t){try{(e=e||{}).encoderConfig&&"string"==typeof e.encoderConfig&&e.encoderConfig in _?e.encoderConfig=_[e.encoderConfig]:e.encoderConfig=e.encoderConfig||w,e.sourceType=g.CONTENT;let i=await o.createScreenVideoTrack(e,t);if("enable"===t||"auto"===t){if(2===i.length)return[new s(i[0],{sourceType:g.CONTENT}),new a(i[1],e)];if(1===i.length){if("enable"!==t)return new a(i[0],e);throw i[0].stop(),n.error(A.NOT_SUPPORT_AUDIO),A.NOT_SUPPORT_AUDIO}throw n.error("create screen track failed"),A.CREATE_SCREEN_TRACK_FAILED}return new a(i[0],e)}catch(e){throw e}}async createVideoBufferSourceTrack(e,t){return new Promise(((i,r)=>{let n=document.createElement("video");n.muted=!t,n.setAttribute("playsinline","playsinline"),n.setAttribute("autoplay","autoplay"),n.setAttribute("loop","loop"),n.src=e.Url,n.oncanplay=()=>{if(n.readyState>=3){let r=n.captureStream?n.captureStream():n.mozCaptureStream(),o=null;if(!(r.getVideoTracks().length>0))throw A.CREATE_SOURCE_TRACK_FAILED;o=new a(r.getVideoTracks()[0],e);let c=null;if(t){if(!(r.getAudioTracks().length>0))throw A.CREATE_SOURCE_TRACK_FAILED;c=new s(r.getAudioTracks()[0],{})}return i(t?[c,o]:o)}}}))}async checkAudioTrackIsActive(e,t=5e3){if(!(e instanceof s||e instanceof l))throw new Error("[AryaRTC] the track is not a audio track");t=Math.max(t,1e3);const i=e instanceof s?e.getTrackLabel():"remote_track";let r=e.getVolumeLevel(),o=r,a=r;const c=Date.now();return new Promise((r=>{const s=window.setInterval((()=>{let u=e.getVolumeLevel();o=Math.max(u,o),a=Math.min(u,a);let l=1e-4<o-a,d=Date.now()-c;if(l||d>t){clearInterval(s);const t={duration:d,deviceLabel:i,maxVolumeLevel:o,result:l};n.info(`[track-${e.getTrackId()}"] check audio track active completed. ${JSON.stringify(t)}`),r(l)}}),200)}))}async checkVideoTrackIsActive(e,t=5e3){if(!(e instanceof a||e instanceof d))throw new Error("[AryaRTC] the parameter is not a video track");t=Math.max(t,1e3);const i=e instanceof a?e.getTrackLabel():"remote_track",r=e.mediaTrack,o=document.createElement("video");o.style.width="1px",o.style.height="1px",o.setAttribute("muted",""),o.muted=!0,o.setAttribute("playsinline",""),o.controls=!1,(b()||E())&&(o.style.opacity="0.01",o.style.position="fixed",o.style.left="0",o.style.top="0",document.body.appendChild(o)),o.srcObject=new MediaStream([r]),o.play();const s=document.createElement("canvas");s.width=160,s.height=120;let c=0,u=0;try{const e=Date.now();u=await function(e,t,i,r){let o,a=0,s=null;return new Promise(((r,c)=>{setTimeout((()=>{o&&(o(),r(a))}),t),o=m((()=>{a>4&&o&&(o(),r(a));let t=i.getContext("2d");if(t){t.drawImage(e,0,0,160,120);let r=t.getImageData(0,0,i.width,i.height),n=Math.floor(r.data.length/3);if(s)for(let e=0;e<n;e+=3)if(r.data[e]!==s[e]){a+=1,s=r.data;break}s=r.data}else{const e=new Error("[AryaRTC] can not get canvas 2d context.");n.error("[AryaRTC] can not get canvas 2d context."),c(e)}}),30)}))}(o,t,s),c=Date.now()-e}catch(e){throw e}b()&&(o.pause(),o.remove()),o.srcObject=null;let l=4<u;const h={duration:c,changedPicNum:u,deviceLabel:i,result:l};return n.info(`[track-${e.getTrackId()}"] check audio video active completed. ${JSON.stringify(h)}`),l}async createBufferSourceAudioTrack(e){n.info("[AryaRTC] start create buffer source audio track with config",JSON.stringify(e));const t=e.source;if(!(t instanceof f))try{e.source=await p(t,e.cacheOnlineFile)}catch(e){throw e}const i=new f(e.source);let r={};r.encoderConfig=e.encoderConfig;let o=new h(t,i,r);return n.info("[AryaRTC] create buffer source audio track success"),o}getDevices(e){return o.getDevices(e)}getCameras(e){return o.getCameras(e)}getMicrophones(e){return o.getMicrophones(e)}getPlaybackDevices(e){return o.getPlaybackDevices(e)}async getSupportedCodec(e){return S(e)}checkSystemRequirements(){return C()}enbaleLogDebug(e){n.enbaleLogDebug(e)}disableLogUpload(){n.disableLogUpload()}enableLogUpload(){n.enableLogUpload()}setLogLevel(e){n.setLogLevel(e)}get VERSION(){return y}getDeviceId(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}))}_getDebugParam(){return x}}},627:(e,t,i)=>{const r=i(5547),n=i(4312),o=i(485),a=i(8069),{LocalVideoTrack:s,LocalAudioTrack:c,RemoteVideoTrack:u,RemoteAudioTrack:l,RemoteActiveAudioTrack:d}=i(3405),{sendAudioStats:h,sendVideoStats:p,recAudioStats:f,recVideoStats:m}=i(220),g=i(3487),v=i(2951),A=i(7247),T=i(417),{PeerConnectionClient:_}=i(1584),{ClientEvent:x,SignalConnectionState:y,SignalConnectionStateReason:C,MediaType:b,SourceType:E,SimulcastLayer:S,ClientError:I,ClientRole:w,PeerConnectionState:R,PeerEvent:k,PeerType:P,TrackInternalEvent:D,PublishContentState:O,SignalHandlerEvent:L,DeviceEvent:M,ActionEventId:N,ActionEventResult:U,ContentKickedOffReason:B,JoinChannelType:F,AryaError:V,AryaJoinError:H,NetworkQuality:j}=i(9648),{RtcAction:G,PublishInfo:z,SubscribeInfo:W,AryaRTCUser:q}=i(9516),Y=i(9036),Q=i(201),K=i(297),J=i(5459),{getSupportedCodec:X}=i(4891),{version:Z}=i(4147),$="https://api-rtc.yximgs.com/task";e.exports={AryaRTCClient:class extends o{constructor(e){super(),this.role=w.ANCHOR,this.appId="",this.token="",this.uid="",this.sdkVersion=Z,this.channel="",this.callId="",this.servers=null,this.remoteUsers=new Map,this.localUser=null,this.wssUrl=null,this.httpRequest=new g,this.curConnectionState=y.DISCONNECTED,this.rtcAction=new G,this.isReJoin=!1,this.isLeave=!0,this.nginxUrl=$,this.role=void 0,this.isJoined=!1,this.attemptJoinTimerId=null,this.curShareContentUser=null,this.isDualStreamEnabled=!1,this.lowStreamParam={width:320,height:180,frameRate:8,bitrateMax:100},this.waitRemoteUserStateUpdate=!1,this.publishContentState=null,this.signalHandler=null,this.onLine=!0,this.initEventHandler(),this.setDeviceManagerObserver(),v.report({eventId:N.INIT_SDK}),this.config=e||{},this.enableActiveTrack=e.enableActiveTrack||!1,this.deviceId=e.deviceId,this._leaveMutex=new K("leaveMutex"),this._contentMutex=new K("contentMutex"),this.enableStaging=!1,this.joinErrorCode=void 0,this.uplinkNetworkQuality=void 0,this.downlinkNetworkQuality=void 0,this._signalTimeout=!1,this._syncLocaNetworkQuality=!0,this._signalHost="",this._clientMutex=new K("clientMutex")}setClientRole(e){if(A.info(`[Client] setClientRole role:${e}`),void 0!==this.role&&this.isJoined){if(this.role!==e)return e===w.AUDIENCE&&this.checkIfPublish()?Promise.reject(I.AUDIENCE_NOT_ALLOW_PUBLISH):(this.role=e,this.setClientRole_(e))}else this.role=e,v.report({eventId:N.SWITCH_CLIENT_ROLE,param:{role:e===w.ANCHOR?1:2}});return Promise.resolve()}async join(e,t,i,r){if(A.info("[Client] join"),await this._leaveMutex.lock(),this.curConnectionState!==y.DISCONNECTED)throw A.warning("[Client] join repeated"),this._leaveMutex.unlock(),I.REPEATED_JOIN;if(!this.checkUserId(r))return Promise.reject(I.INVALID_USER);if(!this.checkChannelId(t))return Promise.reject(I.INVALID_CHANNEL);if("string"!=typeof e||"string"!=typeof i||0===e.length||0===i.length)return Promise.reject(I.INVALID_PARAMS);A.setData({appId:e,channelId:t,uid:r}),this.appId=e,this.channel=t,this.token=i,this.uid=r,await this.connectionStateTransiteToNewState(y.CONNECTING,C.UNDEFINED),this.isLeave=!1,this.localUser=new q(r),v.start(),v.setData({appId:e,channelId:t,uid:r,localUser:this.localUser,remoteUsers:this.remoteUsers}),v.report({eventId:N.JOIN_CHANNEL}),v.startJoin(F.JOIN_CHANNEL);try{await this.joinInternal(),this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality.bind(this),2e3)}catch(e){throw A.warning(`[Client] join failed error:${e}`),this._leaveMutex.unlock(),I.JOIN_FAILED}this._leaveMutex.unlock()}async leave(){if(A.info("[Client] leave"),await this._leaveMutex.lock(),this.curConnectionState===y.DISCONNECTED)return A.warning("[Client] leave user has leaved"),void this._leaveMutex.unlock();let e;v.report({eventId:N.LEAVE_CHANNEL}),window.onbeforeunload=null,this.role=void 0,this.isJoined=!1,A.info(`[Client] leave user:${this.uid} channel:${this.channel}`);try{this.isLeave=!0;let t=y.CONNECTED==this.curConnectionState;if(await this.connectionStateTransiteToNewState(y.DISCONNECTING,void 0),t){let t=await this.signalHandler.sendLeaveSignal(this.channel,!1);t&&t.body.action===n.Action.kLeave&&2e3===t.body.code?(A.info("[Client] leave success"),e=Promise.resolve(),v.report({eventId:N.LEAVE_CHANNEL_CALLBACK})):(A.error(`[Client] leave failed because gateway fail to leave with code:${code}`),e=Promise.reject(I.GATEWAY_LEAVE_ERROR),v.report({eventId:N.LEAVE_CHANNEL_CALLBACK,result:U.FAIL,reason:`leave failed because gateway fail to leave with code:${code}`}))}else A.warning("[Client] leave connection is not connnected")}catch(t){A.error(`[Client] leave failed with error:${t}`),e=Promise.reject(I.SEND_SIGNAL_ERROR),v.report({eventId:N.LEAVE_CHANNEL_CALLBACK,result:U.FAIL,reason:`leave failed with error:${t}`})}return await this.connectionStateTransiteToNewState(y.DISCONNECTED,C.LEAVE),this.close(),this._leaveMutex.unlock(),e}async publish(e){if(A.info("[Client] publish"),null===this.localUser)throw A.error("[Client] publish local user is not in channel"),I.LOCAL_USER_NOT_IN_CHANNEL;if(y.CONNECTED!==this.connectionState&&y.RECONNECTING!==this.connectionState)throw I.INVALID_OPERATION;if(this.role===w.AUDIENCE)throw A.error("[Client] publish is not allowed when role is the audience"),I.INVALID_OPERATION;let t=Array.isArray(e)?e:[e];if(!this.isLegalTrack(t))throw I.INVALID_LOCAL_TRACK;if(this.checkIfTracksDisabled(t))throw A.warning("[Client] publish track is disabled"),I.TRACK_DISABLED;let i=this.checkAndGetTracksSourceType(t);if(null===i)throw I.TRACK_SOURCE_TYPE_CONFLICT;let r=this.getOrCreatePublishInfo(i,!0);if(this.checkIfTracksPublished(t,r))throw A.warning("[Client] publish track have already been published"),I.TRACK_ALREADY_PUBLISHED;if(i===E.CONTENT&&!this._isValidPublishContentTrack(e))throw A.warning("[Client] publish invalid content track"),I.INVALID_OPERATION;await r.mutex.lock();let n=!1;for(let e of t)try{await this.enablePublishTrack(e,r)&&(n=!0,e instanceof s&&v.report({eventId:N.PUBLISH_VIDEO_STREAM,param:{trackType:e.sourceType}}),e instanceof c&&v.report({eventId:N.UNMUTE_LOCAL_AUDIO_STREAM}))}catch(t){if(A.error(`[Client] publish fail to enable publish track error:${t}`),t===I.PUBLISH_ABORT)return A.error("[Client] publish user abort"),void r.mutex.unlock();throw e instanceof s&&v.report({eventId:N.PUBLISH_VIDEO_STREAM,result:U.FAIL,reason:`publish fail to enable publish track :${t}`}),e instanceof c&&v.report({eventId:N.UNMUTE_LOCAL_AUDIO_STREAM,result:U.FAIL,reason:`publish fail to enable publish track :${t}`}),r.mutex.unlock(),I.ENABLE_TRACK_FAILED}if(n)try{r.iceRestart=r.peer.needIceRestart,await this.sendPublishSignal(r)}catch(e){throw A.error(`[Client] publish fail to send publish signal because of error:${e}`),r.mutex.unlock(),I.SEND_OFFER_FAILED}else r.enableAudio[1]?r.enableVideo[1]||this.sendVideoMuteState(this.localUser.user,!1,r.sourceType):this.sendAudioMuteState(this.localUser.user,!1,r.sourceType);r.mutex.unlock()}async unpublish(e){if(A.info("[Client] unpublish"),null===this.localUser)return A.error("[Client] unpublish local user is not in channel"),Promise.reject(I.LOCAL_USER_NOT_IN_CHANNEL);if(e=Array.isArray(e)?e:[e],!this.isLegalTrack(e))return Promise.reject(I.INVALID_LOCAL_TRACK);let t=this.checkAndGetTracksSourceType(e);if(null===t)return Promise.reject(I.TRACK_SOURCE_TYPE_CONFLICT);let i=this.getOrCreatePublishInfo(t,!1);if(void 0===i)return A.error("[Client] unpublish peer is not exist"),Promise.reject(I.INVALID_OPERATION);await i.mutex.lock();let r=[];for(let t of e)i.releaseNegotiatePromiseIfNeed(t.trackMediaType)||r.push(t);if(0!==r.length){if(t===E.CONTENT&&!this._isValidUnpublishContentTrack(e,i))return Promise.reject(I.INVALID_OPERATION);if(this.checkIfTracksUnpublished(r,i))return A.warning("[Client] unpublish tracks have not been published"),i.mutex.unlock(),Promise.reject(I.TRACK_NOT_PUBLISHED);if(r.forEach((e=>{this.disablePublishTrack(e,i),e instanceof s&&v.report({eventId:N.DISABLE_VIDEO_TX})})),A.info(`[Client] unpublish video:${i.enableVideo[0]} audio:${i.enableAudio[0]}`),i.isVideoPublished()||i.isAudioPublished())if(i.enableAudio[1]){if(i.enableVideo[1])return A.warning("[Client] unpublish tracks have not been published"),i.mutex.unlock(),Promise.reject(I.TRACK_NOT_PUBLISHED);this.sendVideoMuteState(this.localUser.user,!0,i.sourceType)}else this.sendAudioMuteState(this.localUser.user,!0,i.sourceType);else this.sendUnpublishSignal(i);return i.mutex.unlock(),Promise.resolve()}}subscribe(e,t){if(A.info("[Client] subscribe"),!this.localUser)return A.error("[Client] subscribe local user is not in channel"),Promise.reject(I.LOCAL_USER_NOT_IN_CHANNEL);if(y.CONNECTED!==this.connectionState&&y.RECONNECTING!==this.connectionState)throw I.INVALID_OPERATION;if(null===e||!(e instanceof a))return A.error("[Client] subscribe remote user is invaild"),Promise.reject(I.INVALID_REMOTE_USER);if(t!==b.AUDIO&&t!==b.VIDEO)return A.error("[Client] subscribe mediaType is invaild"),Promise.reject(I.INVALID_MEDIA_TYPE);let i=this.remoteUsers.get(e.uid);return void 0===i||e!==i.user?(A.error(`[Client] subscribe user:${e.uid} is not in channel`),Promise.reject(I.REMOTE_USER_NOT_IN_CHANNEL)):!e.hasAudio&&t===b.AUDIO||!e.hasVideo&&t===b.VIDEO?(A.error(`[Client] subscribe user:${e.uid} ${t} is not published`),Promise.reject(I.TRACK_NOT_PUBLISHED)):this.subscribeInternal(i,E.PEOPLE,t)}unsubscribe(e,t){if(A.info("[Client] unsubscribe"),null===e||!(e instanceof a))return A.error("[Client] unsubscribe user is invaild"),Promise.reject(I.INVALID_REMOTE_USER);let i=this.remoteUsers.get(e.uid);return void 0===i||e!==i.user?(A.error(`[Client] unsubscribe user:${e.uid} is not in channel`),Promise.reject(I.REMOTE_USER_NOT_IN_CHANNEL)):this.unsubscribeInternal(i,E.PEOPLE,t)}async enableDualStream(){if(A.info("[Client] enableDualStream"),this.isDualStreamEnabled)throw A.error("[Client] enableDualStream dual stream is already enabled"),I.INVALID_OPERATION;this.isDualStreamEnabled=!0;let e=this.getOrCreatePublishInfo(E.PEOPLE,!1);if(e&&e.publish[0]&&e.publish[1]&&e.enableVideo[0])try{await this.publishLowVideoStream(e),v.report({eventId:N.ENABLE_DUAL_STREAM_MODE})}catch(e){throw v.report({eventId:N.ENABLE_DUAL_STREAM_MODE,result:U.FAIL,reason:JSON.stringify(e)}),I.PUBLISH_LOW_STREAM_FAILED}}async disableDualStream(){if(A.info("[Client] disableDualStream"),v.report({eventId:N.DISABLE_DUAL_STREAM_MODE}),!this.isDualStreamEnabled)return A.error("[Client] enableDualStream dual stream is already disabled"),Promise.reject(I.INVALID_OPERATION);this.isDualStreamEnabled=!1;let e=this.getOrCreatePublishInfo(E.PEOPLE,!1);return e&&e.publishLowStream[0]&&this.sendUnpublishLowVideoStreamSignal(e),Promise.resolve()}setLowStreamParameter(e){if(!e||!e.width&&e.height||e.width&&!e.height)throw A.error("[Client] setLowStreamParameter the width and height must be set meanwhile"),I.INVALID_PARAMS;this.lowStreamParam=e}async setRemoteVideoStreamType(e,t){A.info(`[Client] setRemoteVideoStreamType uid:${e} streamType:${t}`);let i=this.remoteUsers.get(e);if(void 0===i)throw A.error("[Client] setRemoteVideoStreamType user is not in channel"),I.REMOTE_USER_NOT_IN_CHANNEL;if(t!==i.streamType){let r=this.getOrCreateSubscribeInfo(i,E.PEOPLE,!1);if(void 0!==r&&r.enableVideo[0])try{await this.sendSwitchStreamTypeSignal(e,t)}catch(e){throw e}i.streamType=t}}setStreamFallbackOption(e,t){}async setLiveTranscoding(e){try{let t=await this.signalHandler.sendSetLiveTranscodingSignal(e,!1);if(2e3!==t.body.code)throw A.error(`[Client] setLiveTranscoding invalid response code:${t.body.code},config:${JSON.stringify(e)}`),JSON.stringify({type:I.INVALID_RESPONSE,code:t.body.code,msg:t.body.reason,config:JSON.stringify(e)});this.liveTranscoding=e,v.report({eventId:N.SET_LIVE_TRANSCODING,param:{config:JSON.stringify(e)}}),A.info("[Client] setLiveTranscoding")}catch(e){throw v.report({eventId:N.SET_LIVE_TRANSCODING,result:U.FAIL,param:{reason:`setLiveTranscoding fail to send signal, detail: ${e}`}}),A.error("[Client] setLiveTranscoding fail to send signal"),I.SEND_SIGNAL_ERROR}}async startLiveStreaming(e,t){try{let i=await this.signalHandler.sendStartLiveStreamingSignal(e,t,!1);if(2e3!==i.body.code)throw A.error(`[Client] startLiveStreaming invalid response code:${i.body.code}`),JSON.stringify({type:I.INVALID_RESPONSE,code:i.body.code,msg:i.body.reason});v.report({eventId:N.START_LIVE_STREAM}),A.info(`[Client] startLiveStreaming, url: ${e}`)}catch(e){throw v.report({eventId:N.START_LIVE_STREAM,result:U.FAIL,param:{reason:`startLiveStreaming fail to send signal, detail: ${e}`}}),A.error("[Client] startLiveStreaming fail to send signal"),I.SEND_SIGNAL_ERROR}}async stopLiveStreaming(e){try{let t=await this.signalHandler.sendStopLiveStreamingSignal(e,!1);if(2e3!==t.body.code)throw A.error(`[Client] stopLiveStreaming invalid response code:${t.body.code}`),JSON.stringify({type:I.INVALID_RESPONSE,code:t.body.code,msg:t.body.reason});v.report({eventId:N.STOP_LIVE_STREAM}),A.info(`[Client] stopLiveStreaming, url: ${e}`)}catch(e){throw v.report({eventId:N.STOP_LIVE_STREAM,result:U.FAIL,param:{reason:`stopLiveStreaming fail to send signal, detail: ${e}`}}),A.error("[Client] stopLiveStreaming fail to send signal"),I.SEND_SIGNAL_ERROR}}async sendSwitchStreamTypeSignal(e,t){A.info(`[Client] sendSwitchStreamTypeSignal uid:${e} streamType:${t}`),v.report({eventId:N.SET_REMOTE_USER_STREAM_TYPE,param:{stream_type:Number("low"===t),user_id:e}});try{let i=await this.signalHandler.sendSwitchStreamTypeSignal(e,t,!1);if(2e3!==i.body.code)throw A.error(`[Client] sendSwitchStreamTypeSignal fail to send signal of switching stream type code:${i.body.code}`),v.report({eventId:N.SET_REMOTE_USER_STREAM_TYPE,result:U.FAIL,reason:`sendSwitchStreamTypeSignal fail to send signal of switching stream type code:${i.body.code}`,param:{stream_type:Number("low"===t),user_id:e}}),I.INVALID_RESPONSE;this.emit(x.STREAM_TYPE_CHANGED,e,t)}catch(e){throw I.SEND_SIGNAL_ERROR}}sendAudioMuteState(e,t,i){A.info(`[Client] sendAudioMuteState uid:${e} isMute:${t} sourceType:${i}`),this.signalHandler.sendAudioMuteStateSignal(e,t,i,!1,!0),e===this.localUser.user?(v.report({eventId:t?N.MUTE_LOCAL_AUDIO_STREAM:N.UNMUTE_LOCAL_AUDIO_STREAM,param:{uid:e,sourceType:i}}),v.report({eventId:N.MUTE_MICROPHONE,param:{mute:t}})):(v.report({eventId:t?N.MUTE_REMOTE_AUDIO_STREAM:N.UNMUTE_REMOTE_AUDIO_STREAM,param:{participants:[{user_id:e,source_type:i}]}}),v.report({eventId:t?N.REMOTE_MIC_MUTE:N.REMOTE_MIC_UNMUTE,param:{remote_user_id:e}}))}sendVideoMuteState(e,t,i){A.info(`[Client] sendVideoMuteState uid:${e} isMute:${t} sourceType:${i}`),this.signalHandler.sendVideoMuteStateSignal(e,t,i,!1,!0),e===this.localUser.user?v.report({eventId:t?N.DISABLE_VIDEO_TX:N.ENABLE_VIDEO_TX,param:{uid:e,sourceType:i}}):(v.report({eventId:t?N.MUTE_REMOTE_VIDEO_STREAM:N.UNMUTE_REMOTE_VIDEO_STREAM,param:{participants:[{user_id:e,source_type:i}]}}),v.report({eventId:t?N.REMOTE_VIDEO_MUTE:N.REMOTE_VIDEO_UNMUTE,param:{remote_user_id:e}}))}async sendPublishSignal(e){A.info(`[Client] sendPublishSignal video:${e.enableVideo[0]} audio:${e.enableAudio[0]}, sourceType:${e.sourceType}`);let t=e.iceRestart?{iceRestart:!0}:{},i=e.peer.getLocalSdp(),r=await e.peer.createOffer(t);if("H264"===(this.config.codec||"H264")&&e.isVideoPublished()&&(r=T.setSpsPpsIdrInkeyFrame(r,{codec:"H264/90000"})),r=T.writeRtcpFb(r,"rrtr"),i&&(r=T.replaceSSrcWithLastSdp(i,r)),e.publish=[!0,!1],e.peer.setOfferSdp(r),e.enableVideo[1]=!0,e.enableAudio[1]=!0,e.sourceType===E.CONTENT){try{await this._contentMutex.lock(),A.info(`[Client] sendPublishSignal content state:${this.publishContentState}`),this.publishContentState!==O.PUBLISH_CONTENT_SUCCESS&&(this.publishContentState=O.WAIT_PUBLISH_RESPONSE);let t=await this.signalHandler.sendPublishSignal(e.enableVideo[0],e.enableAudio[0],r,e.sourceType,S.HIGHSTREAM,e.iceRestart,!1);if(!t||2e3!==t.body.code){let e=t&&t.body?t.body.code:void 0;throw A.error(`[Client] sendPublishSignal fail to publish content with code:${e}`),I.INVALID_RESPONSE}await this.handlePublishAction(E.CONTENT,S.HIGHSTREAM,t.body.sdp),this.publishContentState!==O.PUBLISH_CONTENT_SUCCESS&&(this.publishContentState=O.PENDING_PUBLISH_CONTENT)}catch(t){throw e.iceRestart||(await this._onPublishContentFailed(e),this.publishContentState=null),A.error("[Client] sendPublishSignal fail to publish content"),this._contentMutex.unlock(),t}this._contentMutex.unlock()}else this.signalHandler.sendPublishSignal(e.enableVideo[0],e.enableAudio[0],r,e.sourceType,S.HIGHSTREAM,e.iceRestart,!0)}async sendPublishLowVideoStreamSignal(e){try{e.publishLowStream=[!0,!1];let t=e.iceRestart?{iceRestart:!0}:{},i=e.lowStreamPeer.getLocalSdp(),r=await e.lowStreamPeer.createOffer(t);"H264"===(this.config.codec||"H264")&&(r=T.setSpsPpsIdrInkeyFrame(r,{codec:"H264/90000"})),r=T.writeRtcpFb(r,"rrtr"),i&&(r=T.replaceSSrcWithLastSdp(i,r)),e.lowStreamPeer.setOfferSdp(r),this.signalHandler.sendPublishSignal(!0,!1,r,e.sourceType,S.LOWSTREAM,e.iceRestart,!0)}catch(e){A.error(`[Client] sendPublishLowVideoStreamSignal fail to set offer because of error:${e}`)}}sendUnpublishSignal(e){A.info(`[Client] sendUnpublishSignal video:${e.enableVideo[0]} audio:${e.enableAudio[0]} sourceType:${e.sourceType}`),(e.enableAudio[0]||e.enableVideo[0])&&A.error("[Client] sendUnpublishSignal media status is wrong"),e.enableVideo[1]=!0,e.enableAudio[1]=!0,e.publish=[!1,!1],this.signalHandler.sendUnpublishSignal(!0,!0,e.sourceType,S.HIGHSTREAM,!0),e.peer&&(e.peer.close(),e.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.peer=null),e.sourceType===E.CONTENT&&(this.publishContentState=null)}sendUnpublishLowVideoStreamSignal(e){A.info("[Client] sendUnpublishLowVideoStreamSignal"),!e.publishLowStream[0]&&e[1]||(e.publishLowStream=[!1,!1],this.signalHandler.sendUnpublishSignal(!0,!1,e.sourceType,S.LOWSTREAM,!0),e.lowStreamPeer&&(e.lowStreamPeer.close(),e.lowStreamPeer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.lowStreamPeer=null,e.lowStreamVideoTrack&&e.lowStreamVideoTrack.stop(),e.lowStreamVideoTrack=null))}async sendSubscribeSignal(e,t){A.info("[Client] sendSubscribeSignal");let i=t.iceRestart?{iceRestart:!0}:{},r=t.enableAudio[0],n=t.enableVideo[0],o=await t.peer.createOffer(i);this.config.codec;o=T.writeRtcpFb(o,"rrtr"),t.peer.setOfferSdp(o),t.subscribe=[!0,!1],this.signalHandler.sendSubscribeSignal(e,o,n,r,t.sourceType,t.iceRestart,!0)}sendUnsubscribeSignal(e,t,i){t.enableAudio[1]=!0,t.enableVideo[1]=!0,t.subscribe=[!1,!1],this.signalHandler.sendUnsubscribeSignal(e,i,!0),t.peer&&(t.peer.close(),t.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),t.peer=null)}async setClientRole_(e){try{let t=await this.signalHandler.sendSetRoleSignal(e,!1);if(!t||!t.body||2e3!==t.body.code)throw v.report({eventId:N.SWITCH_CLIENT_ROLE,result:U.FAIL,reason:`${JSON.stringify(t)}`,param:{role:e===w.ANCHOR?1:2}}),I.SET_ROLE_FALIED;v.report({eventId:N.SWITCH_CLIENT_ROLE,param:{role:e===w.ANCHOR?1:2}}),A.info(`[Client] setClientRole role:${e} success`)}catch(t){throw v.report({eventId:N.SWITCH_CLIENT_ROLE,result:U.FAIL,reason:`setClientRole fail to set role error:${t}`,param:{role:e===w.ANCHOR?1:2}}),A.error(`[Client] setClientRole fail to set role error:${t}`),I.SEND_SIGNAL_ERROR}}async _handleDisableLocalTrackEvent(e,t,i){A.info(`[Client] handleDisableLocalTrackEvent_ mediaType:${t} sourceType:${i}`);let r=this.getOrCreatePublishInfo(i,!1);await r.mutex.lock();do{if(null===this.localUser||!r||!r.peer){A.warning("[Client] handleDisableLocalTrackEvent track have not been published");break}if(t===b.AUDIO&&!r.enableAudio[0]||t==b.VIDEO&&!r.enableVideo[0]){A.warning("[Client] handleDisableLocalTrackEvent track have not been published");break}try{r.peer.removeTrack(e)}catch(e){A.warning("[Client] handleDisableLocalTrackEvent track have not been published")}t===b.AUDIO?(r.enableAudio=[!1,!1],this.sendAudioMuteState(this.localUser.user,!0,i)):t===b.VIDEO&&(r.enableVideo=[!1,!1],this.sendVideoMuteState(this.localUser.user,!0,i),this.isDualStreamEnabled&&i===E.PEOPLE&&this.sendUnpublishLowVideoStreamSignal(r),v.report({eventId:N.UNPUBLISH_VIDEO_STREAM}))}while(0);r.mutex.unlock()}async _handleEnableLocalTrackEvent(e,t,i){A.info(`[Client] handleEnableLocalTrackEvent mediaType:${t} sourceType:${i}`);let r=this.getOrCreatePublishInfo(i,!1);await r.mutex.lock();do{if(null===this.localUser||!r||!r.peer){A.warning("[Client] handleEnableLocalTrackEvent track have not been published");break}let n=!1;try{n=await r.peer.addTrack(e)}catch(e){A.warning("[Client] handleEnableLocalTrackEvent track have been added")}if(A.info(`[Client] handleEnableLocalTrackEvent mediaType:${t} sourceType:${i} negotiate:${n}`),t===b.AUDIO)r.enableAudio=[!0,!1],r.peer.supportUnifiedPlan&&!n?this.sendAudioMuteState(this.localUser.user,!1,i):(r.iceRestart=r.peer.needIceRestart,this.sendPublishSignal(r));else if(r.enableVideo=[!0,!1],r.peer.supportUnifiedPlan&&!n?this.sendVideoMuteState(this.localUser.user,!1,i):(r.iceRestart=!1,this.sendPublishSignal(r)),this.isDualStreamEnabled&&i===E.PEOPLE)try{await this.publishLowVideoStream(r)}catch(e){A.error("[Client] handleEnableLocalTrackEvent publish low stream failed")}}while(0);r.mutex.unlock()}async _handleReplaceLocalTrackEvent(e,t,i,r){A.info(`[Client] onReplaceLocalTrack mediaType:${t} sourceType:${i}`);let n=this.getOrCreatePublishInfo(i,!1);await n.mutex.lock();do{if(null===this.localUser||!n||!n.peer){A.info("[Client] onReplaceLocalTrack track have not been published");break}try{n.peer.replaceTrack(e),n.peer.supportReplaceTrack||(n.iceRestart=!1,this.sendPublishSignal(n)),r&&t===b.VIDEO&&n.enableVideo[0]&&n.peer.isSenderSupportedSetParam()&&(await n.peer.setVideoEncoderParams({maxBitrate:r.encoderConfig.bitrateMax}),n.videoConfig=r);let i=!r||r&&!0===r.updateLowStream;t===b.VIDEO&&n.lowStreamPeer&&i&&(n.lowStreamVideoTrack&&n.lowStreamVideoTrack.stop(),n.lowStreamVideoTrack=await n.videoTrack.clone(this.lowStreamParam),n.lowStreamPeer.replaceTrack(n.lowStreamVideoTrack),n.lowStreamPeer.supportReplaceTrack||(n.iceRestart=!1,this.sendPublishLowVideoStreamSignal(n)))}catch(e){A.warning(`[Client] onReplaceLocalTrack replace track error:${e}`)}}while(0);n.mutex.unlock()}async connectionStateTransiteToNewState(e,t){if(A.info(`[Client] connectionStateTransiteToNewState state:${e} reason:${t} rejoin:${this.isReJoin}`),this.isReJoin&&e!==y.CONNECTED)return!1;if(A.info(`[Client] connectionStateTransiteToNewState ${this.curConnectionState} transite to ${e}`),e===this.curConnectionState)return!1;let i=this.curConnectionState,n=!1;return this.curConnectionState===y.DISCONNECTED?n=e===y.CONNECTING:this.curConnectionState===y.CONNECTING?n=e===y.CONNECTED||e===y.DISCONNECTING||e===y.DISCONNECTED:this.curConnectionState===y.CONNECTED?n=e===y.DISCONNECTING||e===y.RECONNECTING||e===y.DISCONNECTED:this.curConnectionState===y.DISCONNECTING?n=e===y.DISCONNECTED:this.curConnectionState===y.RECONNECTING&&(n=e===y.CONNECTED||e===y.DISCONNECTING||e===y.DISCONNECTED),!!n&&(this.curConnectionState=e,i===y.RECONNECTING&&e===y.CONNECTED&&(this.rtcAction.clear(),this.isReJoin||(this.waitRemoteUserStateUpdate=!0,await this._clientMutex.lock(),"firefox"!==r.browserDetails.browser&&"Not a supported browser."!==r.browserDetails.browser||await this.recreateMediaConnection(),await this.reconnectMedia(),this._clientMutex.unlock())),this.emit(x.CONNECTION_STATE_CHANGE,this.curConnectionState,i,t),!0)}joinInternal(){if(this.isReJoin&&this.isLeave)return Promise.reject("REJOIN_FAILED");const e={createRequest:{workerName:"webrtc_proxy",jsonData:`{"uid": "${this.uid}", "roomId":"${this.channel}"}`}};return new Promise(((t,i)=>{let r=()=>{v.report({eventId:N.SECHEDU_SERVICE_REQ}),this.httpRequest.post(this.nginxUrl,e,g.ContentType.Plain).then((n=>{v.report({eventId:N.SECHEDU_SERVICE_RES,param:{uid:this.uid}}),A.info(`[Client] joinInternal userId:${this.uid} channel:${this.channel} request:${JSON.stringify(e)} response:${JSON.stringify(n)}`);let o=JSON.parse(n.createdReport.jsonData);this.wssUrl=`wss://${o.domain}?ip=${o.ip}&port=${o.port}&uid=${this.uid}`,A.setData({appId:this.appId,channelId:this.channel,uid:this.uid}),A.info(`[Client] joinInternal wssUrl:${this.wssUrl}`),setTimeout((()=>A.startUpload()),5e3),this.createSignalHandler(),this.signalHandler.connnect(this.wssUrl).then((async()=>{this._signalTimeout=!1,v.report({eventId:N.SIGNAL_RES});try{void 0===this.role?await this.setClientRole(w.ANCHOR):await this.setClientRole_(this.role),void 0===this.supportH264&&await this._isSupportH264();let e=await this.signalHandler.sendJoinSignal(this.channel,this.role,this.token,this.supportH264,this._signalHost,!1);if(e&&e.body&&2e3===e.body.code){let i=this.isReJoin?C.REJOIN_SUCCESS:C.JOIN_SUCCESS;await this.connectionStateTransiteToNewState(y.CONNECTED,i),A.info(`[Client] joinInternal uid:${this.uid} channel:${this.channel} success`),this.isJoined=!0,this._waitOnline=!1,window.ononline=async()=>{A.info(`[Client] joinInternal online ${navigator.onLine}`),this.onLine=!0,this._waitOnline&&(this._waitOnline=!1,!1===this.isLeave&&!this.isReJoin&&this.isJoined&&await this.reconnect())},window.onoffline=()=>{A.info(`[Client] joinInternal offline ${navigator.onLine}`),this.onLine=!1,this._waitOnline=!0},v.setData({callId:e.body.callId,ip:e.clientAddress,serverList:n.createdReport.jsonData,serverAddress:e.serverAddress,connectInfo:JSON.stringify({ws_servers:this.wssUrl,addr:`${e.serverAddress}`})}),v.report({eventId:N.JOIN_CHANNEL_CALLBACK}),v.endJoin(!0),t(this.uid),this.enableActiveTrack&&await this.subscribeActiveAudio()}else{let t=e&&e.body?e.body.code:void 0;A.error(`[Client] joinInternal fail because gateway fail to join with code:${t}`),this.handleJoinTimeout(i,I.GATEWAY_JOIN_ERROR,r),v.report({eventId:N.JOIN_CHANNEL_CALLBACK,result:U.FAIL,reason:`join fail because gateway fail to join with code:${t}`})}}catch(e){A.error(`[Client] joinInternal fail to send signal because of error:${e}`),await this.handleJoinTimeout(i,I.SEND_SIGNAL_ERROR,r)}})).catch((async e=>{A.error(`[Client] joinInternal websocket fail to open because of error:${e}`),this._signalTimeout=!0,await this.handleJoinTimeout(i,e,r),v.report({eventId:N.SIGNAL_RES,param:{uid:this.uid},result:U.FAIL,reason:`join websocket fail to open because of error:${e}`})}))})).catch((async e=>{A.error(`[Client] joinInternal fail to fetch spawner because of error:${e}`),await this.handleJoinTimeout(i,I.FETCH_SPAWNER_ERROR,r),v.report({eventId:N.SECHEDU_SERVICE_RES,result:U.FAIL,reason:`join fail to fetch spawner because of error:${e}`})}))};r()}))}async _handleSignalStateEvent(e,t){(!this.isReJoin&&this.isJoined||e!==y.CONNECTED)&&await this.connectionStateTransiteToNewState(e,t)}_handleSignalReconnectFailedEvent(){A.info("[Client] handleSignalReconnectFailedEvent"),this.isLeave||(this.rejoin(),v.report({eventId:N.SIGNAL_RECONNECT_RES,result:U.FAIL}))}async reconnectMedia(){A.info("[Client] reconnectMedia");try{await this.reconnectPublishMedia(E.PEOPLE),this.waitRemoteUserStateUpdate||await this.reconnectPublishMedia(E.CONTENT),await this.reconnectSubscribeMedia()}catch(e){A.info(`[Client] reconnectMedia error:${e}`)}}async rejoin(){if(A.info("[Client] rejoin"),!this.isReJoin)try{this.isReJoin=!0,v.startJoin(F.REJOIN_CHANNEL),await this.joinInternal(),A.info("[Client] rejoin success"),await this._clientMutex.lock(),await this.recreateMediaConnection(),await this.reconnectMedia(),this._clientMutex.unlock(),this.isReJoin=!1,v.start(),v.setData({appId:this.appId,channelId:this.channel,uid:this.uid,localUser:this.localUser,remoteUsers:this.remoteUsers}),v.report({eventId:N.REJOIN_CHANNEL})}catch(e){A.error(`[Client] fail to rejoin because of error:${e}`),this.isReJoin=!1,setTimeout((()=>{this.rejoin()}),2e3),v.report({eventId:N.REJOIN_CHANNEL,result:U.FAIL,reason:`fail to rejoin because of error:${e}`})}}async subscribeInternal(e,t,i){let r=this.getOrCreateSubscribeInfo(e,t,!0);if(await r.mutex.lock(),i===b.AUDIO){if(r.enableAudio[0])return A.error(`[Client] subscribeInternal user:${e.user.uid} audio of ${t} has already subscribed`),await r.mutex.unlock(),Promise.reject(I.TRACK_ALREADY_SUBSCRIBED);r.enableAudio=[!0,!0]}if(i===b.VIDEO){if(r.enableVideo[0])return A.error(`[Client] subscribeInternal user:${e.user.uid} video of ${t} has already subscribed`),r.mutex.unlock(),Promise.reject(I.TRACK_ALREADY_SUBSCRIBED);try{null!==e.streamType&&await this.sendSwitchStreamTypeSignal(e.user.uid,e.streamType)}catch(t){return A.error(`[Client] subscribeInternal fail to switch stream for user:${e.user.uid} error:${t}`),r.mutex.unlock(),Promise.reject(I.SWITCH_STREADM_TYPE_FAILED)}r.enableVideo=[!0,!0]}v.report({eventId:i===b.AUDIO?N.UNMUTE_REMOTE_AUDIO_STREAM:N.UNMUTE_REMOTE_VIDEO_STREAM,param:{uid:e.user.uid,mediaType:i}}),A.info(`[Client] subscribeInternal uid:${e.user.uid} sourceType:${t} mediaType:${i}`);let n=this.createMediaPromise(e,i,r);try{r.subscribe[0]?i===b.AUDIO?(r.enableAudio[1]=!1,this.sendAudioMuteState(e.user.uid,!1,t)):(r.enableVideo[1]=!1,this.sendVideoMuteState(e.user.uid,!1,t)):(r.iceRestart=!1,await this.sendSubscribeSignal(e.user.uid,r))}catch(e){return r.mutex.unlock(),Promise.reject(I.SET_OFFER_FAILED)}r.mutex.unlock();try{return await n.run()}catch(r){throw A.warning(`[Client] subscribeInternal user unsubscribe, uid:${e.user.uid} sourceType:${t} mediaType:${i}`),I.SUBSCRIBE_ABORT}}async unsubscribeInternal(e,t,i){let r=this.getOrCreateSubscribeInfo(e,t,!1);if(void 0===r)return A.error(`[Client] unsubscribeInternal user:${e.user.uid} ${i} has not been subscribed`),Promise.reject(I.TRACK_NOT_SUBSCRIBED);if(await r.mutex.lock(),A.info(`[Client] unsubscribeInternal user:${e.user.uid} sourceType:${t} mediaType:${i} enableAudio:${r.enableAudio} enableVideo:${r.enableVideo}`),i===b.AUDIO){if(!r.enableAudio[0])return A.error(`[Client] unsubscribeInternal user:${e.user.uid} audio has not been subscribed`),r.mutex.unlock(),Promise.reject(I.TRACK_NOT_SUBSCRIBED);t===E.PEOPLE?(e.user.audioTrack&&e.user.audioTrack.stop(),e.user.audioTrack=void 0):(e.user.contentAudioTrack&&e.user.contentAudioTrack.stop(),e.user.contentAudioTrack=void 0),r.enableAudio=[!1,!1],v.report({eventId:N.MUTE_REMOTE_AUDIO_STREAM,param:{uid:e.user.uid,mediaType:i}})}if(i===b.VIDEO){if(!r.enableVideo[0])return A.error(`[Client] unsubscribeInternal user:${e.user.uid} video has not been subscribed`),r.mutex.unlock(),Promise.reject(I.TRACK_NOT_SUBSCRIBED);t===E.PEOPLE?(e.user.videoTrack&&e.user.videoTrack.stop(),e.user.videoTrack=void 0):(e.user.contentVideoTrack&&e.user.contentVideoTrack.stop(),e.user.contentVideoTrack=void 0),r.enableVideo=[!1,!1],v.report({eventId:N.MUTE_REMOTE_VIDEO_STREAM,param:{uid:e.user.uid,mediaType:i}})}return r.enableAudio[0]||r.enableVideo[0]?r.enableAudio[1]?r.enableVideo[1]||this.sendVideoMuteState(e.user.uid,!0,t):this.sendAudioMuteState(e.user.uid,!0,t):this.sendUnsubscribeSignal(e.user.uid,r,t),r.mutex.unlock(),i===b.AUDIO?r.sourceType===E.PEOPLE?r.audioPromise&&r.audioPromise.cancel():r.contentAudioPromise&&r.contentAudioPromise.cancel():r.sourceType===E.PEOPLE?r.videoPromise&&r.videoPromise.cancel():r.contentVideoPromise&&r.contentVideoPromise.cancel(),Promise.resolve()}async enablePublishTrack(e,t){A.info(`[Client] enablePublishTrack type:${e.trackMediaType} id:${e.getTrackId()} sourceType:${e.getSourceType()}`),e._publish=!0;let i=!1;t.peer||(t.peer=new _({type:P.PUBLISH,log:A,id:this.localUser.user,sourceType:t.sourceType}),t.peer.on(k.CONNECTION_STATE,this.onconnectionstatechange));try{if(i=await t.peer.addTrack(e.getMediaStreamTrack()),i&&t.publish[0]&&!t.publish[1])try{t.mutex.unlock(),await t.createWaitNegotiatePromise(e.trackMediaType)}catch(t){throw A.warning(`[Client] enablePublishTrack abort mediaType:${e.trackMediaType}`),t}}catch(t){throw A.warning(`[Client] enablePublishTrack ${e.trackMediaType} peer add track failed because of error:${t}`),t}if(this.bindTrackEvent(e),e.trackMediaType===b.AUDIO)t.enableAudio=[!0,i],t.audioTrack=e;else if(e.trackMediaType===b.VIDEO){if(t.enableVideo=[!0,i],t.videoConfig=e.config,t.videoTrack=e,this.isDualStreamEnabled&&t.sourceType===E.PEOPLE)try{await this.publishLowVideoStream(t)}catch(t){A.warning(`[Client] enablePublishTrack ${e.trackMediaType} fail to publish low video stream because of error:${t}`)}t.sourceType===E.CONTENT&&v.report({eventId:N.START_SCREEN_CAPTURE})}return i}disablePublishTrack(e,t){A.info(`[Client] disablePublishTrack type:${e.trackMediaType} id:${e.getTrackId()}`),e._publish=!1,e.enable&&t.peer.removeTrack(e.getMediaStreamTrack()),this.unbindTrackEvent(e),e.trackMediaType===b.AUDIO?(t.enableAudio=[!1,!1],t.audioTrack=null,v.report({eventId:N.MUTE_LOCAL_AUDIO_STREAM})):e.trackMediaType===b.VIDEO&&(t.enableVideo=[!1,!1],t.videoTrack=null,this.isDualStreamEnabled&&t.sourceType===E.PEOPLE&&this.sendUnpublishLowVideoStreamSignal(t),v.report({eventId:t.sourceType===E.PEOPLE?N.DISABLE_VIDEO_TX:N.STOP_SCREEN_CAPTURE}))}async publishLowVideoStream(e){if(A.info("[Client] publishLowVideoStream"),null===e.lowStreamPeer){e.lowStreamPeer=new _({type:P.PUBLISH,id:this.localUser.user,sourceType:E.PEOPLE,simulcastLayer:S.LOWSTREAM});try{e.lowStreamVideoTrack=await e.videoTrack.clone(this.lowStreamParam),await e.lowStreamPeer.addTrack(e.lowStreamVideoTrack)}catch(t){throw A.error(`[Client] publishLowVideoStream fail to add low video track because of error:${t}`),e.lowStreamPeer.close(),e.lowStreamPeer=null,t}this.sendPublishLowVideoStreamSignal(e)}}createMediaPromise(e,t,i){A.info(`[Client] createMediaPromise user:${e.user.uid}`),i.peer||(i.peer=new _({type:P.SUBSCRIBE,id:e.user.uid,sourceType:i.sourceType}),i.peer.on(k.CONNECTION_STATE,this.onconnectionstatechange));let r=new Promise((async(r,n)=>{t===b.AUDIO?(i.peer.once(k.AUDIO_TRACK,(t=>{A.info(`[Client] createMediaPromise onAudioTrack uid:${e.user.uid}`),i.sourceType===E.PEOPLE?(e.user.audioTrack=new l(e.user.uid,t,i.sourceType),r(e.user.audioTrack)):(e.user.contentAudioTrack=new l(e.user.uid,t,i.sourceType),r(e.user.contentAudioTrack))})),i.peer.enableSubscribeAudio()):t===b.VIDEO&&(i.peer.once(k.VIDEO_TRACK,(t=>{A.info(`[Client] createMediaPromise onVideoTrack uid:${e.user.uid}`),i.sourceType===E.PEOPLE?(e.user.videoTrack=new u(e.user.uid,t,i.sourceType),r(e.user.videoTrack)):(e.user.contentVideoTrack=new u(e.user.uid,t,i.sourceType),r(e.user.contentVideoTrack))})),i.peer.enableSubscribeVideo())}));return t===b.AUDIO?i.sourceType===E.PEOPLE?i.audioPromise=new J(r):i.contentAudioPromise=new J(r):i.sourceType===E.PEOPLE?i.videoPromise=new J(r):i.contentVideoPromise=new J(r)}async recreateMediaConnection(){A.info("[Client] recreateMediaConnection");for(let[e,t]of this.remoteUsers)for(let i of t.subscribeInfos.values())if(i.peer&&(A.info(`[Client] recreateMediaConnection recreate subscribe peer for user:${e} audio:${i.enableAudio[0]} video:${i.enableVideo[0]}`),await i.peer.recreatePeerConnection(),i.enableAudio[0]&&(i.peer.once(k.AUDIO_TRACK,(r=>{A.info(`[Client] recreateMediaConnection onAudioTrack uid:${e} sourceType:${i.sourceType}`),i.sourceType===E.PEOPLE?t.user.audioTrack?t.user.audioTrack.setMediaTrack(r):t.user.audioTrack=new l(e,r,i.sourceType,this.stats):t.user.contentAudioTrack?t.user.contentAudioTrack.setMediaTrack(r):t.user.contentAudioTrack=new l(e,r,i.sourceType,this.stats)})),i.peer.enableSubscribeAudio()),i.enableVideo[0]&&(i.peer.once(k.VIDEO_TRACK,(r=>{A.info(`[Client] recreateMediaConnection onVideoTrack uid:${e} sourceType:${i.sourceType}`),i.sourceType===E.PEOPLE?t.user.videoTrack?t.user.videoTrack.setMediaTrack(r):t.user.videoTrack=new u(e,r,i.sourceType,this.stats):t.user.contentVideoTrack?t.user.contentVideoTrack.setMediaTrack(r):t.user.contentVideoTrack=new u(e,r,i.sourceType,this.stats)})),i.peer.enableSubscribeVideo(),i.sourceType===E.PEOPLE)))try{null!==t.streamType&&await this.sendSwitchStreamTypeSignal(e,t.streamType)}catch(t){A.error(`[Client] recreateMediaConnection fail to switch stream for user:${e} error:${t}`)}if(this.localUser)try{for(let e of this.localUser.publishInfos.values())e.peer&&await e.peer.recreatePeerConnection(),e.lowStreamPeer&&await e.lowStreamPeer.recreatePeerConnection()}catch(e){A.error(`[Client] recreateMediaConnection fail to recreate publish peer error:${e}`)}}async reconnectPublishMedia(e){if(A.info(`[Client] reconnectPublishMedia sourceType:${e}`),null!==this.localUser)for(let t of this.localUser.publishInfos.values()){if(t.sourceType!==e)continue;let i=t.peer?t.peer.connectionState:void 0;A.info(`[Client] reconnectPublishMedia enableAudio:${t.enableAudio} enableVideo:${t.enableVideo} publish:${t.publish} connectionState:${i} sourceType:${t.sourceType}`);try{await t.mutex.lock(),t.publish[0]&&t.peer&&(t.enableAudio[0]||t.enableVideo[0])?i===R.FAILED||i===R.NEW||i===R.DISCONNECTED||!1===t.publish[1]?(t.iceRestart=!0,await this.sendPublishSignal(t)):i===R.CONNECTED&&(t.enableAudio[1]||this.sendAudioMuteState(this.uid,!t.enableAudio[0],t.sourceType),t.enableVideo[1]||this.sendVideoMuteState(this.uid,!t.enableVideo[0],t.sourceType)):t.publish[0]||t.publish[1]||(t.enableAudio[1]=!0,t.enableVideo[1]=!0,this.sendUnpublishSignal(t)),t.sourceType===E.PEOPLE&&this.reconnectLowVideoStreamMedia(t),t.mutex.unlock()}catch(e){A.error(`[Client] reconnectPublishMedia fail to reconnect error:${e}`),t.mutex.unlock()}}else A.warning("[Client] reconnectPublishMedia local user is null")}reconnectLowVideoStreamMedia(e){if(A.info(`[Client] reconnectLowVideoStreamMedia dual stream enabled:${this.isDualStreamEnabled}`),e.publishLowStream[0]&&e.lowStreamPeer){let t=e.lowStreamPeer.connectionState;t!==R.FAILED&&t!==R.NEW&&t!==R.DISCONNECTED&&!1!==e.publishLowStream[1]||(e.iceRestart=!0,this.sendPublishLowVideoStreamSignal(e))}else e.publishLowStream[0]||e.publishLowStream[1]||this.sendUnpublishLowVideoStreamSignal(e)}async reconnectSubscribeMedia(){A.info("[Client] reconnectSubscribeMedia"),this.remoteUsers.forEach((async(e,t)=>{for(let i of e.subscribeInfos.values())try{let e=i.peer?i.peer.connectionState:void 0;A.info(`[Client] reconnectSubscribeMedia user:${t} enableAudio:${i.enableAudio} enableVideo:${i.enableVideo} subscribe:${i.subscribe} connectionState:${e}`),await i.mutex.lock(),i.subscribe[0]&&i.peer?e===R.FAILED||e===R.NEW||e===R.DISCONNECTED||!1===i.subscribe[1]?(i.enableAudio[1]=!0,i.enableVideo[1]=!0,i.iceRestart=!0,await this.sendSubscribeSignal(t,i)):e===R.CONNECTED&&(i.enableAudio[1]||this.sendAudioMuteState(t,!i.enableAudio[0],i.sourceType),i.enableVideo[1]||this.sendVideoMuteState(t,!i.enableVideo[0],i.sourceType)):i.subscribe[0]||i.subscribe[1]||((i.enableAudio[0]||i.enableVideo[0])&&A.error(`[Client] reconnectSubscribeMedia enableAudio:${i.enableAudio[0]} and enableVideo:${i.enableVideo[0]} are both false when subscribe is false`),this.sendUnsubscribeSignal(t,i,i.sourceType)),i.mutex.unlock()}catch(e){A.error(`[Client] reconnectSubscribeMedia fail to reconnect error:${e}`),i.mutex.unlock()}}))}handleUserOnlineState(e){A.info(`[Client] handleUserOnlineState uid:${e}`);let t=this.remoteUsers.get(e);if(void 0!==t)return void A.warning(`[Client] handleUserOnlineState user ${e} has already exit`);let i=new a(e);t=new q(i),this.remoteUsers.set(e,t),this.emit(x.USER_JOINED,i),v.report({eventId:N.PARTICIPANT_ONLINE,param:{remote_user_id:e}})}handleUserOfflineState(e){A.info(`[Client] handleUserOfflineState uid:${e}`);let t=this.remoteUsers.get(e);if(void 0!==t){for(let e of t.subscribeInfos.values())null!==e.peer&&(e.peer.close(),e.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.peer=null);this.emit(x.USER_LEFT,t.user),this.remoteUsers.delete(e),v.report({eventId:N.PARTICIPANT_OFFLINE,param:{remote_user_id:e,action:"handleUserOfflineState"}})}else A.warning(`[Client] handleUserOffline user:${e} does not exit`)}async handlePublishAction(e,t,i){if(A.info(`[Client] handlePublishAction sourceType:${e} simulcastLayer:${t}`),void 0===i)return void A.error("[Client] handlePublishAction sdp is error");let r=this.getOrCreatePublishInfo(e,!1);if(!r)return void A.warning("[Client] handlePublishAction publish local user or publishInfo is null");e===E.PEOPLE&&await r.mutex.lock();let n=t===S.HIGHSTREAM?r.publish:r.publishLowStream;if(!n[0]||n[1])return A.warning("[Client] handlePublishAction publish peerconnection has already set remote sdp or invalid response"),void(e===E.PEOPLE&&r.mutex.unlock());let o=t===S.HIGHSTREAM?r.peer:r.lowStreamPeer;n[1]=!0;let a=t===S.HIGHSTREAM&&r.enableVideo[0]?r.videoConfig.encoderConfig:this.lowStreamParam;r.enableVideo[0]&&a&&(o.isSenderSupportedSetParam()||(i=T.setVideoSendBitRate(i,{videoSendBitrate:a.bitrateMax})),i=T.setVideoCodecParam(i,{minBitrate:a.bitrateMin,profileLevelId:"42e01f"}));try{await o.setAnswerSdp(i),r.enableVideo[0]&&o.isSenderSupportedSetParam()&&(await o.setVideoEncoderParams({maxBitrate:a.bitrateMax}),r.videoConfig.optimizationMode&&await o.setOptimizationMode(r.videoConfig.optimizationMode))}catch(e){A.error(`[Client] handlePublishAction fail to set answer or param for peer because of error:${e}`)}e===E.PEOPLE&&r.mutex.unlock()}async handleUnpublishAction(e,t){A.info(`[Client] handleUnpublishAction sourceType:${e} simulcastLayer:${t}`);let i=this.getOrCreatePublishInfo(e,!1);if(void 0===i)return void A.warning("[Client] handleUnpublishAction unpublish publishInfo is undefined");await i.mutex.lock();let r=t===S.HIGHSTREAM?i.publish:i.publishLowStream;if(r[0]||r[1])return A.warning("[Client] handleUnpublishAction action is invalid"),void i.mutex.unlock();r[1]=!0,t===S.HIGHSTREAM&&this.localUser.publishInfos.delete(e),i.mutex.unlock()}handleSubcribeAction(e,t,i){if(A.info(`[Client] handleSubcribeAction uid:${e} sourceType:${t}`),void 0===i)return void A.error("[Client] handleSubcribeAction sdp is error");let r=this.remoteUsers.get(e),n=this.getOrCreateSubscribeInfo(r,t,!1);if(void 0!==n&&n.peer){if(!n.subscribe[0]||n.subscribe[1])return void A.warning(`[Client] handleSubcribeAction peerconnection of subscribe ${e} has already set remote sdp`);A.info(`[Client] handleSubcribeAction set sdp of user:${e} peerconnection`),n.subscribe[1]=!0,n.peer.setAnswerSdp(i)}else A.warning("[Client] handleSubcribeAction action is invalid")}handleUnsubscribeAction(e,t){A.info(`[Client] handleUnsubscribeAction uid:${e} sourceType:${t}`);let i=this.remoteUsers.get(e),r=this.getOrCreateSubscribeInfo(i,t,!1);if(void 0!==r){if(r.subscribe[0]||r.subscribe[1])return void A.warning(`[Client] handleUnsubscribeAction subscribe:${r.subscribe} action is invalid`);r.subscribe[1]=!0}else A.warning("[Client] handleUnsubscribeAction action is invalid")}handleMuteAction(e,t,i,r){A.info(`[Client] handleMuteAction uid:${e} sourceType:${t} mediaType:${i} mute:${r}`);let n=null,o=this.remoteUsers.get(e);if(void 0!==o?(n=this.getOrCreateSubscribeInfo(o,t,!1),v.report({eventId:i===b.AUDIO?r?N.MUTE_REMOTE_AUDIO_STREAM:N.UNMUTE_REMOTE_AUDIO_STREAM:r?N.MUTE_REMOTE_VIDEO_STREAM:N.UNMUTE_REMOTE_VIDEO_STREAM,param:{participants:[{user_id:e,source_type:t}]}})):this.localUser&&this.localUser.user===e&&(n=this.getOrCreatePublishInfo(t,!1),v.report({eventId:i===b.AUDIO?r?N.MUTE_LOCAL_AUDIO_STREAM:N.UNMUTE_LOCAL_AUDIO_STREAM:r?N.DISABLE_VIDEO_TX:N.ENABLE_VIDEO_TX}),i===b.AUDIO&&v.report({eventId:N.MUTE_MICROPHONE,param:{mute:r}})),null!==n){let e;if(i===b.AUDIO?e=n.enableAudio:i===b.VIDEO&&(e=n.enableVideo),e[0]===r||e[1])return void A.warning(`[Client] handleMuteAction action is invalid with mediaType:${i} mute:${r}`);e[1]=!0}else A.warning(`[Client] handleMuteAction do not find user:${e}`)}handleMuteState(e,t,i,r){A.info(`[Client] handleMuteState uid:${e} mediaType:${t} mute:${i} sourceType:${r}`);let n=this.remoteUsers.get(e);if(void 0!==n)switch(r){case E.PEOPLE:this.handlePeopleTrackMuteState(n,t,i);break;case E.CONTENT:}else A.warning(`[Client] handleMuteState mute_video user ${e} does not exit`)}async handleContentTrackMuteState(e,t){if(A.info(`[Client] handleContentTrackMuteState uid:${e.user.uid} mute:${t} state:${this.publishContentState}`),t||e.user.uid===this.uid||await this.checkIfLocalContentKickedOff(),!this.isValidContentTrackMuteState(e,t))return A.error("[Client] handleContentTrackMuteState track mute state is wrong"),void this._contentMutex.unlock();if(t){try{e.user.hasContent=!1,await this.unsubscribeInternal(e,E.CONTENT,b.VIDEO),await this.unsubscribeInternal(e,E.CONTENT,b.AUDIO)}catch(t){A.error(`[Client] handleContentTrackMuteState fail to unsubscribe content of ${e.user.uid}`)}this.curShareContentUser=null,this.emit(x.CONTENT_UNPUBLISHED,e.user.uid,b.VIDEO),this.emit(x.CONTENT_UNPUBLISHED,e.user.uid,b.AUDIO)}else try{e.user.hasContent=!0,this.curShareContentUser=e;let t=await this.subscribeInternal(e,E.CONTENT,b.VIDEO);this.emit(x.CONTENT_PUBLISH,t,b.VIDEO),t=await this.subscribeInternal(e,E.CONTENT,b.AUDIO),this.emit(x.CONTENT_PUBLISH,t,b.AUDIO)}catch(t){A.error(`[Client] handleContentTrackMuteState fail to subscribe content of ${e.user.uid} error:${t}`)}}handlePeopleTrackMuteState(e,t,i){if(t===b.VIDEO){if(i&&null===e.user.hasVideo)return void A.debug(`[Client] handlePeopleTrackMuteState user:${e.user.uid} video mute should be notified after the unmute`);if(!e.user.hasVideo===i)return void A.debug(`[Client] handlePeopleTrackMuteState user:${e.user.uid} video mute:${i} has already been notified`);e.user.hasVideo=!i}else if(t===b.AUDIO){if(i&&null===e.user.hasAudio)return void A.debug(`[Client] handlePeopleTrackMuteState user:${e.user.uid} audio mute should be notified after the unmute`);if(!e.user.hasAudio===i)return void A.debug(`[Client] handlePeopleTrackMuteState user:${e.user.uid} audio mute:${i} has already been notified`);e.user.hasAudio=!i}A.info(`[Client] handlePeopleTrackMuteState uid:${e.user.uid} media:${t} mute:${i}`),this.emit(i?x.USER_UNPUBLISHED:x.USER_PUBLISHED,e.user,t)}async handleRemoteUsersState(e){A.info("[Client] handleRemoteUsersState"),await this._clientMutex.lock();let t=[];this.remoteUsers.forEach(((i,r)=>{let n=!1;for(const t of e)if(t.remote_uid===r){n=!0;break}n||t.push(r)}));for(const e of t){A.info(`[Client] handleRemoteUsersState user_offline user:${e}`);let t=this.remoteUsers.get(e);if(void 0!==t){this.remoteUsers.delete(e);for(let e of t.subscribeInfos.values())null!==e.peer&&(e.peer.close(),e.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.peer=null);this.curShareContentUser&&this.curShareContentUser.user.uid===e&&(await this._contentMutex.lock(),await this.handleContentTrackMuteState(this.curShareContentUser,!0),this._contentMutex.unlock()),this.emit(x.USER_LEFT,t.user),v.report({eventId:N.PARTICIPANT_OFFLINE,param:{remote_user_id:e,action:"handleRemoteUsersState"}})}else A.error(`[Client] handleRemoteUsersState remote user:${e} is not found`)}for(let t of e)this.remoteUsers.has(t.remote_uid)||this.handleUserOnlineState(t.remote_uid),"boolean"==typeof t.video_mute&&this.handleMuteState(t.remote_uid,b.VIDEO,t.video_mute,E.PEOPLE),"boolean"==typeof t.audio_mute&&this.handleMuteState(t.remote_uid,b.AUDIO,t.audio_mute,E.PEOPLE);this._clientMutex.unlock()}async handleKickedOutState(){A.info("[Client] handleKickedOutState"),this.isJoined=!1,this.isLeave=!0,this.role=void 0,this.localUser&&(await this.connectionStateTransiteToNewState(y.DISCONNECTED,C.UID_BANNED),v.report({eventId:N.LEAVE_CHANNEL_KICKED}),this.close())}async _onconnectionstatechange(e,t,i,r){A.info(`[Client] onconnectionstatechange id:${e} sourceType:${t} simulcastLayer:${i} state:${r} signalConnection:${this.curConnectionState} rejoin:${this.isReJoin}`);try{"failed"===r&&(this.localUser&&e===this.localUser.user?await this._handlePublishMediaConnectionFailed(t,i):await this._handleSuscribeMediaConnectionFailed(e,t))}catch(e){A.warning(`[Client] onconnectionstatechange renegotiate failed error:${e}`)}}async _handleSuscribeMediaConnectionFailed(e,t){A.info("[Client] handleSuscribeMediaConnectionFailed");let i="boolean"==typeof navigator.onLine?navigator.onLine:this.onLine;if(this.curConnectionState===y.CONNECTED&&i&&!this.isReJoin){let i=this.remoteUsers.get(e);if(i){let r=this.getOrCreateSubscribeInfo(i,t,!1);if(await r.mutex.lock(),r&&r.peer&&r.subscribe[1]){A.info(`[Client] handleSuscribeMediaConnectionFailed renegotiate sdp of subcribe for user:${e} sourceType:${t}`),r.iceRestart=!0;try{await this.sendSubscribeSignal(e,r)}catch(e){r.mutex.unlock()}}r.mutex.unlock()}}}async _handlePublishMediaConnectionFailed(e,t){let i=this.getOrCreatePublishInfo(e);if(i){A.info("[Client] handlePublishMediaConnectionFailed");try{await i.mutex.lock(),await i.peer.recreatePeerConnection();let r="boolean"==typeof navigator.onLine?navigator.onLine:this.onLine;(i.enableAudio[0]||i.enableVideo[0])&&this.curConnectionState===y.CONNECTED&&r&&!this.isReJoin&&(t===S.HIGHSTREAM&&i.peer&&i.publish[1]&&(A.info(`[Client] handlePublishMediaConnectionFailed renegotiate sdp of publish for sourceType:${e} simulcastLayer:${t}`),i.iceRestart=!0,await this.sendPublishSignal(i)),t===S.LOWSTREAM&&i.lowStreamPeer&&i.publishLowStream[1]&&(A.info(`[Client] handlePublishMediaConnectionFailed renegotiate sdp of publish for sourceType:${e} simulcastLayer:${t}`),i.iceRestart=!0,await this.sendPublishLowVideoStreamSignal(i)))}catch(e){throw i.mutex.unlock(),e}i.mutex.unlock()}else A.info("[Client] handlePublishMediaConnectionFailed publishInfo is null")}close(){if(A.info("[Client] close"),this.joinErrorCode=void 0,this.attemptJoinTimerId&&clearTimeout(this.attemptJoinTimerId),this.attemptJoinTimerId=null,this._audioVolumeIndicationInterval&&window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=null,this.destroySignalHandler(),this.publishContentState=null,this.remoteUsers.forEach(((e,t)=>{void 0!==e.user.audioTrack&&e.user.audioTrack.stop(),void 0!==e.user.videoTrack&&e.user.videoTrack.stop();for(let t of e.subscribeInfos.values())t.peer&&(t.peer.close(),t.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),t.peer=null)})),this.localUser)for(let e of this.localUser.publishInfos.values())e.peer&&(e.peer.close(),e.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.peer=null),e.lowStreamPeer&&(e.lowStreamPeer.close(),e.lowStreamPeer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.lowStreamPeer=null,e.lowStreamVideoTrack&&e.lowStreamVideoTrack.stop(),e.lowStreamVideoTrack=null);if(this.audioUser){for(let e of this.audioUser.subscribeInfos.values())e.peer&&(e.peer.close(),e.peer.off(k.CONNECTION_STATE,this.onconnectionstatechange),e.peer=null);this.audioUser=null}this.remoteActiveAudioTrack=null,this.remoteUsers.clear(),this.localUser=null,this.curShareContentUser=null,v.stop(),this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0,this._clientMutex.locked&&this._clientMutex.unlock(),A.close()}bindTrackEvent(e){e.on(D.DISABLE_TRACK,this.handleDisableTrackEvent),e.on(D.ENABLE_TRACK,this.handleEnableTrackEvent),e.on(D.REPLACE_TRACK,this.handleReplaceTrackEvent),e.on(D.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode)}unbindTrackEvent(e){e.off(D.DISABLE_TRACK,this.handleDisableTrackEvent),e.off(D.ENABLE_TRACK,this.handleEnableTrackEvent),e.off(D.REPLACE_TRACK,this.handleReplaceTrackEvent),e.off(D.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode)}createSignalHandler(){this.signalHandler||(this.signalHandler=new Y(this),this.signalHandler.on(L.RECONNECT_FAILED,this.handleSignalReconnectFailedEvent),this.signalHandler.on(L.CONNECTION_STATE,this.handleSignalStateEvent))}destroySignalHandler(){null!==this.signalHandler&&(this.signalHandler.off(L.RECONNECT_FAILED,this.handleSignalReconnectFailedEvent),this.signalHandler.off(L.CONNECTION_STATE,this.handleSignalStateEvent),this.signalHandler.close(!1),this.signalHandler=null)}initEventHandler(){this.onconnectionstatechange=this._onconnectionstatechange.bind(this),this.handleDisableTrackEvent=this._handleDisableLocalTrackEvent.bind(this),this.handleEnableTrackEvent=this._handleEnableLocalTrackEvent.bind(this),this.handleReplaceTrackEvent=this._handleReplaceLocalTrackEvent.bind(this),this.handleSetOptimizationMode=this._handleSetOptimizationMode.bind(this),this.handleSignalReconnectFailedEvent=this._handleSignalReconnectFailedEvent.bind(this),this.handleSignalStateEvent=this._handleSignalStateEvent.bind(this),this.handleMuteActiveAudioTrackEvent=this._handleMuteActiveAudioTrackEvent.bind(this)}setDeviceManagerObserver(){Q.on(M.CAMERA_CHANGED,(e=>{v.report({eventId:N.CAMERA_DEVICE_UPDATE,param:{device_name:e.device.label,device_id:e.device.deviceId,state:e.device.state}})})),Q.on(M.SPEAKED_CHANGED,(e=>{this.reportDeviceInfo(e)})),Q.on(M.MICROPHONE_CHANGED,(e=>{this.reportDeviceInfo(e)})),Q.on(M.DEFAULT_SPEAKER_CHANGED,(e=>{this.reportDeviceInfo(e)})),Q.on(M.DEFAULT_MICROPHONE_CHANGED,(e=>{this.reportDeviceInfo(e)}))}reportDeviceInfo(e){const{device:t}=e;v.report({eventId:"audioinput"===t.kind?N.AUDIO_INPUT_DEVICE_UPDATE:N.AUDIO_OUTPUT_DEVICE_UPDATE,param:{device_name:t.label,device_id:t.deviceId,state:e.state}})}_handleSetOptimizationMode(e,t,i,r){A.info(`[Client] handleSetOptimizationMode meidaType:${t} sourceType:${i} mode:${r}`);let n=this.getOrCreatePublishInfo(i,!1);void 0!==n&&n.peer&&n.peer.isSenderSupportedSetParam()&&n.peer.isTrackAdded(e)&&n.peer.setOptimizationMode(r)}checkUserId(e){return"string"==typeof e&&/^[1-9]\d*$/.test(e)||"number"==typeof e&&e>0}checkChannelId(e){return"string"==typeof e&&/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e)}checkIfTracksPublished(e,t){for(let i of e){if(i.trackMediaType===b.AUDIO&&(t.audioTrack||t.audioPending))return!0;if(i.trackMediaType===b.VIDEO&&(t.videoTrack||t.videoPending))return!0}return!1}checkIfTracksUnpublished(e,t){if(!t.peer)return!0;for(let i of e){if(i.trackMediaType===b.AUDIO&&!t.audioTrack)return!0;if(i.trackMediaType===b.VIDEO&&!t.videoTrack)return!0}return!1}checkIfTracksDisabled(e){for(let t of e)if(!t.enable)return!0;return!1}checkAndGetTracksSourceType(e){let t=e[0].getSourceType();for(let i of e.slice(1))if(t!==i.getSourceType())return null;return t}getOrCreatePublishInfo(e,t){if(null===this.localUser)return;let i=this.localUser.publishInfos.get(e);return void 0===i&&t&&(i=new z(e,this.localUser.user),this.localUser.publishInfos.set(e,i)),i}getOrCreateSubscribeInfo(e,t,i){if(!e)return;let r=e.subscribeInfos.get(t);return void 0===r&&i&&(r=new W(t,e.user.uid),e.subscribeInfos.set(t,r)),r}checkIfPublish(){if(null===this.localUser)return!1;for(let e of this.localUser.publishInfos.values())if(e.publish[0])return!0;return!1}async checkIfLocalContentKickedOff(){if(A.info("[Client] checkIfLocalContentKickedOff"),null===this.localUser)return;let e=this.localUser.publishInfos.get(E.CONTENT);if(void 0!==e&&e.publish[0]){let t=[];e.enableAudio[0]&&t.push(e.audioTrack),e.enableVideo[0]&&t.push(e.videoTrack);try{await this.unpublish(t)}catch(e){A.error(`[Client] checkIfLocalContentKickedOff fail to unpublish error:${e}`)}A.info("[Client] local content is kicked off"),this.emit(x.CONTENT_KICKED_OFF,B.KICKED_OFF)}}closeLocalContent(){if(!this.localUser)return;let e=this.localUser.publishInfos.get(E.CONTENT);void 0!==e&&e.publish[0]&&(A.info("[Client] close local content"),e.peer.close(),e.peer=null,this.publishContentState=null,this.localUser.publishInfos.delete(E.CONTENT),this.emit(x.CONTENT_KICKED_OFF,B.REJOIN))}async _onPublishContentFailed(e){A.info("[Client] onPublishContentFailed");try{e.audioTrack=null,e.enableAudio=[!1,!0],e.videoTrack=null,e.enableVideo=[!1,!0],this.sendUnpublishSignal(e)}catch(e){A.warning(`[Client] onPublishContentFailed unpublish error:${e}`)}}enbleOpenApi(){this.nginxUrl=$,this.enableStaging=!1,v.setData({env:"prod"}),A.env="prod"}disableOpenApi(e){!0===e?(this.nginxUrl="https://webrtc-staging.staging.kuaishou.com/task",this.enableStaging=!0):(this.nginxUrl="https://test-api-rtc.yximgs.com/task",this.enableStaging=!1),v.setData({env:"prod"}),A.env="staging"}setClientAddress(e){v.setData({ip:e})}isLegalTrack(e){for(let t of e)if(!(t instanceof c||t instanceof s))return!1;return!0}isValidContentTrackMuteState(e,t){return(null!==this.curShareContentUser||!t)&&((!this.curShareContentUser||this.curShareContentUser===e)&&!(this.curShareContentUser&&!this.curShareContentUser.user.hasContent&&t))}async handleContentState(e){if(await this._clientMutex.lock(),await this._contentMutex.lock(),A.info(`[Client] handleContentState user:${e} ${this.publishContentState}`),this.publishContentState===O.PENDING_PUBLISH_CONTENT)if(e!==this.localUser.user){if(!this.waitRemoteUserStateUpdate)return A.warning("[Client] handleContentState publish content is pending"),this._contentMutex.unlock(),void this._clientMutex.unlock();await this.handleRemoteContentState(e)}else this.publishContentState=O.PUBLISH_CONTENT_SUCCESS,this.curShareContentUser&&await this.handleContentTrackMuteState(this.curShareContentUser,!0);else await this.handleRemoteContentState(e);if(this.waitRemoteUserStateUpdate)return this.waitRemoteUserStateUpdate=!1,this._contentMutex.unlock(),await this.reconnectPublishMedia(E.CONTENT),void this._clientMutex.unlock();this._contentMutex.unlock(),this._clientMutex.unlock()}async handleRemoteContentState(e){let t=this.remoteUsers.get(e);void 0!==t?(this.curShareContentUser&&t!==this.curShareContentUser&&await this.handleContentTrackMuteState(this.curShareContentUser,!0),this.curShareContentUser&&this.curShareContentUser===t||await this.handleContentTrackMuteState(t,!1)):this.curShareContentUser?await this.handleContentTrackMuteState(this.curShareContentUser,!0):A.debug("[Client] handleRemoteContentState invalid content state")}async handleJoinTimeout(e,t,i){this._leaveMutex.locked&&this._leaveMutex.unlock(),v.endJoin(!1),this.signalHandler&&this.signalHandler.close(!0),void 0===this.joinErrorCode?(await this.connectionStateTransiteToNewState(y.RECONNECTING),this.attemptJoinTimerId=setTimeout((()=>{this.isLeave||this.joinErrorCode?(A.warning("[Client] handleJoinTimeout stop attempting to join because user has leaved"),v.report({eventId:N.SIGNAL_RES,result:U.FAIL,reason:"handleJoinTimeout stop attempting to join because user has leaved"}),t=this.joinErrorCode?H.get(this.joinErrorCode):t,A.error(`[Client] attempt join error:${t}`),this.joinErrorCode=void 0,e(t)):(v.startJoin(F.REJOIN_CHANNEL),i())}),1500)):(await this.connectionStateTransiteToNewState(y.DISCONNECTED),t=H.get(this.joinErrorCode),this.joinErrorCode=void 0,A.error(`[Client] join handleJoinTimeout error:${t}`),e(t))}get channelName(){return this.channel}get connectionState(){return this.curConnectionState}get localTracks(){const e=[];if(this.localUser){let t=this.localUser.publishInfos.get(E.PEOPLE);void 0!==t&&t.publish[0]&&(t.enableAudio[0]&&e.push(t.audioTrack),t.enableVideo[0]&&e.push(t.videoTrack))}return e}enableAudioVolumeIndicator(){if(this._audioVolumeIndicationInterval)return A.warning("[Client] you have already enabled audio volume indicator!");this._audioVolumeIndicationInterval=window.setInterval((()=>{const e=[];this.remoteUsers.forEach(((t,i)=>{e.push({level:t.user.audioTrack?100*t.user.audioTrack.getVolumeLevel():0,uid:i})}));let t=this.localUser&&this.localUser.publishInfos.get(E.PEOPLE);t&&t.publish[0]&&e.push({level:t.audioTrack?100*t.audioTrack.getVolumeLevel():0,uid:this.localUser.user}),e.sort(((e,t)=>e.level-t.level)),this.emit(x.VOLUME_INDICATOR,e)}),2e3)}getLocalAudioStats(){if(!this.localUser)return h;for(let e of this.localUser.publishInfos.values())return e.audioTrack?e.audioTrack.getStats():h;return h}getLocalVideoStats(){if(!this.localUser)return p;for(let e of this.localUser.publishInfos.values())return e.videoTrack?e.videoTrack.getStats():p;return p}getRTCStats(){let e=1,t=0,i=0,r=0,n=0;for(let e of this.localUser.publishInfos.values()){if(e.audioTrack){const r=e.audioTrack.getStats();t+=r.sendBytes,i+=r.sendBitrate}if(e.videoTrack){const r=e.videoTrack.getStats();t+=r.sendBytes,i+=r.sendBitrate}}return this.remoteUsers.forEach(((e,t)=>{const i=e.user.audioTrack;i&&(r+=i.getStats().receiveBytes,n+=i.getStats().receiveBitrate);const o=e.user.audioTrack;o&&(r+=o.getStats().receiveBytes,n+=o.getStats().receiveBitrate);const a=e.user.videoTrack;a&&(r+=a.getStats().receiveBytes,n+=a.getStats().receiveBitrate);const s=e.user.contentVideoTrack;s&&(r+=s.getStats().receiveBytes,n+=s.getStats().receiveBitrate)})),e+=this.remoteUsers.size,{UserCount:e,SendBitrate:i,SendBytes:t,RecvBytes:r,RecvBitrate:n}}getRemoteAudioStats(){const e={};return this.remoteUsers.forEach(((t,i)=>{const r=t.user.audioTrack;r&&(e[i]=r.getStats());const n=t.user.contentAudiorack;n&&(e[`${i}_content`]=n.getStats())})),e}getRemoteVideoStats(){const e={};return this.remoteUsers.forEach(((t,i)=>{const r=t.user.videoTrack;r&&(e[i]=r.getStats());const n=t.user.contentVideoTrack;n&&(e[`${i}_content`]=n.getStats())})),e}getRemoteNetworkQuality(){const e={};return this.remoteUsers.forEach(((t,i)=>{e[i]=Object.assign({},t.user.netQuality)})),e}async subscribeActiveAudio(){try{let e=new a("any");this.audioUser=new q(e);let t=this.getOrCreateSubscribeInfo(this.audioUser,E.PEOPLE,!0);t.peer=new _({type:P.SUBSCRIBE,id:this.audioUser.user.uid,sourceType:t.sourceType}),t.peer.on(k.CONNECTION_STATE,this.onconnectionstatechange);let i=await t.peer.createOffer({});i=T.writeRtcpFb(i,"rrtr"),t.peer.setOfferSdp(i);let r=await this.signalHandler.sendSubscribeSignal("any",i,!1,!0,t.sourceType,!1);2e3===r.body.code&&(t.peer.on(k.MEDIA_STREAM,(e=>{A.info(`[Client] subscribeCommonAudio audio track size:${e.getAudioTracks().length}`),this.remoteActiveAudioTrack||(this.remoteActiveAudioTrack=new d),this.remoteActiveAudioTrack.addMediaStream(e),5===this.remoteActiveAudioTrack.mediaStreams.size&&(this.remoteActiveAudioTrack.on(D.MUTE_ACTIVE_AUDIO_TRACK,this.handleMuteActiveAudioTrackEvent),this.emit(x.ACTIVE_TRACK,this.remoteActiveAudioTrack))})),await t.peer.setAnswerSdp(r.body.sdp))}catch(e){A.error(`fail to subscribe common audio error:${e}`)}}handleTrackRelationState(e){A.info(`[Client] trackRelation:${JSON.stringify(e)}`),this.remoteActiveAudioTrack||(this.remoteActiveAudioTrack=new d),this.remoteActiveAudioTrack.updateTrackRelation(e)}handleAryaErrorState(e,t){this.emit(x.ERROR,{code:e,msg:t}),V.has(e)&&v.report({eventId:V.get(e),result:U.FAIL,param:{reason:t}}),H.has(e)&&(this.joinErrorCode=e),A.error(`[Client] get arya error: code: ${e}, msg: ${t}`)}handleRemoteNetQuality(e,t,i){A.info(`[Client] remote network quality uid:${e} uplink:${t} downlink:${i}`);let r=this.remoteUsers.get(e);r&&(r.user.netQuality={uplinkNetworkQuality:t,downlinkNetworkQuality:i})}_hasPublishStream(){if(this.localUser)for(const e of this.localUser.publishInfos.values())if(e.publish[0]&&(e.enableAudio[0]||e.enableVideo[0]))return!0;return!1}_hasSubscribeStream(){if(this.remoteUsers)for(const e of this.remoteUsers.values())for(let t of e.subscribeInfos.values())if(t.subscribe[0])return!0;return!1}isMediaConnectionActive(){if(this.localUser)for(let e of this.localUser.publishInfos.values())if(e.peer&&(e.peer.connectionState===R.DISCONNECTED||e.peer.connectionState===R.CONNECTED))return!0;if(this.remoteUsers)for(let e of this.remoteUsers.values())for(let t of e.subscribeInfos.values())if(t.peer&&(t.peer.connectionState===R.DISCONNECTED||t.peer.connectionState===R.CONNECTED))return!0;return!1}isMediaConnected(){if(this.localUser)for(let e of this.localUser.publishInfos.values())if(e.peer&&e.peer.connectionState===R.CONNECTED)return!0;if(this.remoteUsers)for(let e of this.remoteUsers.values())for(let t of e.subscribeInfos.values())if(t.peer&&t.peer.connectionState===R.CONNECTED)return!0;return!1}async _handleUpdateNetworkQuality(){let e=j.UNKNOWN,t=j.UNKNOWN;navigator&&"boolean"==typeof navigator.onLine&&!navigator.onLine?(e=j.UNAVAILABLE,t=j.UNAVAILABLE):this._signalTimeout?(e=j.VERY_BAD,t=j.VERY_BAD):this.connectionState===y.CONNECTED?(e=this._hasPublishStream()?this.isMediaConnected()?v.uplinkNetworkQuality:j.VERY_BAD:this.signalHandler?this.signalHandler.delayScore:j.UNKNOWN,t=this._hasSubscribeStream()?this.isMediaConnected()?v.downlinkNetworkQuality:j.VERY_BAD:this.signalHandler?this.signalHandler.delayScore:j.UNKNOWN):(e=j.UNKNOWN,t=j.UNKNOWN);let i=!1;if(void 0!==this.uplinkNetworkQuality&&void 0!==this.downlinkNetworkQuality&&this.uplinkNetworkQuality==e&&this.downlinkNetworkQuality==t||(this.uplinkNetworkQuality=e,this.downlinkNetworkQuality=t,i=!0,A.info(`[Client] local network quality uplink:${this.uplinkNetworkQuality} downlink:${this.downlinkNetworkQuality}`),this.emit(x.NETWORK_QUALITY,{uplinkNetworkQuality:this.uplinkNetworkQuality,downlinkNetworkQuality:this.downlinkNetworkQuality})),!0===this._syncLocaNetworkQuality||i)try{if(A.debug(`[Client] send uplink:${this.uplinkNetworkQuality} downlink:${this.downlinkNetworkQuality} networkQualityChanged:${i}`),this._syncLocaNetworkQuality=!0,this.connectionState===y.CONNECTED&&this.onLine){2e3!==(await this.signalHandler.sendLocalNetQualitySignal(this.uplinkNetworkQuality,this.downlinkNetworkQuality,!1)).body.code?(A.debug("[Client] fail to send net quality error:invalid response"),this._syncLocaNetworkQuality=!0):this._syncLocaNetworkQuality=!1}}catch(e){this._syncLocaNetworkQuality=!1,A.debug("[Client] fail to send net quality")}}async _handleMuteActiveAudioTrackEvent(e,t){if(A.info(`[Client] handleActiveAudioTrackEvent uid:${e} mute:${t}`),void 0===this.remoteUsers.get(e))throw I.INVALID_REMOTE_USER;if(2e3!==(await this.signalHandler.sendAudioMuteStateSignal(e,t,E.PEOPLE,!0,!1)).body.code)throw I.SEND_SIGNAL_ERROR}async _isSupportH264(){let e=await X();Array.isArray(e.video)&&e.video.includes("H264")?this.supportH264=!0:this.supportH264=!1}async reconnect(){await this.connectionStateTransiteToNewState(y.RECONNECTING),this.signalHandler&&await this.signalHandler.reconnect()}_isValidPublishContentTrack(e){return Array.isArray(e)||e instanceof s}_isValidUnpublishContentTrack(e,t){return!t.enableAudio[0]||Array.isArray(e)}_setSignalHost(e){this._signalHost=e}}}},9596:(e,t,i)=>{const{parseJSON:r}=i(4891),n=i(4312),o=i(485),{ClientError:a,ActionEventId:s,ActionEventResult:c,qualityTransform:u}=i(9648),l=i(7247),d=i(2951);class h extends o{constructor(){super(),this.websocket_=null,this.wssUrl_=null,this.lockReconnect=!1,this.pingTimerId=null,this.pongTimerId=null,this.connectTimerId=null,this.reconnectTimerId=null,this.heartTimeout=3e3,this.pindInterval=3e3,this.onSignalConnectionStateChange=null,this.onMessage=null,this.wsStatus=h.WsStatus.WsStausUnknown,this.waitResSignals=[],this.reconnectCnt=0,this.reconnectInterval=2e3,this.appId="",this.roomId=0,this.uid="",this.sdkVersion="",this.lastReconnectTime=null,this.stats=null,this.isOnceJoined=!1,this.observer=null,this.delayScore=0}init(e,t,i,r,n){this.appId=e,this.roomId=t,this.uid=i,this.sdkVersion=r,this.observer=n,this.stats=this.observer.client.stats}open(e){if(l.info(`[Signal] open url:${e}`),this.wssUrl_=e,this.websocket_){if(this.websocket_.readyState===WebSocket.OPEN)return l.warning("[Signal] open has already opened"),Promise.resolve();this.websocket_=null}return new Promise(((e,t)=>{let i=()=>{let r=()=>{l.info("[Signal] handleWebsocketOpenFail"),this.reconnectCnt++,this.lastReconnectTime=this.lastReconnectTime?this.lastReconnectTime:Date.now(),this.reconnectTimerId=setTimeout((async()=>{let e=Date.now();l.warning(`[Signal] handleWebsocketOpenFail interval:${e-this.lastReconnectTime} reconnectInterval:${this.reconnectInterval} reconnectCnt:${this.reconnectCnt}`),e-this.lastReconnectTime>3e4?this.observer.isMediaConnectionActive()?(l.info("[Signal] handleWebsocketOpenFail isActive"),i()):this.isOnceJoined?(this.isOnceJoined=!1,this.onReconnectFail()):t(a.SIGNAL_OPEN_FAILED):i()}),this.reconnectInterval)};try{this.websocket_=new WebSocket(this.wssUrl_),d.report({eventId:s.SIGNAL_REQ}),this.connectTimerId=setTimeout((()=>{this.websocket_&&this.websocket_.readyState===WebSocket.OPEN||(l.error("[Signal] Signaling open timeout"),d.report({eventId:s.SIGNAL_REQ,result:c.FAIL,reason:"[Signal] Signaling open timeout"}),this.onSignalConnectionStateChange(h.WsStatus.WSStatusTimeout),this.closeInternal(h.CloseCode.Normal,"reconnect"),r())}),4e3),this.websocket_.onopen=()=>{l.info(`[Signal] open success uid:${this.uid} channelId:${this.roomId}`),this.isOnceJoined=!0,clearTimeout(this.connectTimerId),clearTimeout(this.reconnectTimerId),this.initEventHandle(),this.lastReconnectTime=null,this.reconnectCnt=0,this.reconnectInterval=0,this.lockReconnect=!1,this.wsStatus=h.WsStatus.WsStatusConnected,this.startHeartBeart(),this.onSignalConnectionStateChange&&this.onSignalConnectionStateChange(h.WsStatus.WsStatusConnected),e()}}catch(e){l.error(`[Signal] Signaling open websocket fail ${e}`),clearTimeout(this.connectTimerId),r()}};i()}))}close(e){l.info("[Signal] close"),e||(this.observer=null),this.closeInternal(h.CloseCode.Normal,"")}closeInternal(e,t){if(l.info(`[Signal] closeInternal code:${e} reason:${t}`),clearTimeout(this.connectTimerId),clearTimeout(this.reconnectTimerId),this.websocket_){if(this.stopHeartBeart(),this.websocket_.onmessage=null,this.websocket_.onerror=null,this.websocket_.onclose=null,this.websocket_.onopen=null,this.websocket_.readyState!==WebSocket.CLOSED&&this.websocket_.readyState!==WebSocket.CLOSING)try{this.websocket_.close(e,t)}catch(e){l.error(`[Signal] websocket close error:${e}`)}this.websocket_=null,this.wsStatus=h.WsStatus.WsStausUnknown}this.waitResSignals=[]}initEventHandle(){this.websocket_&&(this.websocket_.onerror=async e=>{l.error(`[Signal] onerror channel error ${JSON.stringify(e)}`),this.wsStatus=h.WsStatus.WsStatusFailed,this.onSignalConnectionStateChange&&this.onSignalConnectionStateChange(this.wsStatus),await this.reconnect()}),this.websocket_&&(this.websocket_.onclose=async e=>{l.error(`[Signal] onclose channel close event:${e.code} reason:${e.reason}`),e.code===h.CloseCode.Nomal&&0===e.reason.length?this.wsStatus=h.WsStatus.WsStatusClosedByUser:e.code===h.CloseCode.Invaild?this.wsStatus=h.WsStatus.WSStatusConnectionRefuse:e.code===h.CloseCode.KickOut||(this.wsStatus=h.WsStatus.WSStatusAbnormal),l.error(`[Signal] onclose ${this.wsStatus}`),this.onSignalConnectionStateChange&&this.onSignalConnectionStateChange(this.wsStatus),this.wsStatus===h.WsStatus.WSStatusAbnormal&&(this.observer.isMediaConnectionActive()?this.reconnect():this.onReconnectFail())}),this.websocket_&&(this.websocket_.onmessage=e=>{var t=r(e.data);if(t){if(t.command===n.Command.kClientResponse||t.command===n.Command.kPong){let e=this.findIndexInWaitResSignals(t);if(-1!==e){let i=this.waitResSignals[e].invoke;if(this.waitResSignals.splice(e,1),t.command===n.Command.kClientResponse){if(i)return void this.emit(t.seq,t)}else if(t.command===n.Command.kPong)return void this.onPong(t)}}this.onMessage&&(l.debug(`[Signal] onmessage data:${e.data}`),this.onMessage(t))}else l.error("[Signal] onmessage Failed to parse message")})}async reconnect(){if(l.info("[Signal] reconnect"),this.stopHeartBeart(),!this.lockReconnect){this.lockReconnect=!0,this.closeInternal(h.CloseCode.Normal,"reconnect");try{await this.open(this.wssUrl_),d.report({eventId:s.SIGNAL_RECONNECT_REQ})}catch(e){l.info(`[Signal] reconnect error:${e}`),this.onReconnectFail(),d.report({eventId:s.SIGNAL_RECONNECT_REQ,result:c.FAIL,reason:`[Signal] reconnect error:${e}`})}}}onReconnectFail(){l.warning("[Signal] onReconnectFail"),this.reconnectCnt=0,this.lastReconnectTime=null,this.lockReconnect=!1,this.closeInternal(h.CloseCode.Normal,"reconnectFail"),this.onSignalConnectionStateChange&&(this.wsStatus=h.WsStatus.WSStatusReconnectFail,this.onSignalConnectionStateChange(this.wsStatus))}startHeartBeart(){this.wsStatus===h.WsStatus.WsStatusConnected?this.pingTimerId=setTimeout((()=>{let e=n.GenerateSignalPingData(this.appId,this.roomId,this.uid,this.sdkVersion);this.waitResSignals.push({data:e,invoke:!1});try{this.lastSendHeartbeatTime=Date.now(),this.websocket_.send(e.data),this.pongTimerId=setTimeout((()=>{l.error("[Signal] startHeartBeart heart beart timeout"),this.wsStatus=h.WsStatus.WSStatusTimeout,this.onSignalConnectionStateChange(this.wsStatus),this.reconnect()}),this.heartTimeout)}catch(e){l.error(`[Signal] send heart failed error:${e}`),this.websocket_&&this.reconnect()}}),this.pindInterval):l.warning("[Signal] startHeartBeart websocket is not connected")}stopHeartBeart(){this.pingTimerId&&clearTimeout(this.pingTimerId),this.pongTimerId&&clearTimeout(this.pongTimerId),this.pingTimerId=null,this.pongTimerId=null}onPong(e){let t=Date.now()-this.lastSendHeartbeatTime;this.rtt=this.rtt?.875*this.rtt+.125*t:t;let i=Math.min(Math.max(parseInt(10-(this.rtt-40)/560*10),0),10);this.delayScore=u[i],this.stopHeartBeart(),this.startHeartBeart()}send(e){if(this.websocket_&&this.wsStatus==h.WsStatus.WsStatusConnected){this.waitResSignals.push({data:e,invoke:!1});try{this.websocket_.send(e.data)}catch(e){l.error(`[Signal] Signaling send failed e:${e}`)}}}invoke(e){return null==this.websocket_||this.wsStatus!==h.WsStatus.WsStatusConnected?(l.error("[Signal] inoke websocket is null or has not connected"),Promise.reject(a.SIGNAL_NOT_CONNECTED)):(this.waitResSignals.push({data:e,invoke:!0}),new Promise(((t,i)=>{this.websocket_.send(e.data);let r=setTimeout((()=>{l.error("[Signal] invoke time out"),i(a.SIGNAL_INVOKE_TIMEOUT)}),3e3);this.once(e.seq,(e=>{clearTimeout(r),t(e)}))})))}findIndexInWaitResSignals(e){return void 0===e.seq?-1:this.waitResSignals.findIndex((t=>e.seq===t.data.seq))}reset(){this.isOnceJoined=!1}}h.WsStatus={WsStausUnknown:0,WsStatusConnected:1,WsStatusFailed:2,WsStatusClosedByServer:3,WsStatusClosedByUser:4,WSStatusTimeout:5,WSStatusAbnormal:6,WSStatusConnectionRefuse:7,WSStatusNoNetWork:8,WSStatusReconnectFail:9},h.CloseCode={Normal:1e3,GoingAway:1001,Abnomal:1006,KickOut:4e3,Invaild:4010},e.exports=h},2951:(e,t,i)=>{const{getLocaltime:r,getNetType:n,getAppInstanceId:o}=i(4891),a=i(3487),{trackStats:s}=i(220),c=i(2568),{browserInfo:u,isFirefox:l,isAndroid:d,isIOS:h}=i(5237),{version:p}=i(4147),{SourceType:f,ActionEventId:m,VCodeC:g,ACodeC:v,AdaptionChangeReason:A,qualityTransform:T,DebugParam:_}=i(9648),x=i(417),y={staging:"https://report-rtc.staging.kuaishou.com",prod:"https://report-rtc.kuaishou.com"},C=i(7247);function b(e){const t=e.filter((e=>!!e)).join("&&");return c(t).toUpperCase()}function E(e){var t=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i];return t}(e);return Math.round(t/e.length)}e.exports=new class{constructor(){this.env="prod",this.STAT_INTERVAL=2e3,this.REPORT_INTERVAL=1e4,this._init(),this.httpRequest=new a,document.addEventListener("visibilitychange",this.reportPageHidden.bind(this))}_init(){this.statsInterval=null,this.reportStatsInterval=null,this.msgs=[],this.localUser=null,this.remoteUsers=null,this.appId=void 0,this.uid=void 0,this.serverList=void 0,this.connectInfo=void 0,this.callId=void 0,this.networkType=void 0,this.ip=void 0,this.clientAddress=void 0,this.joinRequestType=0,this.joinDuration=0,this.lastDecodeVideoReceiverStats=new Map,this.uplinkNetworkQuality=1,this.downlinkNetworkQuality=1}startJoin(e){this.joinRequestType=e,this.startJoinTime=Date.now()}endJoin(e){this.joinDuration=e?Date.now()-this.startJoinTime:-1}setData(e){this.reportCilentBaseInfo(e),Object.assign(this,e)}start(){"staging"!==this.env&&(this.statsInterval||(this.statsInterval=setInterval((()=>{this.fetchStats()}),this.STAT_INTERVAL),this.reportStatsInterval=setInterval(this.send.bind(this),this.REPORT_INTERVAL)))}stop(){clearInterval(this.statsInterval),clearInterval(this.reportStatsInterval),this.send(),this._init()}reportPageHidden(){this.statsInterval&&this.report({eventId:m.SWITCH_FRONT_AND_BACK,param:{state:document.hidden?"background":"front"}})}reportNetType(e=n()){e==this.networkType&&this.networkType||(this.msgs.push({contentType:"NetworkInfo",netType:e,timestamp:Date.now()}),this.networkType&&this.report({eventId:m.NETWORK_TYPE_CHANGED,param:{network_type_info:e}}),this.networkType=e)}reportCilentBaseInfo(e){if(e.ip&&this.ip!==e.ip){const t=e.ip.split(":");this.clientAddress=t[0],this.report({eventId:m.CLIENT_ADDRESS,param:{client_ip:t[0],client_port:t[1]}})}if(e.callId&&(this.report({eventId:m.SERVER_ADDRESS,param:{server_ip:e.serverAddress}}),!this.callId)){const{name:t,version:i,os:r}=u,n={contentType:"ClientBaseInfo",sdkVer:p,sdkVerNum:Number(p.replace(/\./g,"")),platform:"WebRTC",deviceInfo:`${r} ${t}/${i}`,osInfo:r,userAgent:navigator.userAgent,serverList:e.serverList,connectInfo:e.connectInfo,ipAddress:e.ip,timestamp:Date.now()};this.report({eventId:m.NONE,param:n})}}fetchStats(){const e=Date.now(),t=[],{name:i,version:r,os:n}=u;t.push({contentType:"ClientBaseInfo",sdkVer:p,platform:"WebRTC",deviceInfo:`${n} ${i}/${r}`,osInfo:n,userAgent:navigator.userAgent,serverList:this.serverList,connectInfo:this.connectInfo,timestamp:e});let o=navigator.connection&&navigator.connection.rtt||0;t.push({contentType:"NetworkQualityInfo",srtt:o,sendUserId:this.uid,timestamp:e});let a=0!==this.joinDuration?this.joinRequestType:0;t.push({contentType:"ComposeData",timestamp:e,joinRequestType:a,rejoinDuration:2==a?this.joinDuration:0,joinDuration:1==a?this.joinDuration:0}),0!==this.joinDuration&&(this.joinDuration=0),(h()||d())&&this.reportNetType(),this.msgs.push(...JSON.parse(JSON.stringify(t))),this.fetchUsersStats()}async fetchUsersStats(){const e=Date.now();if(this.localUser){let t=[];for(const i of this.localUser.publishInfos.values()){let r={audio:Boolean(i.audioTrack),video:Boolean(i.videoTrack)};if(i.sourceType===f.PEOPLE){if(i.peer){const t=await this.fetchLocalUserStats(i,"lastStats",r);t&&(t.ts=e,i.enableAudio[0]&&this.reportLocalAudioStats(t),i.enableVideo[0]&&this.reportLocalVideoStats(t,0,1),s.setSendMediaTrack(i,t,0,1))}if(i.lowStreamPeer){const t=await this.fetchLocalUserStats(i,"lowLastStats",r);t&&(t.ts=e,i.enableVideo[0]&&this.reportLocalVideoStats(t,0,0),s.setSendMediaTrack(i,t,0,0))}}else{const t=await this.fetchLocalUserStats(i,"lastStats",r);t&&(t.ts=e,i.enableAudio[0]&&this.reportLocalAudioStats(t),i.enableVideo[0]&&this.reportLocalVideoStats(t,1,1),s.setSendMediaTrack(i,t,1,1))}i.uplinkNetworkQuality&&t.push(i.uplinkNetworkQuality)}t.length&&(this.uplinkNetworkQuality=E(t),C.debug(`[Stats] average uplink network quality:${this.uplinkNetworkQuality} len:${t.length}`))}let t=[];if(this.remoteUsers)for(const i of this.remoteUsers.values())for(let r of i.subscribeInfos.values()){r._isFirstVideoDecoded=!1;const n=await this.fetchRemoteUsersStats(r,i.user);if(n){n.ts=e;let o=null;r.sourceType===f.PEOPLE&&"videoTrack"in i.user&&(o=i.user.videoTrack),r.sourceType===f.CONTENT&&"contentVideoTrack"in i.user&&(o=i.user.contentVideoTrack),o&&o.timeUpdatedCount<10&&(n.VrxMediaInfo.renderBlock2NdDuration=0),o&&o.timeUpdatedCount>=10&&(n.VrxMediaInfo.renderBlock2NdDuration=o.freezeTimeCounterList.length?o.freezeTimeCounterList.shift():this.STAT_INTERVAL),r.enableAudio[0]&&this.reportRemoteAudioStats(n),r.enableVideo[0]&&this.reportRemoteVideoStats(n,Number(r.sourceType===f.CONTENT)),s.setRecMediaTrack(i,r,n),r.downlinkNetworkQuality&&t.push(r.downlinkNetworkQuality)}}t.length&&(this.downlinkNetworkQuality=E(t),C.debug(`[Stats] average downlink network quality:${this.downlinkNetworkQuality} len:${t.length}`))}getCodecFromCodecStats(e,t){var i=e&&(e=e.match(/\/(.*)$/))&&e[1]?e[1]:"none";return"video"===t?g[i.toUpperCase()]:v[i.toUpperCase()]}calcLossRate(e,t,i){let r="send"===i?e.packetsSent-t.packetsSent:e.packetsReceived-t.packetsReceived,n=e.packetsLost-t.packetsLost;return Number.isNaN(r)||Number.isNaN(n)||0>=r||0>=n?0:Math.round(1e3*n/(r+n))}calcFreezeRate(e,t,i,r){let n=l()?2950:2250,o=this.lastDecodeVideoReceiverStats.get(e.ssrc);if(o){let e=o.stats;i.framesDecodeFreezeTime=e.framesDecodeFreezeTime,i.framesDecodeCount>0?i.framesDecodeInterval>=n&&(i.framesDecodeFreezeTime+=i.framesDecodeInterval):i.framesDecodeInterval=0}else i.framesDecodeFreezeTime=0;this.lastDecodeVideoReceiverStats.set(e.ssrc,{stats:{...i},lts:e.timeStamp})}calcData(e,t,i){return Math.round((e-t)/i)}reportLocalAudioStats(e){this.msgs.push({contentType:"AtxMetaData",timestamp:e.ts,...e.AtxMetaData}),this.msgs.push({contentType:"AtxMediaInfo",timestamp:e.ts,...e.AtxMediaInfo})}reportLocalVideoStats(e,t,i){this.msgs.push({contentType:"VtxMetaData",timestamp:e.ts,sourceType:t,simulcastId:i,...e.VtxMetaData}),this.msgs.push({contentType:"VtxMediaInfo",timestamp:e.ts,sourceType:t,simulcastId:i,...e.VtxMediaInfo})}reportRemoteAudioStats(e){this.msgs.push({contentType:"ArxMetaData",sendUserId:e.sendUserId,timestamp:e.ts,...e.ArxMetaData}),this.msgs.push({contentType:"ArxMediaInfo",sendUserId:e.sendUserId,timestamp:e.ts,...e.ArxMediaInfo})}reportRemoteVideoStats(e,t){this.msgs.push({contentType:"VrxMetaData",sendUserId:e.sendUserId,timestamp:e.ts,sourceType:t,...e.VrxMetaData}),this.msgs.push({contentType:"VrxMediaInfo",sendUserId:e.sendUserId,timestamp:e.ts,sourceType:t,...e.VrxMediaInfo})}async fetchLocalUserStats(e,t,i){if(!e.publish[0]&&"lastStats"===t)return void delete e[t];if(!e.publishLowStream[0]&&"lowLastStats"===t)return void delete e[t];let r;if(r="lastStats"===t?await e.peer.pc.getStats():await e.lowStreamPeer.pc.getStats(),!e[t])return e[t]=r,void(e._resolutionList=[]);let n={AtxMetaData:{},AtxMediaInfo:{},VtxMetaData:{},VtxMediaInfo:{}};const{AtxMetaData:o,AtxMediaInfo:a,VtxMetaData:s,VtxMediaInfo:c}=n,u=e[t];return r.forEach((l=>{switch(l.type){case"outbound-rtp":{const d=u.get(l.id);if(!d)return void(e[t]=r);n.timestamp=l.timestamp;const h=(l.timestamp-d.timestamp)/1e3;let p=Math.ceil(8*(l.bytesSent-d.bytesSent)/h/1e3),f=this.calcData(l.packetsSent,d.packetsSent,h);p=Math.max(0,p),f=Math.max(0,f);const m=l.bytesSent,g=Math.round(8*(l.retransmittedBytesSent-d.retransmittedBytesSent)/h/1e3)||0,T=this.calcData(l.retransmittedPacketsSent,d.retransmittedPacketsSent,h)||0;let _=l.retransmittedPacketsSent,y=T,C=Math.round(1e3*T/f);if("video"===l.mediaType&&i.video){s.flowId=l.ssrc;const t=Math.round(10*(l.framesSent-d.framesSent)/h);if(c.sendFpsX10=t,c.inputFpsX10=t,l.mediaSourceId){const{height:e,width:t,framesPerSecond:i}=r.get(l.mediaSourceId);i&&void 0!==i&&(s.inputHeight=e,s.inputWidth=t,c.sendFpsX10=10*i,c.inputFpsX10=10*i)}const i=e.videoTrack.mediaTrack.getSettings();if(!s.inputHeight&&!s.inputHeight&&e.videoTrack&&e.videoTrack.mediaTrack&&(s.inputHeight=i.height,s.inputWidth=i.width),l.trackId&&(s.encHeight=l.frameHeight,s.encWidth=l.frameWidth),s.encHeight||s.encWidth||(s.encHeight=i.height||0,s.encWidth=i.width||0),l.framerateMean&&(c.sendFpsX10=Math.round(10*l.framerateMean)),l.codecId){const e=r.get(l.codecId);s.encodingStreamType=this.getCodecFromCodecStats(e.mimeType,"video")}if(c.flowId=l.ssrc,c.sendKbps=p,c.encTargetKbps=e.videoTrack&&e.videoTrack.config.encoderConfig.bitrateMax||0,c.sendPktsCount=f,c.sendPktsLostCount=y,c.totalSendPktsCount=l.packetsSent,c.totalSendPktsLostCount=_,c.totalSendBytes=m,c.pliCnt=l.pliCount-d.pliCount,c.firCnt=l.firCount-d.firCount,c.nackCnt=l.nackCount-d.nackCount,c.pktsLostRate=C,c.duration=Math.round(l.timestamp-d.timestamp),c.retransmittedKbps=g,c.retransmittedPacketsSent=T,c.adaptionChangeReason=l.qualityLimitationReason&&A[l.qualityLimitationReason.toUpperCase()],c.encTs=Math.round(1e3*(l.totalEncodeTime-d.totalEncodeTime)/(l.framesEncoded-d.framesEncoded)),s.inputHeight){const t=`${s.inputWidth}*${s.inputHeight}`;if(e._resolutionList.length){t!==e._resolutionList[e._resolutionList.length-1]&&e._resolutionList.push(t)}else e._resolutionList.push(t);c.resolutionChangeCnt=e._resolutionList.length-1}}if("audio"===l.mediaType&&i.audio){if(o.flowId=l.ssrc,l.codecId){const e=r.get(l.codecId);o.encodingStreamType=this.getCodecFromCodecStats(e.mimeType,"audio"),o.encChannels=e.channels,o.inputChannels=e.channels,o.encSampleRate=e.clockRate,o.inputSampleRate=e.clockRate}if(!o.encChannels||!o.encSampleRate)try{const t=x.getAudioParam(e.peer.pc.currentRemoteDescription.sdp);t&&t.length&&!o.encChannels&&(o.encodingStreamType=v[t[0].codingStreamType.toUpperCase()],o.encChannels=t[0].channels,o.inputChannels=t[0].channels),t&&t.length&&!o.encSampleRate&&(o.encodingStreamType=v[t[0].codingStreamType.toUpperCase()],o.encSampleRate=t[0].clockRate,o.inputSampleRate=t[0].clockRate)}catch(e){}if(l.mediaSourceId){const e=r.get(l.mediaSourceId);o.captureVolume=e.audioLevel,o.echoReturnLoss=e.echoReturnLoss||0,o.echoReturnLossEnhancement=Math.round(1e3*e.echoReturnLossEnhancement)||0}o.captureVolume=Math.round(32767*(o.captureVolume||e.audioTrack._source.getAccurateVolumeLevel())),a.flowId=l.ssrc,a.sendKbps=p,a.sendPktsCount=f,a.totalSendPktsCount=l.packetsSent,a.totalSendBytes=m,a.duration=Math.round(l.timestamp-d.timestamp),a.pktsLostRate=C,a.retransmittedKbps=g,a.retransmittedPacketsSent=T,a.sendPktsLostCount=y}break}case"local-candidate":if("prflx"===l.candidateType&&(l.ip||l.address)==this.clientAddress&&!d()&&!h()){let e=l.networkType?l.networkType.toUpperCase():"WIFI";this.reportNetType(e)}break;case"candidate-pair":l.nominated&&(c.targetBw=l.availableOutgoingBitrate);break;case"transport":{const e=r.get(l.selectedCandidatePairId);if(e){c.sendBandwidth=Math.round(e.availableOutgoingBitrate/1e3)||0;const t=1e3*e.currentRoundTripTime;c.rttMs=t,a.rttMs=t}break}}})),e[t]=r,"lastStats"==t&&this.calcUplinkNetworkQuality(e,n),n}async fetchRemoteUsersStats(e,t){if(!e.subscribe[0])return void delete e.lastStats;const i=await e.peer.pc.getStats();if(!e.lastStats)return void(e.lastStats=i);const r={ArxMetaData:{},ArxMediaInfo:{},VrxMetaData:{},VrxMediaInfo:{},sendUserId:t.uid},n={};for(const[e,t]of i)n[e]=t;const{ArxMetaData:o,ArxMediaInfo:a,VrxMetaData:s,VrxMediaInfo:c}=r,u=e.lastStats;return i.forEach((n=>{switch(n.type){case"candidate-pair":n.nominated&&(c.recvDelay=n.currentRoundTripTime&&1e3*n.currentRoundTripTime||0,a.recvDelay=n.currentRoundTripTime&&1e3*n.currentRoundTripTime||0);break;case"inbound-rtp":{const l=u.get(n.id);if(!l)return void(e.lastStats=i);r.timestamp=n.timestamp;const d=(n.timestamp-l.timestamp)/1e3,h=Math.round(8*(n.bytesReceived-l.bytesReceived)/d/1e3),p=this.calcData(n.packetsReceived,l.packetsReceived,d),f=Math.round(8*n.bytesReceived/1e3),m=this.calcData(n.packetsLost,l.packetsLost,d),g=Math.round(1e3*(n.jitterBufferDelay-l.jitterBufferDelay)/(n.jitterBufferEmittedCount-l.jitterBufferEmittedCount))||0,A=this.calcLossRate(n,l,"recv"),T=this.calcData(n.nackCount,l.nackCount,d);if("video"===n.mediaType&&(t.videoTrack||t.contentVideoTrack)){if(s.flowId=n.ssrc,n.codecId){const{mimeType:e}=i.get(n.codecId);s.encodingStreamType=this.getCodecFromCodecStats(e,"video")}n.trackId&&(c.recvFpsX10=Math.round(10*(n.framesReceived-l.framesReceived)/d),c.decFpsX10=Math.round(10*(n.framesDecoded-l.framesDecoded)/d),c.renderFpsX10=Math.round(10*(n.framesDecoded-l.framesDecoded)/d),s.decHeight=n.frameHeight,s.decWidth=n.frameWidth);const r=t.videoTrack||t.contentVideoTrack||void 0;if(!s.decHeight&&!s.decWidth&&r){const e=r.mediaTrack.getSettings();s.decHeight=e.height||0,s.decWidth=e.width||0}n.framerateMean&&(c.recvFpsX10=Math.round(10*n.framerateMean)),c.flowId=n.ssrc,c.recvKbps=h,c.compositeIdrFrames=n.keyFramesDecoded,c.recvPktsCount=p,c.recvPktsLostCount=T,c.totalRecvPktsCount=n.packetsReceived,c.totalRecvPktsLostCount=n.nackCount,c.totalRecvBytes=f,c.duration=Math.round(n.timestamp-l.timestamp),c.frameLostCnt=this.calcData(n.framesDropped,l.framesDropped,d),c.pliReqCnt=this.calcData(n.pliCount,l.pliCount,d),c.nackReqCnt=this.calcData(n.nackCount,l.nackCount,d),c.pliReqAllCnt=n.pliCount,c.nackReqAllCnt=n.nackCount,c.pktsLostRate=A,c.jitterBufferMs=g,c.framesDecodeInterval=Math.round(n.timestamp-l.timestamp),c.decodeMs=Math.round(1e3*(n.totalDecodeTime-l.totalDecodeTime)/d),c.jitterMs=Math.round(1e3*n.jitter),c.framesDecoded=n.framesDecoded,c.framesDecodeCount=this.calcData(n.framesDecoded,l.framesDecoded,d),this.calcFreezeRate(n,l,c,e)}if("audio"===n.mediaType&&(t.audioTrack||t.contentAudioTrack)){if(o.flowId=n.ssrc,n.trackId){const{audioLevel:e=0}=i.get(n.trackId);o.playVolume=Math.round(32767*e)}if(!o.playVolume&&(t.audioTrack||t.contentAudioTrack)){const e=t.audioTrack||t.contentAudioTrack;o.playVolume=Math.round(32767*e._source.getAccurateVolumeLevel())}if(n.codecId){const e=i.get(n.codecId);o.renderChannels=e.channels,o.renderSampleRate=e.clockRate,o.encodingStreamType=this.getCodecFromCodecStats(e.mimeType,"audio"),o.decChannels=e.channels,o.decSampleRate=e.clockRate}if(!o.renderChannels||!o.renderSampleRate)try{const t=x.getAudioParam(e.peer.pc.currentRemoteDescription.sdp);t&&t.length&&!o.renderChannels&&(o.encodingStreamType=v[t[0].codingStreamType.toUpperCase()],o.renderChannels=t[0].channels,o.decChannels=t[0].channels),t&&t.length&&!o.renderSampleRate&&(o.encodingStreamType=v[t[0].codingStreamType.toUpperCase()],o.renderSampleRate=t[0].clockRate,o.decSampleRate=t[0].clockRate)}catch(e){C.error(`[Stats] report inbound audio msg fail with error:${e}`)}a.flowId=n.ssrc,a.recvKbps=h,a.recvPktsCount=p,a.recvPktsLostCount=m,a.totalRecvPktsCount=n.packetsReceived,a.totalRecvPktsLostCount=n.packetsLost,a.totalRecvBytes=f,a.duration=Math.round(n.timestamp-l.timestamp),a.pktsLostRate=A,a.jitterBufferMs=g,a.accelerateRate=n.removedSamplesForAcceleration/n.totalSamplesReceived,a.jitterMs=1e3*n.jitter,a.concealedSamples=this.calcData(n.concealedSamples,l.concealedSamples,d),a.silentConcealedSamples=this.calcData(n.silentConcealedSamples,l.silentConcealedSamples,d),a.insertedSamplesForDeceleration=this.calcData(n.insertedSamplesForDeceleration,l.insertedSamplesForDeceleration,d),a.removedSamplesForAcceleration=this.calcData(n.removedSamplesForAcceleration,l.removedSamplesForAcceleration,d);let r=1920;n.totalSamplesDuration&&n.totalSamplesReceived&&(r=n.totalSamplesReceived/n.totalSamplesDuration/50,a.receivedFrames=Math.round(n.totalSamplesReceived/r/d)),n.concealedSamples?a.droppedFrames=Math.round(n.concealedSamples/r):a.droppedFrames=n.packetsLost}break}}})),e.lastStats=i,this.calcDownlinkNetworkQuality(e,r),r}calcDownlinkNetworkQuality(e,t){const i={lossScore:{max:_.downlinkPacketLossMax?_.downlinkPacketLossMax:800,min:_.downlinkPacketLossMin?_.downlinkPacketLossMin:150,value:10},delayScore:{max:_.downlinkRttMax?_.downlinkRttMax:600,min:_.downlinkRttMin?_.downlinkRttMin:40,value:10},maxScore:10};let r=void 0!==t.VrxMediaInfo.pktsLostRate?t.VrxMediaInfo.pktsLostRate:void 0;if(void 0!==t.ArxMediaInfo.pktsLostRate&&(r=void 0!==r?Math.max(r,t.ArxMediaInfo.pktsLostRate):t.ArxMediaInfo.pktsLostRate),void 0!==r&&!Number.isNaN(r)){let t=e.packetLostRate,n=void 0!==t?.125*r+.875*t:r;e.packetLostRate=n;let o=i.maxScore-(n-i.lossScore.min)*i.maxScore/(i.lossScore.max-i.lossScore.min);i.lossScore.value=Math.max(Math.min(o,i.maxScore),0)}if(null!=t.VrxMediaInfo.rttMs&&!Number.isNaN(t.VrxMediaInfo.rttMs)){let r=e.rtt,n=void 0!==r?.125*t.VrxMediaInfo.rttMs+.875*r:t.VrxMediaInfo.rttMs;e.rtt=n;let o=i.maxScore-(n-i.delayScore.min)*i.maxScore/(i.delayScore.max-i.delayScore.min);i.delayScore.value=Math.max(Math.min(o,i.maxScore),0)}e.downlinkNetworkQuality=this.calcNetworkQuality(i.lossScore.value,i.delayScore.value),C.debug(`[Stats] rx score:${e.downlinkNetworkQuality} lossScore:${i.lossScore.value} delayScore:${i.delayScore.value}`)}calcUplinkNetworkQuality(e,t){const i={lossScore:{max:_.uplinkPacketLossMax?_.uplinkPacketLossMax:800,min:_.uplinkPacketLossMin?_.uplinkPacketLossMin:150,value:10},delayScore:{max:_.uplinkRttMax?_.uplinkRttMax:600,min:_.uplinkRttMin?_.uplinkRttMin:40,value:10},bwScore:{max:1e3*((e.videoTrack&&e.videoTrack.config.encoderConfig.bitrateMax||0)+34),min:1e3*((e.videoTrack&&e.videoTrack.config.encoderConfig.bitrateMin||0)+34),value:void 0},maxScore:10};let r=void 0!==t.VtxMediaInfo.pktsLostRate?t.VtxMediaInfo.pktsLostRate:void 0;if(void 0!==t.AtxMediaInfo.pktsLostRate&&(r=void 0!==r?Math.max(r,t.AtxMediaInfo.pktsLostRate):t.AtxMediaInfo.pktsLostRate),void 0!==r&&!Number.isNaN(r)){let t=e.packetLostRate,n=void 0!==t?.125*r+.875*t:r;e.packetLostRate=n;let o=i.maxScore-(n-i.lossScore.min)*i.maxScore/(i.lossScore.max-i.lossScore.min);i.lossScore.value=Math.max(Math.min(o,i.maxScore),0)}if(void 0!==t.VtxMediaInfo.rttMs&&!Number.isNaN(t.VtxMediaInfo.rttMs)){let r=e.rtt,n=void 0!==r?.125*t.VtxMediaInfo.rttMs+.875*r:t.VtxMediaInfo.rttMs;e.rtt=n;let o=i.maxScore-(n-i.delayScore.min)*i.maxScore/(i.delayScore.max-i.delayScore.min);i.delayScore.value=Math.max(Math.min(o,i.maxScore),0)}if(!Number.isNaN(t.VtxMediaInfo.targetBw)&&i.bwScore.max>i.bwScore.min&&t.VtxMediaInfo.sendKbps&&t.VtxMediaInfo.sendKbps>=50){let e=(t.VtxMediaInfo.targetBw-i.bwScore.min)*i.maxScore/(i.bwScore.max-i.bwScore.min);i.bwScore.value=Math.min(Math.max(e,0),i.maxScore)}e.uplinkNetworkQuality=this.calcNetworkQuality(i.lossScore.value,i.delayScore.value,i.bwScore.value),C.debug(`[Stats] tx score:${e.uplinkNetworkQuality} lossScore:${i.lossScore.value} delayScore:${i.delayScore.value} bwScore:${i.bwScore.value}`)}calcNetworkQuality(e,t,i){let r=0,n=0;return Number.isNaN(e)||(r++,n+=e),Number.isNaN(t)||(r++,n+=t),void 0===i||Number.isNaN(i)||(r++,n+=i),r?T[parseInt(n/r)]:T[0]}report(e){if("staging"!==this.env){if(e.param){const t=e.param.mediaTrack;if(t){const{contentHint:i,enabled:r,id:n,kind:o,label:a,muted:s}=t,c={contentHint:i,enabled:r,id:n,kind:o,label:a,muted:s};e.param.mediaTrack=c}e.param=JSON.stringify(e.param)}this.msgs.push({contentType:"ActionEvent",result:0,reason:"",timestamp:Date.now(),timeConsuming:0,...e})}}send(){if(!1===navigator.onLine)return;if(!this.callId)return;const e=Date.now(),t=this.msgs.map((t=>(["RuntimeInfo","NetworkInfo","ActionEvent","ComposeData"].includes(t.contentType)&&Object.assign(t,{channelIds:JSON.stringify([this.channelId]),callIds:JSON.stringify([this.callId])}),{clientTime:e,msgId:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),msgBody:{channelId:this.channelId,callId:this.callId,...t}}))),i=this.msgs.length,n=b([this.uid,this.channelId]),s=b(["i!believe@kwai#laotie",this.appId,this.uid,n,e,"wefd8g7345kj09dh345r8yn2k3598eu945rh3489"]),c=Number(p.replace(/\./g,"")),u=`${y[this.env]}/report_open?app=${this.appId}&user=${this.uid}&device=${n}&timestamp=${e}&sign=${s}&instanceId=${o()}`;this.httpRequest.post(u,{msgs:t,sdkVerNum:c,platform:"WebRTC"},a.ContentType.Json).then((e=>{this.msgs.splice(0,i)})).catch((e=>{console.log(`[${r()} report data fail:${e}`)}))}}},3405:(e,t,i)=>{const r=i(485),n=i(5547),o=i(201),a=i(4982),{AudioSource:s}=i(8567),{isAndroid:c,isIOS:u}=i(5237),l=i(2951),d=i(7247),{sendAudioStats:h,sendVideoStats:p,recAudioStats:f,recVideoStats:m}=i(220),{ClientError:g,SourceType:v,DeviceKind:A,DeviceState:T,DeviceEvent:_,MediaType:x,TrackEvent:y,TrackInternalEvent:C,AudioEvent:b,SourceEvent:E,ActionEventId:S,VideoProfile:I,TrackState:w,MediaElementEvent:R}=i(9648),k=i(297),P={beauty:.5,brightness:.5,ruddy:.5};function D(e,t){let i=`${e}_${t}`;if("default"!==e)return o.deviceInfoMap.has(i)?e:void 0;{let e=o.deviceInfoMap.get(i);if(void 0===e)return;for(let[r,n]of o.deviceInfoMap.entries())if(r!==i&&n.device.kind===t&&!r.startsWith("communications")&&n.device.groupId===e.device.groupId)return n.device.deviceId}}function O(e,t){for(let[i,r]of o.deviceInfoMap.entries())if(r.device.label===e&&r.device.kind===t)return r.device.deviceId}const L="ended",M="mute",N="unmute";class U extends r{constructor(e,t){super(),this.readyPlay=!1,this.isPlaying=!1,this.mediaTrack=e,this._originTrack=e,this.trackMediaType=e.kind,this.trackId=this.mediaTrack.id,this.view=null,this.videoElement=null,this.audioElement=null,this.container=null,this.enable=!0,this.playConfig=null,this.handleTrackEvent=this.handleTrackEvent_.bind(this),this.handleElementEvent=this.handleElementEvent_.bind(this),this.mediaTrack&&this.addTrackEventListener(),this.sourceType=void 0===t?v.PEOPLE:t}getTrackId(){return this.trackId}getMediaStreamTrack(){return this.mediaTrack}getSourceType(){return this.sourceType}getMediaType(){return this.trackMediaType}play(e,t){this.view&&this.stop(),d.info("[Track] play video"),this.playConfig=t,this.container=document.createElement("div"),this.container.style="width: 100%; height: 100%; position: relative; overflow: hidden; background-color: black;",this.videoElement=document.createElement("video"),this.videoElement.style="width: 100%; height: 100%; position: absolute; left: 0px; top: 0px;",this.videoElement.muted=!0,this.videoElement.setAttribute("id",this.mediaTrack.id),this.videoElement.setAttribute("playsinline","playsinline"),this.videoElement.setAttribute("autoplay","autoplay"),t&&(t.mirror&&(this.videoElement.style.transform="rotateY(180deg)"),t.fit?this.videoElement.style.objectFit=t.fit:this.videoElement.style.objectFit="cover",t.controls&&this.videoElement.setAttribute("controls","controls")),this.container.appendChild(this.videoElement),this.view=e,this.view.appendChild(this.container),this.addElementListener(this.videoElement),this.videoElement.srcObject=new MediaStream([this.mediaTrack]),this.readyPlay=!0}stop(){d.info(`[Track] type:${this.trackMediaType} stop play:${this.readyPlay}`),this.readyPlay?(this.view&&(this.container&&(this.videoElement&&(this.videoElement.pause(),this.container.removeChild(this.videoElement)),this.view.removeChild(this.container)),this.removeElementListener(this.videoElement),this.videoElement=null,this.container=null,this.view=null),this.audioElement&&(this.audioElement.pause(),this.removeElementListener(this.audioElement),this.audioElement=null),this.isPlaying=!1,this.readyPlay=!1):d.debug(`[Track] ${this.trackMediaType} has been stoped`)}addElementListener(e){e.addEventListener(R.CANPLAY,this.handleElementEvent),e.addEventListener(R.PLAYING,this.handleElementEvent),e.addEventListener(R.ENDED,this.handleElementEvent),e.addEventListener(R.PAUSE,this.handleElementEvent),e.addEventListener(R.RESIZE,this.handleElementEvent)}removeElementListener(e){e.removeEventListener(R.PLAYING,this.handleElementEvent),e.removeEventListener(R.ENDED,this.handleElementEvent),e.removeEventListener(R.PAUSE,this.handleElementEvent),e.removeEventListener(R.CANPLAY,this.handleElementEvent),e.removeEventListener(R.RESIZE,this.handleElementEvent)}addTrackEventListener(){d.debug(`[Track] addTrackEventListener track:${this.mediaTrack.id} kind:${this.mediaTrack.kind}`),this._originTrack.addEventListener(L,this.handleTrackEvent),this._originTrack.addEventListener(M,this.handleTrackEvent),this._originTrack.addEventListener(N,this.handleTrackEvent)}removeTrackEventListener(){d.debug(`[Track] removeTrackEventListener track:${this.mediaTrack.id} kind:${this.mediaTrack.kind}`),this._originTrack.removeEventListener(L,this.handleTrackEvent),this._originTrack.removeEventListener(M,this.handleTrackEvent),this._originTrack.removeEventListener(N,this.handleTrackEvent)}}class B extends U{constructor(e,t){super(e,t),l.report({eventId:S.CREATE_MEDIA_STREAM,param:{mediaTrack:e}}),this._state=w.NONE,this._enableMutex=new k(`localTrack_${this.trackMediaType}_${this.sourceType}`)}async setEnabled(e){await this._enableMutex.lock();try{if(this.enable!==e){this.enable=e,this.mediaTrack.enabled=e;let t=e?C.ENABLE_TRACK:C.DISABLE_TRACK;await this.emitEvent(t,this.mediaTrack,this.trackMediaType,this.sourceType)}}catch(e){throw this._enableMutex.unlock(),e}this._enableMutex.unlock()}getTrackLabel(){if(this.mediaTrack)return this.mediaTrack.label}close(){d.info(`[LocalTrack] type:${this.trackMediaType} close play:${this.readyPlay}`),l.report({eventId:S.CLOSE_MEDIA_STREAM,param:{mediaTrack:this.mediaTrack}}),this.mediaTrack||d.warning(`[LocalTrack] type:${this.trackMediaType} has been closed`),this.removeTrackEventListener(),this.mediaTrack.stop(),super.stop()}stop(){l.report({eventId:S.STOP_STREAM,param:{mediaTrack:this.mediaTrack}}),super.stop()}async emitEvent(e,...t){try{await this.asyncEmit(e,...t)}catch(t){throw d.error(`[LocalTrack] emitEvent asyncEmit event:${e} failed because of error:${t}`),t}}getStats(){const e="audio"===this.mediaTrack.kind?h:p;return this._publish&&this._stats||e}handleElementEvent_(e){switch(e.type){case R.CANPLAY:if(this.videoElement){let e=this.mediaTrack?this.mediaTrack.kind:void 0;d.info(`[LocalTrack] can start play mediaType:${e} trackId:${this.getTrackId()}`),this.videoElement.play(),this.isPlaying=!0}break;case R.PLAYING:d.info(`[LocalTrack] track:${this.mediaTrack.id} kind:${this.mediaTrack.kind} is starting playing`),this._state=w.PLAYING,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"playing"});break;case R.ENDED:d.info(`[LocalTrack] element track:${this.mediaTrack.id} kind:${this.mediaTrack.kind} is ended`),this._state!==w.STOPPED&&(this._state=w.STOPPED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"ended"}));break;case R.PAUSE:d.info(`[LocalTrack] track:${this.mediaTrack.id} kind:${this.mediaTrack.kind} is paused`),this._state=w.PAUSED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"pause"});break;case R.RESIZE:this.videoElement&&d.info(`[LocalTrack] video size changed to ${this.videoElement.videoWidth}x${this.videoElement.videoHeight}`)}}handleTrackEvent_(e){switch(e.type){case L:d.info(`[LocalTrack] track:${this.mediaTrack.id} kind:${this.mediaTrack.kind} is ended`),this.emit(y.TRACK_ENDED,this.trackMediaType,this.sourceType,this.trackId),this._state!==w.STOPPED&&(this._state=w.STOPPED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"ended"}));break;case M:d.info(`[LocalTrack] track:${this.mediaTrack.id} kind:${this.mediaTrack.kind} is muted`),this._state!==w.PAUSED&&(this._state=w.PAUSED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"mute"}));break;case N:d.info(`[LocalTrack] track:${this.mediaTrack.id} kind:${this.mediaTrack.kind} is unmuted`),this._state===w.PAUSED&&(this._state=w.PLAYING,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"unmute"}))}}}class F extends B{constructor(e,t){super(e,t.sourceType),this._enableBeauty=!1,this._beautyConfig=void 0,this.config=t,this._MayUpdateBitrateConfig(),t.optimizationMode&&this.setOptimizationMode(t.optimizationMode).then((()=>{d.debug(`[LocalVideoTrack] constructor set optimization mode:${t.optimizationMode} success`)})).catch((e=>{d.error(`[LocalVideoTrack] constructor set optimization mode:${t.optimizationMode} failed`)}))}_MayUpdateBitrateConfig(){if((!this.config.encoderConfig.minBitrate||!this.config.encoderConfig.maxBitrate)&&this._originTrack){d.debug("[LocalVideoTrack] MayUpdateBitrateConfig");let e=this._originTrack.getSettings(),t=0,i=0,r=!1,n=e.width*e.height;if(this.sourceType===v.PEOPLE){for(let[o,a]of Object.entries(I)){if(r&&a.width*a.height>n)break;if(a.width*a.height>=n&&(r=!0,a.bitrateMin&&(t=Math.max(a.bitrateMin,t)),a.bitrateMax&&(i=Math.max(a.bitrateMax,i)),a.frameRate==e.frameRate))break}r&&(this.config.encoderConfig.bitrateMin||(this.config.encoderConfig.bitrateMin=t),this.config.encoderConfig.bitrateMax||(this.config.encoderConfig.bitrateMax=i))}else this.config.encoderConfig.bitrateMin||(this.config.encoderConfig.bitrateMin=100),this.config.encoderConfig.bitrateMax||(this.config.encoderConfig.bitrateMax=4e3)}}play(e,t){d.info("[LocalVideoTrack] play"),super.play(e,t)}close(){this._originTrack&&this._originTrack.stop(),super.close()}setOptimizationMode(e){return d.info(`[LocalVideoTrack] setOptimizationMode mode:${e}`),!this.mediaTrack||"balanced"!==e&&"motion"!==e&&"detail"!==e?(d.debug(`[LocalVideoTrack] setOptimizationMode set optimization mode:${e} failed`),Promise.reject(g.SET_OPTIMIZATION_MODE_FAILED)):"contentHint"in this.mediaTrack?"motion"!==e&&"detail"!==e||(this.mediaTrack.contentHint=e,this.mediaTrack.contentHint===e)?this.emitEvent(C.SET_OPTIMIZATION_MODE,this.mediaTrack,this.trackMediaType,this.sourceType,e):(d.warning(`[LocalVideoTrack] setOptimizationMode set optimization mode:${e} failed`),Promise.reject(g.SET_OPTIMIZATION_MODE_FAILED)):(d.warning("[LocalVideoTrack] setOptimizationMode contentHint attribute not supported"),Promise.reject(g.NOT_SUPPORTED))}async clone(e){d.info("[LocalVideoTrack] clone");let t={};(e=e||this.config.encoderConfig).width&&e.height&&(t.width=e.width,t.height=e.height),e.frameRate&&(t.frameRate=e.frameRate);let i={encoderConfig:t};this.config.deviceId&&(i.deviceId=this.config.deviceId);try{if("firefox"===n.browserDetails.browser)return d.info("[Track] clone track by recreating camera video"),await o.createCameraVideoTrack(i);{let e=this.mediaTrack.clone();return navigator.mediaDevices.getSupportedConstraints().aspectRatio&&(t=Object.assign(t,{aspectRatio:t.width/t.height})),await e.applyConstraints(t),e}}catch(e){throw d.error(`[Track] fail to clone because of error:${e}`),e}}setMediaTrack(e){d.info("[LocalVideoTrack] setMediaTrack"),this.mediaTrack!==e&&(this.mediaTrack=e,this.readyPlay&&this.play(this.view,this.playConfig))}async recreateMediaTrack(){try{if(this._originTrack=await o.createCameraVideoTrack(this.config),this.removeTrackEventListener(),this.addTrackEventListener(),this._rtcBeautyPlugin){const e=await this._createBeautyTrack();this.setMediaTrack(e)}else this.setMediaTrack(this._originTrack);d.info("[LocalVideoTrack] recreateMediaTrack success")}catch(e){throw d.error("[LocalVideoTrack] recreateMediaTrack failed"),e}}async setBeautyEffect(e,t){if(!this._rtcBeautyPlugin){if(!a.isSupported())throw d.warning("[LocalVideoTrack] current browser not support beautyEffect"),new Error("[LocalVideoTrack] current browser not support beautyEffect")}if(u()||c())throw new Error("[LocalVideoTrack] can not enable beauty effect on mobile device");if(this._enableBeauty=e,e){if(this._beautyConfig=t||P,this.mediaTrack===this._originTrack){const e=await this._createBeautyTrack();this.setMediaTrack(e)}else this._rtcBeautyPlugin.setBeautyParam(this._beautyConfig);d.info("[LocalVideoTrack] open beautyEffect")}else this._destroyBeautyTrack(t),d.info("[LocalVideoTrack] close beautyEffect");this.enable&&await this.emitEvent(C.REPLACE_TRACK,this.mediaTrack,this.trackMediaType,this.sourceType)}async _beautyCheck(){if(this._rtcBeautyPlugin)try{await this.setBeautyEffect(!0)}catch(e){d.error(`[LocalVideoTrack] beautyCheck  ${e}`)}}async _createBeautyTrack(){return this._rtcBeautyPlugin||(this._rtcBeautyPlugin=new a,this._rtcBeautyPlugin.onOverload=()=>{this.emit(E.BEAUTY_EFFECT_OVERLOAD)}),this._rtcBeautyPlugin.setBeautyParam(this._beautyConfig),await this._rtcBeautyPlugin.generateBeautyTrack(this._originTrack)}_destroyBeautyTrack(){this.mediaTrack!==this._originTrack&&this.setMediaTrack(this._originTrack),this._rtcBeautyPlugin&&(this._rtcBeautyPlugin.destroy(),this._rtcBeautyPlugin=null)}getCurrentFrameData(){if(!this.videoElement)return new ImageData(2,2);let e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;var t=e.getContext("2d");if(!t)return d.error("[LocalVideoTrack] create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);let i=t.getImageData(0,0,e.width,e.height);return e.remove(),i}}class V extends B{constructor(e,t){super(e,t.sourceType),this.config=t,this.speakerDevice=void 0,this.onDefaultSpeakerChanged=this.onDefaultSpeakerChanged_.bind(this),this.onSpeakerChanged=this.onSpeakerChanged_.bind(this),this._source=new s(e)}onDefaultSpeakerChanged_(e){d.info("[LocalAudioTrack] onDefaultSpeakerChanged deviceInfo:",e,"device:",this.speakerDevice),this.isPlaying&&this.audioElement&&e.device.deviceId===this.speakerDevice&&(this.audioElement.pause(),this.removeElementListener(this.audioElement),this.audioElement=null)}onSpeakerChanged_(e){d.info("[LocalAudioTrack] onSpeakerChanged deviceInfo:",e,"device:",this.speakerDevice),this.isPlaying&&this.audioElement&&e.device.deviceId===this.speakerDevice&&e.state===T.INACTIVE&&(this.audioElement.pause(),this.removeElementListener(this.audioElement),this.audioElement=null)}play(){d.info("[LocalAudioTrack] play"),null===this.audioElement&&(this.audioElement=document.createElement(x.AUDIO),this.audioElement.srcObject=new MediaStream([this.mediaTrack]),this.addElementListener(this.audioElement)),this.isPlaying||(o.prependListener(_.DEFAULT_SPEAKER_CHANGED,this.onDefaultSpeakerChanged),o.prependListener(_.SPEAKED_CHANGED,this.onSpeakerChanged)),this.speakerDevice=void 0===this.speakerDevice?"default":this.speakerDevice;let e=this.audioElement.play();void 0!==e&&e.catch((async e=>{d.error("[LocalAudioTrack] detect webaudio autoplay failed");let t=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});this.audioElement.play(),t.getTracks().forEach((e=>e.stop()))})).then((()=>{})),this.isPlaying=!0,this.readyPlay=!0}stop(){super.stop(),o.off(_.DEFAULT_SPEAKER_CHANGED,this.onDefaultSpeakerChanged),o.off(_.SPEAKED_CHANGED,this.onSpeakerChanged)}async setPlaybackDevice(e){let t=D(e,A.AUDIO_OUTPUT);if(d.info(`[LocalAudioTrack] setPlaybackDevice deviceId:${e} actualDeviceId:${t}`),"chrome"!==n.browserDetails.browser)throw g.NOT_SUPPORTED;null===this.audioElement&&(this.audioElement=document.createElement(x.AUDIO),this.audioElement.srcObject=new MediaStream([this.mediaTrack]),this.addElementListener(this.audioElement));try{await this.audioElement.setSinkId(t),this.speakerDevice=e,this.isPlaying&&this.audioElement.paused&&this.audioElement.play(),d.info(`[LocalAudioTrack] setPlaybackDevice success deviceId:${e}`)}catch(t){throw d.error(`[LocalAudioTrack] setPlaybackDevice failed for deviceId:${e} because of error:${t}`),g.NOT_SUPPORTED}}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}setVolume(e){if(d.info(`[LocalAudioTrack] setVolume value:${e}`),this._source.setVolume(e/100),this.audioElement){let t=Math.max(0,Math.min(100,e));this.audioElement.volume=t/100}else this._source.setVolume(e/100)}setAudioFrameCallback(e,t=4096){e?(this._source.startGetAudioBuffer(t),this._source.removeAllListeners(b.ON_AUDIO_BUFFER),this._source.on(b.ON_AUDIO_BUFFER,e)):(this._source.removeAllListeners(b.ON_AUDIO_BUFFER),this._source.stopGetAudioBuffer())}setMediaTrack(e){e!=this.mediaTrack&&(this.mediaTrack=e,this.isPlaying&&(this.stop(),this.play()))}}class H extends U{constructor(e,t,i){super(t,i),this.uid=e,this._state=w.NONE}getUserId(){return this.uid}stop(){l.report({eventId:S.STOP_STREAM,param:{remoteUserId:this.uid,sourceType:this.sourceType,mediaType:this.trackMediaType}}),super.stop()}getStats(){const e="audio"===this.mediaTrack.kind?f:m;return this._stats||e}handleElementEvent_(e){switch(e.type){case R.CANPLAY:if(this.videoElement){let e=this.mediaTrack?this.mediaTrack.kind:void 0;d.info(`[RemoteTrack] can start play mediaType:${e} trackId:${this.getTrackId()}`),this.videoElement.play(),this.isPlaying=!0}break;case R.PLAYING:d.info(`[RemoteTrack] id:${this.uid} kind:${this.mediaTrack.kind} is starting playing`),this._state=w.PLAYING,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"playing"});break;case R.ENDED:d.info(`[RemoteTrack] id:${this.uid} kind:${this.mediaTrack.kind} is ended`),this._state!==w.STOPPED&&(this._state=w.STOPPED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"ended"}));break;case R.PAUSE:d.info(`[RemoteTrack] id:${this.uid} kind:${this.mediaTrack.kind} is paused`),this._state=w.PAUSED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"pause"});break;case R.RESIZE:this.videoElement&&d.info(`[RemoteTrack] video size changed to ${this.videoElement.videoWidth}x${this.videoElement.videoHeight}`)}}handleTrackEvent_(e){switch(e.type){case L:d.info(`[RemoteTrack] id:${this.uid} kind:${this.mediaTrack.kind} is ended`),this.emit(y.TRACK_ENDED,this.trackMediaType,this.sourceType,this.trackId),this._state!==w.STOPPED&&(this._state=w.STOPPED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"ended"}));break;case M:d.info(`[RemoteTrack] id:${this.uid} kind:${this.mediaTrack.kind} is muted`),this._state!==w.PAUSED&&(this._state=w.PAUSED,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"mute"}));break;case N:d.info(`[RemoteTrack] id:${this.uid} kind:${this.mediaTrack.kind} is unmuted`),this._state===w.PAUSED&&(this._state=w.PLAYING,this.emit(y.PLAYER_STATE_CHANGED,{state:this._state,reason:"unmute"}))}}}class j extends H{constructor(e,t,i){super(e,t,i),this.speakerDevice=void 0,this.needResetDevice=!1,this.onDefaultSpeakerChanged=this.onDefaultSpeakerChanged_.bind(this),this.onSpeakerChanged=this.onSpeakerChanged_.bind(this),this._source=new s(t),l.report({eventId:S.REMOTE_CREATE_MEDIA_STREAM,param:{remote_user_id:e,remote_video_simulcast_id:0,remote_video_source_type:Number(i===v.CONTENT),mediaTrack:t}})}onDefaultSpeakerChanged_(e){d.info("[RemoteAudioTrack] onDefaultSpeakerChanged deviceInfo:",e,"device:",this.speakerDevice),this.isPlaying&&this.audioElement&&e.device.deviceId===this.speakerDevice&&(this.audioElement.pause(),this.removeElementListener(this.audioElement),this.audioElement=null,this.needResetDevice=!0)}onSpeakerChanged_(e){d.info("[RemoteAudioTrack] onSpeakerChanged deviceInfo:",e,"device:",this.speakerDevice),this.isPlaying&&this.audioElement&&e.device.deviceId===this.speakerDevice&&e.state===T.INACTIVE&&(this.audioElement.pause(),this.removeElementListener(this.audioElement),this.audioElement=null,this.needResetDevice=!0)}play(){null===this.audioElement&&(this.audioElement=document.createElement(x.AUDIO),this.audioElement.srcObject=new MediaStream([this.mediaTrack]),this.addElementListener(this.audioElement)),this.isPlaying||(o.prependListener(_.DEFAULT_SPEAKER_CHANGED,this.onDefaultSpeakerChanged),o.prependListener(_.SPEAKED_CHANGED,this.onSpeakerChanged)),this.speakerDevice=void 0===this.speakerDevice?"default":this.speakerDevice;let e=this.audioElement.play();void 0!==e&&e.catch((async e=>{d.info("RemoteAudioTrack] detect webaudio autoplay failed");let t=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});this.audioElement.play(),t.getTracks().forEach((e=>e.stop()))})).then((()=>{})),this.isPlaying=!0,this.readyPlay=!0,this._source.connect(),d.info(`[RemoteAudioTrack] play user_id:${this.getUserId()} sourceType:${this.sourceType}`),l.report({eventId:S.START_STREAM,param:{remoteUserId:this.uid,sourceType:this.sourceType,mediaType:this.trackMediaType}})}stop(){super.stop(),d.info(`[RemoteAudioTrack] stop user_id:${this.getUserId()} sourceType:${this.sourceType}`),o.off(_.DEFAULT_SPEAKER_CHANGED,this.onDefaultSpeakerChanged),o.off(_.SPEAKED_CHANGED,this.onSpeakerChanged),this._source.disconnect()}async setPlaybackDevice(e){let t=D(e,A.AUDIO_OUTPUT);if(d.info(`[RemoteAudioTrack] setPlaybackDevice deviceId:${e} actualDeviceId:${t}`),void 0===t)throw g.INVALID_DEVICE;if("chrome"!==n.browserDetails.browser)throw g.NOT_SUPPORTED;null===this.audioElement&&(this.audioElement=document.createElement(x.AUDIO),this.audioElement.srcObject=new MediaStream([this.mediaTrack]),this.addElementListener(this.audioElement));try{await this.audioElement.setSinkId(t),this.speakerDevice=e,this.isPlaying&&this.audioElement.paused&&this.audioElement.play(),this.needResetDevice=!1,d.info(`[RemoteAudioTrack] setPlaybackDevice success deviceId:${e}`)}catch(t){throw d.error(`[RemoteAudioTrack] setPlaybackDevice fail deviceId:${e} error:${t}`),g.NOT_SUPPORTED}}setMediaTrack(e){d.debug("[RemoteAudioTrack] setMediaTrack"),e!=this.mediaTrack&&(this.mediaTrack&&this.removeTrackEventListener(),this.mediaTrack=e,this.mediaTrack&&this.addTrackEventListener(),this.isPlaying&&!this.needResetDevice&&(this.stop(),void 0!==this.speakerDevice&&"chrome"===n.browserDetails.browser&&this.setPlaybackDevice(this.speakerDevice),this._source.updateTrack(e),this.play()))}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}setVolume(e){if(d.info(`[RemoteAudioTrack] setVolume value:${e}`),this._source.setVolume(e/100),this.audioElement){let t=Math.max(0,Math.min(100,e));this.audioElement.volume=t/100}else this._source.setVolume(e/100)}setAudioFrameCallback(e,t=4096){e?(this._source.startGetAudioBuffer(t),this._source.removeAllListeners(b.ON_AUDIO_BUFFER),this._source.on(b.ON_AUDIO_BUFFER,e)):(this._source.removeAllListeners(b.ON_AUDIO_BUFFER),this._source.stopGetAudioBuffer())}}class G{constructor(e){this.track=e,this.uid=null}}e.exports={LocalVideoTrack:F,LocalAudioTrack:V,RemoteVideoTrack:class extends H{constructor(e,t,i){super(e,t,i),this.config=null,l.report({eventId:S.REMOTE_CREATE_MEDIA_STREAM,param:{remote_user_id:e,mediaTrack:t}})}play(e,t){d.info(`[RemoteVideoTrack] play uid:${this.uid} sourceType:${this.sourceType}`),super.play(e,t),this.lastTimeUpdatedTime=this.playbackTime=this.freezeTime=this.timeUpdatedCount=0,this.freezeTimeCounterList=[],this.videoElement.addEventListener("timeupdate",(()=>{if(this.videoElement){let e=Date.now();if(this.timeUpdatedCount++,10>this.timeUpdatedCount)return void(this.lastTimeUpdatedTime=e);let t=e-this.lastTimeUpdatedTime;for(this.lastTimeUpdatedTime=e,500<t&&(this.freezeTime+=t),this.playbackTime+=t;2e3<=this.playbackTime;)this.playbackTime-=2e3,this.freezeTime=Math.max(0,this.freezeTime-2e3),this.playbackTime<=2e3&&this.freezeTimeCounterList.push(Math.min(2e3,this.freezeTime))}})),l.report({eventId:S.START_STREAM,param:{remoteUserId:this.uid,sourceType:this.sourceType,mediaType:this.trackMediaType}})}stop(){d.info(`[RemoteVideoTrack] stop uid:${this.uid} sourceType:${this.sourceType}`),super.stop()}setMediaTrack(e){d.debug("[RemoteVideoTrack] setMediaTrack"),this.mediaTrack!==e&&(this.mediaTrack&&this.removeTrackEventListener(),this.mediaTrack=e,this.mediaTrack&&this.addTrackEventListener(),this.play(this.view,this.playConfig))}getCurrentFrameData(){if(!this.videoElement)return new ImageData(2,2);let e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;var t=e.getContext("2d");if(!t)return d.error("[RemoteVideoTrack] create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);let i=t.getImageData(0,0,e.width,e.height);return e.remove(),i}},RemoteAudioTrack:j,CameraVideoTrack:class extends F{constructor(e,t){super(e,t),l.report({eventId:S.START_PREVIEW,param:{mediaTrack:e,config:t}});let i=O(e.label,"videoinput");i&&l.report({eventId:S.SWITCH_CAMERA,param:{device_id:i,device_name:e.label,action:"[CameraVideoTrack] init"}})}async setEnabled(e){if(d.info(`[CameraVideoTrack] setEnabled enable:${e}`),await this._enableMutex.lock(),this.enable!==e){if(this.enable=e,e)try{this.mediaTrack.readyState!==L&&d.warning("[CameraVideoTrack] setEnabled media track has not been stoped"),await this.recreateMediaTrack()}catch(t){throw d.error(`[CameraVideoTrack] setEnable failed enable:${e}`),this._enableMutex.unlock(),t}else this.mediaTrack.stop(),this._originTrack.stop();try{let t=e?C.ENABLE_TRACK:C.DISABLE_TRACK;await this.emitEvent(t,this.mediaTrack,this.trackMediaType,this.sourceType)}catch(t){throw d.error(`[CameraVideoTrack] setEnable emit event failed enable:${e}`),this._enableMutex.unlock(),t}}this._enableMutex.unlock()}async setDevice(e){d.info(`[CameraVideoTrack] set device deviceId:${e}`);try{if(this.config.deviceId=D(e,A.VIDEO_INPUT),void 0===this.config.deviceId)throw g.INVALID_DEVICE;await this._enableMutex.lock(),this.enable&&(this._originTrack.stop(),this.mediaTrack.stop(),await this.recreateMediaTrack(),this._rtcBeautyPlugin?await this.setBeautyEffect(!0):await this.emitEvent(C.REPLACE_TRACK,this.mediaTrack,this.trackMediaType,this.sourceType),l.report({eventId:S.SWITCH_CAMERA,param:{device_id:e,device_name:this._originTrack.label,action:"[CameraVideoTrack] setDevice"}})),d.info(`[CameraVideoTrack] set device success deviceId:${e}`),this._enableMutex.unlock()}catch(t){throw d.error(`[CameraVideoTrack] set device failed deviceId:${e}`),this._enableMutex.unlock(),t}}async setEncoderConfiguration(e){if("string"==typeof e&&e in I)e=I[e];else{if("object"!=typeof e)throw g.INVALID_PARAMS;e.bitrateMax=e.bitrateMax?e.bitrateMax:this.config.encoderConfig.bitrateMax,e.bitrateMin=e.bitrateMin?e.bitrateMin:this.config.encoderConfig.bitrateMin}try{let t={width:e.width,height:e.height,frameRate:e.frameRate};this.config.deviceId&&(t.deviceId=this.config.deviceId),navigator.mediaDevices.getSupportedConstraints().aspectRatio&&(t=Object.assign(t,{aspectRatio:e.width/e.height}));let i=!1;if(e.width>this.config.encoderConfig.width||e.height>this.config.encoderConfig.height)if(await this._originTrack.applyConstraints(t),this._rtcBeautyPlugin){let e=this.mediaTrack;const t=await this._createBeautyTrack();this.setMediaTrack(t),e.stop(),i=!0}else this.setMediaTrack(this._originTrack);else await this._originTrack.applyConstraints(t),await this.mediaTrack.applyConstraints(t);this.config.encoderConfig=Object.assign(this.config.encoderConfig,e),d.info(`[CameraVideoTrack] setEncoderConfiguration config:${JSON.stringify(this.config)}`);let r=Object.assign({updateLowStream:i},this.config);await this.emitEvent(C.REPLACE_TRACK,this.mediaTrack,this.trackMediaType,this.sourceType,r)}catch(e){throw d.error(`[Track] setEncoderConfiguration failed because of error:${e}`),e}}},MicrophoneAudioTrack:class extends V{constructor(e,t){super(e,t),this.speakerDevice=void 0,this.onDefaultSpeakerChanged=this.onDefaultSpeakerChanged_.bind(this),this.onSpeakerChanged=this.onSpeakerChanged_.bind(this),l.report({eventId:S.MUTE_MICROPHONE,param:{mediaTrack:e,config:t}});let i=O(e.label,"audioinput");i&&l.report({eventId:S.AUDIO_INTPUT_ROUTE_CHANGE,param:{device_id:i,device_name:e.label,action:"[MicrophoneAudioTrack] init"}})}async setEnabled(e){if(d.info(`[MicrophoneAudioTrack] setEnabled enable:${e}`),await this._enableMutex.lock(),this.enable!==e){if(this.enable=e,e)try{await this.recreateMediaTrack()}catch(t){throw d.error(`[MicrophoneAudioTrack] setEnable failed for enable:${e}`),this._enableMutex.unlock(),t}else this.mediaTrack.stop();try{let t=e?C.ENABLE_TRACK:C.DISABLE_TRACK;await this.emitEvent(t,this.mediaTrack,this.trackMediaType,this.sourceType)}catch(t){throw d.error(`[MicrophoneAudioTrack] emit event failed for enable:${e}`),this._enableMutex.unlock(),t}}this._enableMutex.unlock()}async setDevice(e){d.info(`[MicrophoneAudioTrack] setDevice deviceId:${e}`);try{if(this.config.deviceId=D(e,A.AUDIO_INPUT),void 0===this.config.deviceId)throw g.INVALID_DEVICE;await this._enableMutex.lock(),this.enable&&(this.mediaTrack.stop(),await this.recreateMediaTrack(),await this.emitEvent(C.REPLACE_TRACK,this.mediaTrack,this.trackMediaType,this.sourceType),l.report({eventId:S.AUDIO_INTPUT_ROUTE_CHANGE,param:{device_id:e,device_name:this._originTrack.label,action:"[MicrophoneAudioTrack] setDevice"}})),d.info(`[MicrophoneAudioTrack] setDevice set device success deviceId:${e}`),this._enableMutex.unlock()}catch(t){throw d.error(`[MicrophoneAudioTrack] setDevice set device fail deviceId:${e}`),this._enableMutex.unlock(),t}}async recreateMediaTrack(){try{this._originTrack=await o.createMicrophoneAudioTrack(this.config),this.removeTrackEventListener(),this.addTrackEventListener(),this.setMediaTrack(this._originTrack),this._source.updateTrack(this.mediaTrack),d.debug("[MicrophoneAudioTrack] recreateMediaTrack success")}catch(e){throw d.error("[MicrophoneAudioTrack] recreateMediaTrack failed"),e}}},BufferSourceAudioTrack:class extends V{constructor(e,t,i){super(t.createOutputTrack(),i),this.source=e,this._bufferSource=t,this._bufferSource.on(b.AUDIO_SOURCE_STATE_CHANGE,(e=>{this.emit(E.SOURCE_STATE_CHANGE,e)}));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}},RemoteActiveAudioTrack:class extends r{constructor(){super(),console.log("[RemoteActiveAudioTrack] constructor"),this.remoteAudioTracks=new Map,this.muteSpeakers=new Set,this.mediaStreams=new Map}setMediaStream(e){this.mediaStream!=e&&(this.mediaStream=e,this.remoteAudioTracks.clear(),this.mediaStream.getAudioTracks().forEach((e=>{let t=new j("any",e,v.PEOPLE);this.remoteAudioTracks.set(e.id,new G(t))})))}addMediaStream(e){if(d.debug(`[RemoteActiveAudioTrack] addMediaStream size:${e.getAudioTracks().length}`),!this.mediaStreams.has(e.id)){this.mediaStreams.set(e.id,e);let t=e.getAudioTracks()[0],i=new j("any",t,v.PEOPLE);this.remoteAudioTracks.set(e.id,new G(i))}}async muteRemoteAudio(e){d.debug(`[RemoteActiveAudioTrack] muteRemoteAudio uid:${e}`);try{await this.asyncEmit(C.MUTE_ACTIVE_AUDIO_TRACK,e,!0)}catch(e){throw e}this.muteSpeakers.add(e)}async unmuteRemoteAudio(e){d.debug(`[RemoteActiveAudioTrack] unmuteRemoteAudio uid:${e}`);try{await this.asyncEmit(C.MUTE_ACTIVE_AUDIO_TRACK,e,!1)}catch(e){throw e}this.muteSpeakers.delete(e)}play(){this.remoteAudioTracks.forEach(((e,t)=>{e.track.play()}))}stop(){this.remoteAudioTracks.forEach(((e,t)=>{e.track.isPlaying&&e.track.stop()}))}getVolumeLevels(){d.info("[RemoteActiveAudioTrack] getVolumeLevels");let e=new Map;return this.remoteAudioTracks.forEach(((t,i)=>{if(null!==t.uid){let i=t.track.getVolumeLevel();e.set(t.uid,i)}})),e}setVolume(e){d.info(`[RemoteActiveAudioTrack] setVolume value:${e}`),this.remoteAudioTracks.forEach(((t,i)=>{t.track.setVolume(e)}))}async setPlaybackDevice(e){d.info(`[RemoteActiveAudioTrack] setPlaybackDevice deviceId:${e}`);for(let t of this.remoteAudioTracks.values())try{await t.track.setPlaybackDevice(e)}catch(e){d.error(`[RemoteActiveAudioTrack] setPlaybackDevice error:${e}`)}}updateTrackRelation(e){d.info(`[RemoteActiveAudioTrack] updateTrackRelation trackRelation:${JSON.stringify(e)} size:${this.remoteAudioTracks.size}`),this.remoteAudioTracks.forEach(((t,i)=>{t.uid=i in e?e[i]:null}))}}}},220:(e,t,i)=>{const{SourceType:r,ACodeC:n,VCodeC:o}=i(9648);let a={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0,rttMs:0},s={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,sendFrameRate:0,targetSendBitrate:0,currentPacketLossRate:0,rttMs:0},c={receiveBitrate:0,receiveLevel:0,receiveBytes:0,receivePackets:0,receivePacketsLost:0,packetLossRate:0,currentPacketLossRate:0},u={receiveBitrate:0,receiveBytes:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,packetLossRate:0,currentPacketLossRate:0,receiveFrameRate:0,decodeFrameRate:0,renderFrameRate:0};e.exports={sendAudioStats:a,sendVideoStats:s,recAudioStats:c,recVideoStats:u,trackStats:new class{setSendMediaTrack(e,t,i,r){this.publishInfo=e,1===i?(e.audioTrack&&(e.enableAudio[0]?this.setSendAudioTrackStats(t):e.audioTrack._stats=a),e.videoTrack&&(e.enableVideo[0]?this.setSendVideoTrackStats(t,r):e.videoTrack._stats=s)):(e.audioTrack&&1===r&&(e.enableAudio[0]?this.setSendAudioTrackStats(t):e.audioTrack._stats=a),e.videoTrack&&1===r?e.enableVideo[0]?this.setSendVideoTrackStats(t,r):e.videoTrack._stats=s:e.lowStreamVideoTrack&&0===r&&(e.enableVideo[0]?this.setSendVideoTrackStats(t,r):e.lowStreamVideoTrack._stats=s))}setRecMediaTrack(e,t,i){this.remoteUser=e,this.subscribeInfo=t;const n=e.user;t.enableAudio[0]?this.setRecAudioTrackStats(i):t.sourceType===r.CONTENT?n.contentAudioTrack&&(n.contentAudioTrack._stats=c):n.audioTrack&&(n.audioTrack._stats=c),t.enableVideo[0]?this.setRecVideoTrackStats(i):t.sourceType===r.CONTENT?n.contentVideoTrack&&(n.contentVideoTrack._stats=u):n.videoTrack&&(n.videoTrack._stats=u)}setSendAudioTrackStats({AtxMetaData:e,AtxMediaInfo:t}){if(this.publishInfo.audioTrack){let i;for(const t in n)n[t]===e.encodingStreamType&&(i=t);this.publishInfo.audioTrack._stats={...a,codecType:i,sendVolumeLevel:e.captureVolume||0,sendBitrate:t.sendKbps||0,sendBytes:Math.round(t.sendKbps/8)||0,sendPackets:t.sendPktsCount||0,sendPacketsLost:t.sendPktsLostCount||0,currentPacketLossRate:t.pktsLostRate/1e3||0,rttMs:t.rttMs||0}}}setSendVideoTrackStats({VtxMetaData:e,VtxMediaInfo:t},i){if(this.publishInfo.videoTrack){let r;for(const t in o)o[t]===e.encodingStreamType&&(r=t);const n={...s,codecType:r,sendBytes:Math.round(t.sendKbps/8)||0,sendBitrate:t.sendKbps||0,sendPackets:t.sendPktsCount||0,sendPacketsLost:t.sendPktsLostCount||0,sendResolutionHeight:e.encHeight||0,sendResolutionWidth:e.encWidth||0,captureResolutionHeight:e.inputHeight||0,captureResolutionWidth:e.inputWidth||0,sendFrameRate:Math.round(t.sendFpsX10/10)||0,targetSendBitrate:Math.round(t.totalSendBytes/8)||0,currentPacketLossRate:t.pktsLostRate/1e3||0,rttMs:t.rttMs||0};1===i?this.publishInfo.videoTrack._stats=n:this.publishInfo.lowStreamVideoTrack._stats=n}}setRecAudioTrackStats({ArxMetaData:e,ArxMediaInfo:t}){let i;for(const t in n)n[t]===e.encodingStreamType&&(i=t);const o={...c,codecType:i,receiveLevel:e.playVolume,receiveBitrate:t.recvKbps,receiveBytes:Math.round(t.recvKbps/8),receivePackets:t.recvPktsCount,currentPacketLossRate:t.pktsLostRate/1e3};this.subscribeInfo.sourceType===r.CONTENT?this.remoteUser.user.contentAudioTrack&&(this.remoteUser.user.contentAudioTrack._stats=o):this.remoteUser.user.audioTrack&&(this.remoteUser.user.audioTrack._stats=o)}setRecVideoTrackStats({VrxMetaData:e,VrxMediaInfo:t}){let i;for(const t in o)o[t]===e.encodingStreamType&&(i=t);const n=Math.round(t.recvFpsX10/10),a={...u,codecType:i,receiveBitrate:t.recvKbps,receiveBytes:Math.round(t.recvKbps/8),receivePackets:t.recvPktsCount,currentPacketLossRate:t.pktsLostRate/1e3,receiveResolutionHeight:e.decHeight,receiveResolutionWidth:e.decWidth,receiveFrameRate:n,decodeFrameRate:n,renderFrameRate:n};this.subscribeInfo.sourceType===r.CONTENT?this.remoteUser.user.contentVideoTrack&&(this.remoteUser.user.contentVideoTrack._stats=a):this.remoteUser.user.videoTrack&&(this.remoteUser.user.videoTrack._stats=a)}}}},297:(e,t,i)=>{const r=i(7247);e.exports=class{constructor(e){this.name=e,this.lockQueue=[],this.locked=!1}async lock(){if(r.debug(`[AWaitLock] ${this.name} lock:${this.locked}`),this.locked){let e=this;r.info(`[AWaitLock] ${this.name} lock queue size:${this.lockQueue.length}`),await new Promise((t=>{e.lockQueue.push(t)}))}return this.locked=!0,!0}unlock(){this.locked=!1;let e=this.lockQueue.shift();r.debug(`[AWaitLock] ${this.name} unlock lock queue size:${this.lockQueue.length}`),e&&(r.info(`[AWaitLock] ${this.name} unlock queue size:${this.lockQueue.length}`),e())}}},9516:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ActionInfo:()=>u,RtcAction:()=>l,PublishInfo:()=>d,SubscribeInfo:()=>h,ActiveAudioTrack:()=>p,AryaRTCUser:()=>f});const r=i(485),n=i(297),{MediaType:o,ClientError:a,PublishEvent:s}=i(9648);function c(e,t){return`${e}_${t}`}class u{constructor(e,t,i,r,n){this.seq=e,this.ack=!1,this.actionName=t,this.uid=i,this.sourceType=r,this.simulcastLayer=n,this.event=null}}class l{constructor(){this.actionInfos=new Map}push(e){this.removeActionInternal(e),this.actionInfos.set(c(e.actionName,e.seq),e)}get(e,t){return this.actionInfos.get(c(e,t))}remove(e,t){this.actionInfos.delete(c(e,t))}clear(){this.actionInfos.clear()}removeActionInternal(e){for(let[t,i]of this.actionInfos)e.actionName===i.actionName&&e.uid===i.uid&&e.sourceType===i.sourceType&&e.simulcastLayer===i.simulcastLayer&&this.actionInfos.delete(t)}}class d{constructor(e,t){this.peer=null,this.lowStreamPeer=null,this.sourceType=e,this.enableAudio=[!1,!0],this.enableVideo=[!1,!0],this.publish=[!1,!0],this.publishLowStream=[!1,!0],this.videoConfig=null,this.audioConfig=null,this.audioTrack=null,this.videoTrack=null,this.lowStreamVideoTrack=null,this.iceRestart=!1,this.event=new r,this.mutex=new n(`pub_${t}_${e}`),this.audioPending=!1,this.videoPending=!1}async createWaitNegotiatePromise(e){e===o.AUDIO?this.audioPending=!0:this.videoPending=!0,await new Promise((async(e,t)=>{let i=()=>{t(a.PUBLISH_ABORT)};this.event.once(s.ABORT,i),await this.peer.awaitSetAnswer(),this.event.off(s.ABORT,i),e()})),e===o.AUDIO?this.audioPending=!1:this.videoPending=!1}releaseNegotiatePromiseIfNeed(e){return(e===o.AUDIO&&this.audioPending||!(e!==o.VIDEO||!this.videoPending))&&(this.event.emit(s.ABORT),!0)}isVideoPublished(){return null!==this.videoTrack}isAudioPublished(){return null!==this.audioTrack}}class h{constructor(e,t){this.peer=null,this.sourceType=e,this.enableAudio=[!1,!0],this.enableVideo=[!1,!0],this.subscribe=[!1,!0],this.iceRestart=!1,this.audioPromise=void 0,this.videoPromise=void 0,this.contentAudioPromise=void 0,this.contentVideoPromise=void 0,this.mutex=new n(`sub_${t}_${e}`)}}class p{constructor(e){this.track=e,this.uid=null}}class f{constructor(e){this.user=e,this.publishInfos=new Map,this.subscribeInfos=new Map,this.streamType=null}}},9648:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ClientEvent:()=>r,SignalConnectionState:()=>n,SignalConnectionStateReason:()=>o,ContentKickedOffReason:()=>a,MediaType:()=>s,SourceType:()=>c,SimulcastLayer:()=>u,ClientError:()=>l,ClientRole:()=>d,PeerConnectionState:()=>h,PeerEvent:()=>p,PeerType:()=>f,DeviceKind:()=>m,DeviceState:()=>g,DeviceEvent:()=>v,TrackState:()=>A,MediaElementEvent:()=>T,TrackEvent:()=>_,TrackInternalEvent:()=>x,PublishContentState:()=>y,SignalHandlerEvent:()=>C,AudioEvent:()=>b,SourceEvent:()=>E,ActionEventResult:()=>S,PublishEvent:()=>I,ActionEventId:()=>w,AryaError:()=>R,VCodeC:()=>k,ACodeC:()=>P,AdaptionChangeReason:()=>D,JoinChannelType:()=>O,DeviceError:()=>L,VideoProfile:()=>N,ScreenProfile:()=>B,AryaJoinError:()=>F,DebugParam:()=>V,qualityTransform:()=>H,NetworkQuality:()=>j});const r={USER_JOINED:"user-joined",USER_LEFT:"user-left",USER_PUBLISHED:"user-published",USER_UNPUBLISHED:"user-unpublished",CONTENT_PUBLISH:"content-published",CONTENT_UNPUBLISHED:"content-unpublished",CONTENT_KICKED_OFF:"content-kicked-off",CONNECTION_STATE_CHANGE:"connection-state-change",STREAM_TYPE_CHANGED:"stream-type-changed",VOLUME_INDICATOR:"volume-indicator",ACTIVE_TRACK:"active-track",EXCEPTION:"exception",ERROR:"error",NETWORK_QUALITY:"network-quality"},n={DISCONNECTED:"disconnected",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTING:"disconnecting",RECONNECTING:"reconnecting"},o={CHANNEL_BANNED:"channel_banned",LEAVE:"leave",SERVER_ERROR:"server_error",IP_BANNED:"ip_banned",NETWORK_ERROR:"network_error",UID_BANNED:"uid_banned",JOIN_SUCCESS:"join_success",REJOIN_SUCCESS:"rejoin_success",JOIN:"join",UNDEFINED:"undefined"},a={REJOIN:"rejoin",KICKED_OFF:"kicked_off"},s={AUDIO:"audio",VIDEO:"video"},c={PEOPLE:"people",CONTENT:"content"},u={LOWSTREAM:0,HIGHSTREAM:1},l={REPEATED_JOIN:"repeated_join",JOIN_FAILED:"join_failed",INVALID_USER:"invalid_user",INVALID_CHANNEL:"invalid_channel",FETCH_SPAWNER_ERROR:"fetch_spawner_error",SEND_SIGNAL_ERROR:"send_signal_error",GATEWAY_JOIN_ERROR:"gateway_join_error",GATEWAY_LEAVE_ERROR:"gateway_leave_error",INVALID_OPERATION:"invalid_operation",INVALID_PARAMS:"invalid_params",INVALID_LOCAL_TRACK:"invalid_local_track",TRACK_DISABLED:"track_disabled",TRACK_SOURCE_TYPE_CONFLICT:"tracks_source_type_conflict",TRACK_ALREADY_PUBLISHED:"track_already_published",SEND_OFFER_FAILED:"send_offer_failed",TRACK_NOT_PUBLISHED:"track_not_published",LOCAL_USER_NOT_IN_CHANNEL:"local_user_not_in_channel",REMOTE_USER_NOT_IN_CHANNEL:"remote_user_not_in_channel",INVALID_REMOTE_USER:"invalid_remote_user",INVALID_MEDIA_TYPE:"invalid_media_type",INVALID_RESPONSE:"invalid_response",AUDIENCE_NOT_ALLOW_PUBLISH:"audience_not_allow_publish",SET_ROLE_FALIED:"set_role_failed",TRACK_ALREADY_SUBSCRIBED:"track_already_subscribed",SWITCH_STREADM_TYPE_FAILED:"switch_stream_type_failed",SET_OFFER_FAILED:"set_offer_failed",TRACK_NOT_SUBSCRIBED:"track_not_subscribed",NOT_SUPPORTED:"not_supported",INVALID_DEVICE:"invalid_device",PERMISSION_DENIED:"permission_denied",NOT_SUPPORT_AUDIO:"not_supported_audio",CREATE_SOURCE_TRACK_FAILED:"create_source_track_failed",HTTP_POST_FALIED:"http_post_failed",SIGNAL_OPEN_FAILED:"signal_open_failed",SIGNAL_INVOKE_TIMEOUT:"signal_invoke_timeout",SIGNAL_NOT_CONNECTED:"signal_not_connected",SENDER_NOT_FOUND:"sender_not_found",TRACK_NOT_EXIST:"track_not_exist",TRACk_ALREADY_ADDED:"track_already_added",SET_OPTIMIZATION_MODE_FAILED:"set_optimization_mode_failed",ENABLE_TRACK_FAILED:"enable_track_failed",PUBLISH_LOW_STREAM_FAILED:"publish_low_stream_failed",PUBLISH_ABORT:"publish_abort",CREATE_SCREEN_TRACK_FAILED:"create_screen_track_failed",SUBSCRIBE_ABORT:"subscribe_abort"},d={ANCHOR:"anchor",AUDIENCE:"audience"},h={NEW:"new",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",FAILED:"failed",CLOSED:"closed"},p={AUDIO_TRACK:"audio-track",VIDEO_TRACK:"video-track",MEDIA_STREAM:"media-stream",CONNECTION_STATE:"connection-state",SET_ANSWER:"set-answer",RECONNECT:"reconnect"},f={PUBLISH:"publish",SUBSCRIBE:"subscribe"},m={AUDIO_INPUT:"audioinput",VIDEO_INPUT:"videoinput",AUDIO_OUTPUT:"audiooutput"},g={ACTIVE:"ACTIVE",INACTIVE:"INACTIVE"},v={CAMERA_CHANGED:"camera-changed",SPEAKED_CHANGED:"speaker-changed",MICROPHONE_CHANGED:"microphone-changed",DEFAULT_SPEAKER_CHANGED:"default-speaker-changed",DEFAULT_MICROPHONE_CHANGED:"default-microphone-changed",COMMUNICATION_SPEAKER_CHANGED:"communication-speaker-changed",COMMUNICATION_MIROPHONE_CHANGED:"communication-microphone-changed"},A={NONE:"NONE",STOPPED:"STOPPED",PAUSED:"PAUSED",PLAYING:"PLAYING"},T={PAUSED:"paused",PLAYING:"playing",CANPLAY:"canplay",ENDED:"ended",PAUSE:"pause",RESIZE:"resize",TIMEUPDATE:"timeupdate"},_={FIRST_FRAME_DECODED:"first-frame-decoded",TRACK_ENDED:"track-ended",PLAYER_STATE_CHANGED:"player-state-changed"},x={ENABLE_TRACK:"enable_track",DISABLE_TRACK:"disable_track",REPLACE_TRACK:"replace_track",SET_OPTIMIZATION_MODE:"set_optimization_mode",MUTE_ACTIVE_AUDIO_TRACK:"mute_active_audio_track"},y={WAIT_PUBLISH_RESPONSE:0,PENDING_PUBLISH_CONTENT:1,PUBLISH_CONTENT_SUCCESS:2},C={RECONNECT_FAILED:"signal-reconnect-failed",CONNECTION_STATE:"signal-state"},b={AUDIO_SOURCE_STATE_CHANGE:"audio_source_state_change",RECEIVE_TRACK_BUFFER:"receive_track_buffer",ON_AUDIO_BUFFER:"on_audio_buffer"},E={SOURCE_STATE_CHANGE:"source-state-change",TRACK_ENDED:"track-ended",BEAUTY_EFFECT_OVERLOAD:"beauty-effect-overload"},S={OK:0,FAIL:1},I={OK:0,FAIL:1,ABORT:2},w={NONE:0,INIT_SDK:101,SECHEDU_SERVICE_REQ:102,SECHEDU_SERVICE_RES:103,SIGNAL_REQ:104,SIGNAL_RES:105,SIGNAL_RECONNECT_REQ:107,SIGNAL_RECONNECT_RES:108,NETWORK_TYPE_CHANGED:109,KRTC_MEDIA_CONNECTED:110,KRTC_MEDIA_DISCONNECTED:111,SWITCH_FRONT_AND_BACK:113,KLIVE_MEDIA_CONNECTED:114,KLIVE_MEDIA_DISCONNECTED:115,CLIENT_ADDRESS:116,SERVER_ADDRESS:117,JOIN_CHANNEL:200,JOIN_CHANNEL_CALLBACK:201,LEAVE_CHANNEL:202,LEAVE_CHANNEL_CALLBACK:203,REJOIN_CHANNEL:204,SWITCH_CLIENT_ROLE:205,PARTICIPANT_ONLINE:206,PARTICIPANT_OFFLINE:207,LEAVE_CHANNEL_KICKED:208,MUTE_LOCAL_AUDIO_STREAM:300,UNMUTE_LOCAL_AUDIO_STREAM:301,MUTE_REMOTE_AUDIO_STREAM:302,UNMUTE_REMOTE_AUDIO_STREAM:303,MUTE_ALL_REMOTE_AUDIO_STREAM:304,UNMUTE_ALL_REMOTE_AUDIO_STREAM:305,DEFAULT_MUTE_ALL_REMOTE_AUDIO_STREAMS:306,DISABLE_VIDEO_TX:307,ENABLE_VIDEO_TX:308,MUTE_REMOTE_VIDEO_STREAM:309,UNMUTE_REMOTE_VIDEO_STREAM:310,PAUSE_ALL_REMOTE_VIDEO_STREAMS:311,RESUME_ALL_REMOTE_VIDEO_STREAMS:312,DEFAULT_UNSUBSCRIBE_REMOTE_VIDEO_STREAMS:313,DEFAULT_SUBSCRIBE_REMOTE_VIDEO_STREAMS:314,CREATE_MEDIA_STREAM:315,REMOTE_CREATE_MEDIA_STREAM:316,START_STREAM:317,STOP_STREAM:318,CLOSE_MEDIA_STREAM:319,CLOSE_REMOTE_MEDIA_STREAM:320,ENABLE_DUAL_STREAM_MODE:321,DISABLE_DUAL_STREAM_MODE:322,UNPUBLISH_VIDEO_STREAM:323,REPLACE_TRACK:324,FIRST_LOCAL_AUDIO_FRAME_PUBLISHED:325,FIRST_LOCAL_VIDEO_FRAME_PUBLISHED:326,FIRST_REMOTE_VIDEO_FRAME_DECODED:327,FIRST_REMOTE_VIDEO_FRAME_RENDERED:328,PUBLISH_VIDEO_STREAM:329,FIRST_REMOTE_AUDIO_FRAME_DECODED:330,FIRST_REMOTE_AUDIO_FRAME_RENDERED:331,RECEIVE_FIRST_AUDIO_PACKET:333,RECEIVE_FIRST_VIDEO_PACKET:334,ENABLE_AUDIO_RX:335,DISABLE_AUDIO_RX:336,SET_REMOTE_USER_STREAM_TYPE:337,DEFAULT_SUBSCRIBE_CHANNEL_STREAM_TYPE:338,MUTE_MICROPHONE:400,MUTE_SPEAKER:401,SET_AUDIO_INPUT_VOLUME:402,SET_SPEAKER_VOLUME:403,SET_AUDIO_RX_VOLUME:404,ENABLE_NOISE_SUPPRESSION:405,REMOTE_AUDIO_STATE_CHANGED_NOTIFY:406,REMOTE_MIC_MUTE:407,REMOTE_MIC_UNMUTE:408,AUDIO_OUTPUT_ROUTE_CHANGE:409,AUDIO_DEVICE_ERROR:410,AUDIO_INTPUT_ROUTE_CHANGE:411,INIT_AUDIO:413,AUDIO_INPUT_DEVICE_UPDATE:416,AUDIO_OUTPUT_DEVICE_UPDATE:417,UPDATE_VIDEO_ENCODER_CONFIG:501,REMOTE_VIDEO_STATE_CHANGED_NOTIFY:502,INIT_CAMERA:503,START_PREVIEW:504,STOP_PREVIEW:505,SWITCH_CAMERA:506,SETUP_LOCAL_VIDEO:507,SETUP_REMOTE_VIDEO:508,SETUP_LOCAL_RENDER_MODE:509,SETUP_REMOTE_RENDER_MODE:510,REMOTE_VIDEO_MUTE:511,REMOTE_VIDEO_UNMUTE:512,START_SCREEN_CAPTURE:513,STOP_SCREEN_CAPTURE:514,VIDEO_DEVICE_ERROR:515,CAMERA_DEVICE_UPDATE:517,SCREEN_STATE:700,SCREEN_INIT:701,SCREEN_MIX:702,SET_LIVE_TRANSCODING:360,START_LIVE_STREAM:361,STOP_LIVE_STREAM:362},R=new Map([[56,w.SET_LIVE_TRANSCODING],[57,w.START_LIVE_STREAM],[58,w.STOP_LIVE_STREAM]]),k={H264:0,H265:1,NONE:2,VP8:3,VP9:4},P={ACC:0,OPUS:1,NONE:2},D={NONE:0,CPU:1,BANDWIDTH:2},O={JOIN_CHANNEL:1,REJOIN_CHANNEL:2},L={MEDIA_OPTION_INVALID:"MEDIA_OPTION_INVALID",DEVICE_NOT_FOUND:"DEVICE_NOT_FOUND",NOT_SUPPORTED:"NOT_SUPPORTED",NOT_READABLE:"NOT_READABLE",PERMISSION_DENIED:"PERMISSION_DENIED",CONSTRAINT_NOT_SATISFIED:"CONSTRAINT_NOT_SATISFIED",UNEXPECTED_ERROR:"UNEXPECTED_ERROR"};function M(e,t,i,r,n){return{width:e,height:t,frameRate:i,bitrateMin:r,bitrateMax:n}}const N={"90p":M(160,90),"90p_1":M(160,90),"120p":M(160,120,15,30,65),"120p_1":M(160,120,15,30,65),"120p_3":M(120,120,15,30,50),"120p_4":M(212,120),"180p":M(320,180,15,30,140),"180p_1":M(320,180,15,30,140),"180p_3":M(180,180,15,30,100),"180p_4":M(240,180,15,30,120),"240p":M(320,240,15,40,200),"240p_1":M(320,240,15,40,200),"240p_3":M(240,240,15,40,140),"240p_4":M(424,240,15,40,220),"360p":M(640,360,15,80,400),"360p_1":M(640,360,15,80,400),"360p_3":M(360,360,15,80,260),"360p_4":M(640,360,30,80,600),"360p_6":M(360,360,30,80,400),"360p_7":M(480,360,15,80,320),"360p_8":M(480,360,30,80,490),"360p_9":M(640,360,15,80,800),"360p_10":M(640,360,24,80,800),"360p_11":M(640,360,24,80,1e3),"480p":M(640,480,15,100,500),"480p_1":M(640,480,15,100,500),"480p_2":M(640,480,30,100,1e3),"480p_3":M(480,480,15,100,400),"480p_4":M(640,480,30,100,750),"480p_6":M(480,480,30,100,600),"480p_8":M(848,480,15,100,610),"480p_9":M(848,480,30,100,930),"480p_10":M(640,480,10,100,400),"720p":M(1280,720,15,120,1130),"720p_1":M(1280,720,15,120,1130),"720p_2":M(1280,720,30,120,2e3),"720p_3":M(1280,720,30,120,1710),"720p_5":M(960,720,15,120,910),"720p_6":M(960,720,30,120,1380),"1080p":M(1920,1080,15,120,2080),"1080p_1":M(1920,1080,15,120,2080),"1080p_2":M(1920,1080,30,120,3e3),"1080p_3":M(1920,1080,30,120,3150),"1080p_5":M(1920,1080,60,120,4780),"1440p":M(2560,1440,30,120,4850),"1440p_1":M(2560,1440,30,120,4850),"1440p_2":M(2560,1440,60,120,7350),"4k":M(3840,2160,30,120,8910),"4k_1":M(3840,2160,30,120,8910),"4k_3":M(3840,2160,60,120,13500)};function U(e,t,i,r,n){return{width:e,height:t,frameRate:i,bitrateMin:r,bitrateMax:n}}const B={"480p":U(640,480,5),"480p_1":U(640,480,5),"480p_2":U(640,480,30),"480p_3":U(640,480,15),"720p":U(1280,720,5),"720p_1":U(1280,720,5),"720p_2":U(1280,720,30),"720p_3":U(1280,720,15),"1080p":U(1920,1080,5),"1080p_1":U(1920,1080,5),"1080p_2":U(1920,1080,30),"1080p_3":U(1920,1080,15),"1440p":U(2560,1440,15)},F=new Map([[2005,"invalid_param"],[2006,"invalid_room"],[2007,"invalid_user"],[2008,"invalid_app_id"],[2009,"invalid_token"],[2010,"token_expired"]]),V={uplinkPacketLossMax:void 0,uplinkPacketLossMin:void 0,downlinkPacketLossMax:void 0,downlinkPacketLossMin:void 0,uplinkRttMax:void 0,uplinkRttMin:void 0,downlinkRttMax:void 0,downlinkRttMin:void 0},H=[0,6,5,5,4,4,3,3,2,2,1],j={UNKNOWN:0,EXCELLENT:1,GOOD:2,POOR:3,BAD:4,VERY_BAD:5,UNAVAILABLE:6}},5459:e=>{e.exports=class{constructor(e){this.task=e,this.complete=!1}async run(){return new Promise((async(e,t)=>{this.reject=t,this.task.then((t=>e(t))).catch((e=>t(e)))}))}cancel(){this.complete||this.reject("cancel")}}},5237:(e,t,i)=>{"use strict";i.r(t),i.d(t,{BrowserDetect:()=>a,checkSystem:()=>C,browserInfo:()=>b,isIOS:()=>E,isAndroid:()=>S,isFirefox:()=>I,isSafari:()=>w,isWECHAT:()=>R,isSafariAndMT:()=>k,isAppleNotSafari:()=>P,isChrome:()=>O});const r=new(i(2238)),n=r.getResult(),o=i(7247),a={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,supportRequestFrame:!1,webAudioWithAEC:!1,supportShareAudio:!1},s="Chrome",c="Safari",u="Edge",l="Firefox",d="OPR",h="QQBrowser",p="MicroMessenger",f="Windows 10",m="Windows 8.1",g="Windows 7",v="Android",A="Linux",T="iOS",_="Mac OS";function x(e){e&&r.setUA(e);let t=r.getResult();e=function(e){switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return s;case"Safari":case"Mobile Safari":return c;case"Edge":return u;case"Firefox":return l;case"QQBrowser":return h;case"Opera":return d;case"WeChat":return p;default:return e.browser.name||""}}(t);var i=t.browser.version&&t.browser.version.split(".")[0]||"";let n="";switch(t.os.name){case"Windows":n=t.os.version?t.os.name+" "+t.os.version:t.os.name;break;default:n=t.os.name||""}return{name:e,version:i,os:n}}function y(){var e=x();return!(!function(){let e=x();return!!("WebKit"===mb.engine.name&&e.os===_&&navigator.maxTouchPoints&&0<navigator.maxTouchPoints&&e.name!==c||e.os===T&&e.name!==c)}()||!(e.os===_||e.os===T&&((e=n.os.version&&n.os.version.split("."))&&14===Number(e[0])&&e[1]&&3<=Number(e[1])||e&&14<Number(e[0]))))}function C(){let e=!1;try{void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;return t?new Promise((function(i,r){t.call(navigator,e,i,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))});const t=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,i=window.WebSocket;e=!!(window.RTCPeerConnection&&t&&i)}catch(e){return o.error(`[DetectBrowser] check system requirement failed: ${e}`),!1}let t=!1,i=x();return i.name===s&&58<=Number(i.version)&&("WebKit"!==n.engine.name||y())&&(t=!0),i.name===l&&56<=Number(i.version)&&(t=!0),i.name===d&&45<=Number(i.version)&&(t=!0),i.name===c&&11<=Number(i.version)&&(t=!0),i.name===u&&80<=Number(i.version)&&(t=!0),i.name!==p&&i.name!==h||(t=!0),o.debug(`[DetectBrowser] checkSystemRequirements api:${e} browser:${t}`),e=e&&t,e}const b=x();function E(){return b.os===T}function S(){return b.os===v}function I(){return b.name===l}function w(){return b.name===c}function R(){return b.name===p}function k(){return w()&&0<navigator.maxTouchPoints}function P(){return!!("WebKit"===r.getResult().engine.name&&b.os===_&&navigator.maxTouchPoints&&0<navigator.maxTouchPoints&&b.name!==c||b.os===T&&b.name!==c)}function D(){return b.name!==u&&b.name!==c&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function O(){return b.name===s}var L;L=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),a.getDisplayMedia=L,a.getStreamFromExtension=b.name===s&&34<Number(b.version),a.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let e=new RTCPeerConnection,t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),a.supportMinBitrate=b.name===s||b.name===u,a.supportSetRtpSenderParameters=!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!D()||!(!w()&&!P())||b.name===l&&64<=Number(b.version)),a.webAudioMediaStreamDest=!(b.name===c&&12>Number(b.version)),a.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,a.supportWebGL="undefined"!=typeof WebGLRenderingContext,a.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,D()||(a.webAudioWithAEC=!0),a.supportShareAudio=(b.os===f||b.os===m||b.os===g||b.os===A||b.os===_)&&b.name===s&&74<=Number(b.version),o.info("[DetectBrowser] browser compatibility",JSON.stringify(a),JSON.stringify(b))},201:(e,t,i)=>{const r=i(485),{ClientError:n,DeviceKind:o,DeviceState:a,DeviceEvent:s,DeviceError:c,ActionEventId:u,ActionEventResult:l}=i(9648),{audioTrackInitConfig:d}=i(8902),h=i(2951),p=i(7247),{isWECHAT:f}=i(5237);function m(e,t){return`${e}_${t}`}const g={audio:u.AUDIO_DEVICE_ERROR,video:u.VIDEO_DEVICE_ERROR,screen:u.SCREEN_INIT};function v(e,t="video",i){const r=e.name||e.code||e,n={eventId:g[t],result:l.FAIL,param:i};switch(r){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return h.report({...n,reason:c.MEDIA_OPTION_INVALID}),c.MEDIA_OPTION_INVALID;case"NotFoundError":case"DevicesNotFoundError":return h.report({...n,reason:c.DEVICE_NOT_FOUND}),c.DEVICE_NOT_FOUND;case"NotSupportedError":return h.report({...n,reason:c.NOT_SUPPORTED}),c.NOT_SUPPORTED;case"NotReadableError":return h.report({...n,reason:c.NOT_READABLE,errorcode:"video"===t?-1502:-1402}),c.NOT_READABLE;case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":{let e={audio:-1403,video:-1501,screen:-1701};return h.report({...n,reason:c.PERMISSION_DENIED,errorcode:e[t]}),c.PERMISSION_DENIED}case"ConstraintNotSatisfiedError":{let e={audio:-1404,video:-1504,screen:-1704};return h.report({...n,reason:c.CONSTRAINT_NOT_SATISFIED,errorcode:e[t]}),c.CONSTRAINT_NOT_SATISFIED}default:return h.report({...n,reason:c.UNEXPECTED_ERROR}),c.UNEXPECTED_ERROR}}e.exports=new class extends r{constructor(){super(),this.inited=!1,this.deviceInfoMap=new Map,this.isAccessCameraPermission=!1,this.isAccessMicrophonePermission=!1,this.init().then((()=>{"ondevicechange"in navigator.mediaDevices&&(navigator.mediaDevices.ondevicechange=this.onDevicechange.bind(this)),!f()&&window.setInterval((()=>this.updateDevices()),6e4)})).catch((e=>{p.error("[DeviceManager] constructor init fail error",e)}))}async init(){try{await this.updateDevices(),this.inited=!0}catch(e){throw p.error("[DeviceManager] init updateDevice fail"),e}}createCameraVideoTrack(e){return new Promise(((t,i)=>{let r={audio:!1,video:{frameRate:e.encoderConfig.frameRate,width:e.encoderConfig.width,height:e.encoderConfig.height}};e.deviceId&&(r.video=Object.assign(r.video,{deviceId:{exact:e.deviceId}})),navigator.mediaDevices.getSupportedConstraints().aspectRatio&&(r.video=Object.assign(r.video,{aspectRatio:e.encoderConfig.width/e.encoderConfig.height})),navigator.mediaDevices.getUserMedia(r).then((e=>{let i=e.getVideoTracks()[0];t(i),h.report({eventId:u.INIT_CAMERA,param:{video:r.video,device:i.label}})})).catch((e=>{v(e,"video",r.video),i(e)}))}))}createMicrophoneAudioTrack(e){let t={video:!1,audio:d(e)};return new Promise(((e,i)=>{navigator.mediaDevices.getUserMedia(t).then((i=>{let r=i.getAudioTracks()[0];e(r),h.report({eventId:u.INIT_AUDIO,param:{audio:t.audio,device:r.label}})})).catch((e=>{v(e,"audio",t.audio),i(e)}))}))}createMicrophoneAndCameraTracks(e,t){let i={audio:d(e),video:{frameRate:t.encoderConfig.frameRate,width:t.encoderConfig.width,height:t.encoderConfig.height}};return t.deviceId&&(i.video=Object.assign(i.video,{deviceId:{exact:t.deviceId}})),navigator.mediaDevices.getSupportedConstraints().aspectRatio&&(i.video=Object.assign(i.video,{aspectRatio:t.encoderConfig.width/t.encoderConfig.height})),new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia(i).then((t=>{let r=t.getVideoTracks()[0],n=t.getAudioTracks()[0];e([n,r]),h.report({eventId:u.INIT_AUDIO,param:{audio:i.audio,device:n.label}}),h.report({eventId:u.INIT_CAMERA,param:{video:i.video,device:r.label}})})).catch((e=>{v(e,"video",i),t(e)}))}))}async createScreenVideoTrack(e,t){let i={};e.encoderConfig.width&&e.encoderConfig.height&&(i.width=e.encoderConfig.width,i.height=e.encoderConfig.height),e.encoderConfig.frameRate&&(i.frameRate=e.encoderConfig.frameRate),e.displaySurface&&(i.displaySurface=e.displaySurface),Object.keys(i).length||(i=!0);let r="enable"===t||"auto"===t,n={video:i,audio:!1};if(r){n={video:i,audio:{autoGainControl:!1,channelCount:1,echoCancellation:!1,googAutoGainControl:!1,latency:0,noiseSuppression:!1,sampleRate:48e3,sampleSize:16,volume:1}}}try{let e=await navigator.mediaDevices.getDisplayMedia(n),t=[];return e.getAudioTracks().length&&r&&t.push(e.getAudioTracks()[0]),e.getVideoTracks().length&&t.push(e.getVideoTracks()[0]),h.report({eventId:u.SCREEN_INIT,param:{constraints:n,device:e.getVideoTracks()[0].label}}),t}catch(e){throw v(e,"screen",n),e}}async enumerateDevices(e,t,i){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw n.NOT_SUPPORTED;let r={audio:!0,video:!0};(!this.isAccessCameraPermission&&t||!this.isAccessMicrophonePermission&&e)&&(r=await this.checkDevicePermission(),r.audio&&(this.isAccessMicrophonePermission=!0),r.video&&(this.isAccessCameraPermission=!0));let o=t&&!r.video,a=e&&!r.audio;if((o||a)&&!i){try{(await navigator.mediaDevices.getUserMedia({audio:a,video:o})).getTracks().forEach((e=>e.stop()))}catch(e){throw n.PERMISSION_DENIED}o&&(this.isAccessCameraPermission=!0),a&&(this.isAccessMicrophonePermission=!0)}try{return await navigator.mediaDevices.enumerateDevices()}catch(e){throw p.error("[DeviceManager] enumerate device fail"),e}}getDevices(e){return e="boolean"==typeof e&&e,this.enumerateDevices(!0,!0,e)}async getCameras(e){e="boolean"==typeof e&&e;try{return(await this.enumerateDevices(!1,!0,e)).filter((e=>e.kind===o.VIDEO_INPUT))}catch(e){throw e}}async getMicrophones(e){e="boolean"==typeof e&&e;try{return(await this.enumerateDevices(!0,!1,e)).filter((e=>e.kind===o.AUDIO_INPUT))}catch(e){throw e}}async getPlaybackDevices(e){e="boolean"==typeof e&&e;try{return(await this.enumerateDevices(!0,!1,e)).filter((e=>e.kind===o.AUDIO_OUTPUT))}catch(e){throw e}}async checkDevicePermission(){let e={audio:!1,video:!1};try{let t=await navigator.mediaDevices.enumerateDevices();for(let i of t)if(i.kind===o.AUDIO_INPUT&&i.label&&(e.audio=!0),i.kind===o.VIDEO_INPUT&&i.label&&(e.video=!0),e.audio&&e.video)break}catch(e){p.error("[DeviceManager] checkDevicePermission fail")}return e}onDevicechange(e){try{this.updateDevices()}catch(e){p.error("[DeviceManager] onDevicechange update device error")}}async updateDevices(){try{let e=(new Date).getTime(),t=await this.getDevices(!0),i=new Array;t.forEach((t=>{let r=this.deviceInfoMap.get(m(t.deviceId,t.kind));if(a.ACTIVE!==(r?r.state:a.INACTIVE)){let r={device:t,initAt:e,updateAt:e,state:a.ACTIVE};this.deviceInfoMap.set(m(t.deviceId,t.kind),r),i.push(r)}r&&(r.updateAt=e)})),this.deviceInfoMap.forEach(((t,r)=>{t.state===a.ACTIVE&&t.updateAt!==e&&(t.state=a.INACTIVE,i.push(t))})),this.inited&&i.length&&i.forEach((e=>{switch(e.device.kind){case o.AUDIO_INPUT:p.debug("[DeviceManager] updateDevices audio input device state is changed device:",e),this.isAccessMicrophonePermission&&this.emit(s.MICROPHONE_CHANGED,e);break;case o.VIDEO_INPUT:p.debug("[DeviceManager] updateDevices video input device state is changed device:",e),this.isAccessCameraPermission&&this.emit(s.CAMERA_CHANGED,e);break;case o.AUDIO_OUTPUT:p.debug("[DeviceManager] updateDevices audio output device state is changed device:",e),this.isAccessMicrophonePermission&&this.emit(s.SPEAKED_CHANGED,e)}})),this.inited&&(this.checkIfDefaultDeviceChanged(t,e),this.checkIfCommunicationsDeviceChanged(t,e))}catch(e){throw p.error("[DeviceManager] updateDevices fail error:",e),e}}checkIfDefaultDeviceChanged(e,t){e.forEach((e=>{if("default"===e.deviceId){let i=this.deviceInfoMap.get(m(e.deviceId,e.kind));if(void 0!==i&&i.device.label!==e.label){let i={device:e,initAt:t,updateAt:t,state:a.ACTIVE};switch(this.deviceInfoMap.set(m(e.deviceId,e.kind),i),e.kind){case o.AUDIO_INPUT:p.debug("[DeviceManager] checkIfDefaultDeviceChanged audio input device state is changed device:",i),this.isAccessMicrophonePermission&&this.emit(s.DEFAULT_MICROPHONE_CHANGED,i);break;case o.AUDIO_OUTPUT:p.debug("[DeviceManager] checkIfDefaultDeviceChanged audio output device state is changed device:",i),this.isAccessMicrophonePermission&&this.emit(s.DEFAULT_SPEAKER_CHANGED,i)}}}}))}checkIfCommunicationsDeviceChanged(e,t){e.forEach((e=>{if("communications"===e.deviceId){let i=this.deviceInfoMap.get(m(e.deviceId,e.kind));if(void 0!==i&&i.device.label!==e.label){let i={device:e,initAt:t,updateAt:t,state:a.ACTIVE};switch(this.deviceInfoMap.set(m(e.deviceId,e.kind),i),e.kind){case o.AUDIO_INPUT:p.debug("[DeviceManager] checkIfCommunicationsDeviceChanged audio input device state is changed device:",i),this.isAccessMicrophonePermission&&this.emit(s.COMMUNICATION_MIROPHONE_CHANGED,i);break;case o.AUDIO_OUTPUT:p.debug("[DeviceManager] checkIfCommunicationsDeviceChanged audio output device state is changed device:",i),this.isAccessMicrophonePermission&&this.emit(s.COMMUNICATION_SPEAKER_CHANGED,i)}}}}))}}},1749:(e,t,i)=>{const r=i(9669),{waitTime:n}=i(4891),o=window.AudioContext||window.webkitAudioContext,a={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};const s=new Map;e.exports=async function(e,t){var i=null;if("string"==typeof e){let t=s.get(e);if(t)return Log.debug("[download] use cached audio resource: ",t),t;try{i=(await function(e,t,i,r){let o=Object.assign({},a,r),s=o.timeout,c=async()=>{await n(s),s*=o.timeoutFactor,s=Math.min(o.maxRetryTimeout,s)},u=!1,l=new Promise((async(r,n)=>{t=t||(()=>!1),i=i||(()=>!0);for(let a=0;a<o.maxRetryCount;a+=1){if(u)return n(new Error("[download] OPERATION_ABORTED"));try{const i=await e();if(!t(i,a)||a+1===o.maxRetryCount)return r(i);await c()}catch(e){if(!i(e,a)||a+1===o.maxRetryCount)return n(e);await c()}}}));return l.cancel=()=>{u=!0},l}((()=>r.get(e,{responseType:"arraybuffer"})),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new Error("[download] FETCH_AUDIO_FILE_FAILED")}}else i=await new Promise(((t,i)=>{const r=new FileReader;r.onload=e=>{e.target?t(e.target.result):i(new Error("[download] READ_LOCAL_AUDIO_FILE_ERROR"))},r.onerror=()=>{i(new Error("[download] READ_LOCAL_AUDIO_FILE_ERROR"))},r.readAsArrayBuffer(e)}));let c=await function(e){const t=new o;return new Promise(((i,r)=>{t.decodeAudioData(e,(e=>{i(e)}),(e=>{r(new Error("[download] DECODE_AUDIO_FILE_FAILED"))}))}))}(i);return"string"==typeof e&&t&&s.set(e,c),c}},485:e=>{e.exports=class{on(e,t){return this.addListenerInternal(e,t,!1)}addListener(e,t){return this.addListenerInternal(e,t,!1)}prependListener(e,t){return this.addListenerInternal(e,t,!0)}removeListener(e,t){return this.off(e,t)}once(e,t){const i=(...r)=>{this.off(e,i),t.apply(this,r)};return i.listener=t,this.on(e,i),this}off(e,t){let i;return this.eventCollection&&(i=this.eventCollection[e])?(i.forEach(((e,r)=>{e!==t&&e.listener!==t||i.splice(r,1)})),0===i.length&&delete this.eventCollection[e],this):this}offAll(e){if(!this.eventCollection)return this;if(void 0===this.eventCollection[e]){Object.keys(this.eventCollection).forEach(((e,t)=>{this.eventCollection[e].length=0}))}else this.eventCollection[e].length=0;return this}removeAllListeners(){this.eventCollection={}}listeners(e){return this.eventCollection[e]?this.eventCollection[e]:[]}getListeners(e){return this.eventCollection[e]?this.eventCollection[e]:[]}emit(e,...t){let i;return this.eventCollection&&(i=this.eventCollection[e])?(i=i.slice(0),i.forEach((e=>e.apply(this,t))),this):this}async asyncEmit(e,...t){let i;if(this.eventCollection&&(i=this.eventCollection[e])){i=i.slice(0);for(let e of i)try{await e.apply(this,t)}catch(e){throw e}}}addListenerInternal(e,t,i){return this.eventCollection=this.eventCollection||{},this.eventCollection[e]=this.eventCollection[e]||[],i?this.eventCollection[e].unshift(t):this.eventCollection[e].push(t),this}}},3487:(e,t,i)=>{const{ClientError:r}=i(9648);class n{constructor(){this.requestCnt=0}async post(e,t,i){return new Promise(((n,o)=>{let a=this;!function s(){fetch(e,{method:"POST",mode:"cors",headers:{"Content-Type":`${i};charset=utf-8`},body:JSON.stringify(t)}).then((async e=>{let t=await e.json();a.requestCnt=0,n(t)})).catch((e=>{a.requestCnt>=3?(a.requestCnt=0,o(r.HTTP_POST_FALIED)):(a.requestCnt++,setTimeout((()=>{s()}),1500))}))}()}))}}n.ContentType={Plain:"text/plain",Json:"application/json"},e.exports=n},1584:(e,t,i)=>{const r=i(5547),n=i(485),{MediaType:o,SourceType:a,PeerEvent:s,PeerType:c,ClientError:u}=i(9648),l=i(7247),d={offerToReceiveAudio:0,offerToReceiveVideo:0,voiceActivityDetection:!0},h={offerToReceiveAudio:1,offerToReceiveVideo:1,voiceActivityDetection:!0},p="offer",f="answer",m="sendonly",g="recvonly",v="inactive";e.exports={PeerConnectionClient:class extends n{constructor(e){super(),this.audioTrack=null,this.videoTrack=null,this.mediaStream=null,this.config=e,this.audioTransceiver=null,this.videoTransceiver=null,this.audioSender=null,this.videoSender=null,this.subscribeOption={audio:!1,video:!1},this.id=e.id,this.sourceType=e.sourceType?e.sourceType:a.PEOPLE,this.simulcastLayer=void 0!==e.simulcastLayer?e.simulcastLayer:1,this.createTime=Date.now().toString().slice(-6),this.logPrefix=`[${e.type.slice(0,3)}_peer_${this.id}_${this.sourceType}_${this.simulcastLayer}_${this.createTime}]`,this.needIceRestart=!1,this.checkIfSupportUnifiedPlan(),this.checkIfSupportReplaceTrack(),this.createPeerConnection()}checkIfSupportUnifiedPlan(){this.supportUnifiedPlan=window.RTCRtpTransceiver&&"addTransceiver"in RTCPeerConnection.prototype,l.debug(`${this.logPrefix} checkIfSupportUnifiedPlan supportUnifiedPlan:${this.supportUnifiedPlan}`)}checkIfSupportReplaceTrack(){this.supportReplaceTrack=window.RTCRtpSender&&"replaceTrack"in RTCRtpSender.prototype,l.debug(`${this.logPrefix} checkIfSupportReplaceTrack supportReplaceTrack:${this.supportReplaceTrack}`)}createPeerConnection(){l.info(`${this.logPrefix} createPeerConnection`);let e={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};e.sdpSemantics=this.supportUnifiedPlan?"unified-plan":"plan-b",this.pc=new RTCPeerConnection(e),this.pc.oniceconnectionstatechange=e=>{},"onconnectionstatechange"in RTCPeerConnection.prototype?this.pc.onconnectionstatechange=e=>{l.info(`${this.logPrefix} onconnectionstatechange state:${this.pc.connectionState}`),this.emit(s.CONNECTION_STATE,this.id,this.sourceType,this.simulcastLayer,this.pc.connectionState)}:"oniceconnectionstatechange"in RTCPeerConnection.prototype?this.pc.oniceconnectionstatechange=e=>{l.info(`${this.logPrefix} ice onconnectionstatechange state:${this.pc.iceConnectionState}`),this.emit(s.CONNECTION_STATE,this.id,this.sourceType,this.simulcastLayer,this.pc.iceConnectionState)}:l.info(`${this.logPrefix} createPeerConnection state change is undefined`),this.pc.onsignalingstatechange=e=>{},this.pc.onicecandidate=e=>{},this.pc.ontrack=e=>{l.info(`${this.logPrefix} ontrack audio:${this.subscribeOption.audio} video:${this.subscribeOption.video}`),this.mediaStream!==e.streams[0]&&(this.mediaStream=e.streams[0],"any"===this.id&&(l.info(`${this.logPrefix} ontrack add media stream`),this.emit(s.MEDIA_STREAM,this.mediaStream))),"any"!==this.id&&(this.subscribeOption.audio&&this.mediaStream.getAudioTracks().length>0&&(this.emit(s.AUDIO_TRACK,this.mediaStream.getAudioTracks()[0]),this.subscribeOption.audio=!1),this.subscribeOption.video&&this.mediaStream.getVideoTracks().length>0&&(this.emit(s.VIDEO_TRACK,this.mediaStream.getVideoTracks()[0]),this.subscribeOption.video=!1))},this.mediaStream=new MediaStream}enableSubscribeAudio(){l.info(`${this.logPrefix} enableSubscribeAudio`),this.mediaStream&&0!==this.mediaStream.getAudioTracks().length?this.emit(s.AUDIO_TRACK,this.mediaStream.getAudioTracks()[0]):this.subscribeOption.audio=!0}disableSubscribeAudio(){l.info(`${this.logPrefix} disableSubscribeAudio`),this.subscribeOption.audio=!1}enableSubscribeVideo(){l.info(`${this.logPrefix} enableSubscribeVideo`),this.mediaStream&&0!==this.mediaStream.getVideoTracks().length?this.emit(s.VIDEO_TRACK,this.mediaStream.getVideoTracks()[0]):this.subscribeOption.video=!0}disableSubscribeVideo(){l.info(`${this.logPrefix} disableSubscribeVideo`),this.subscribeOption.video=!0}async createOffer(e){l.info(`${this.logPrefix} createOffer`);try{let t={};if(this.config.type===c.PUBLISH)t=e?Object.assign(e,d):d;else if(this.config.type===c.SUBSCRIBE)if("any"!==this.id)t=e?Object.assign(e,h):h;else{for(let e=0;e<5;e++)this.pc.addTransceiver("audio",{direction:g});this.channel=this.pc.createDataChannel("trackRelation"),this.channel.onopen=e=>{l.info(`${this.logPrefix} onopen:${JSON.stringify(e)}`)},this.channel.onmessage=e=>{l.info(`${this.logPrefix} onmessage:${JSON.stringify(e.data)}`)}}return(await this.pc.createOffer(t)).sdp}catch(e){throw`create offer fail error:${e}`}}setOfferSdp(e){l.info(`${this.logPrefix} setOfferSdp`),this.localSdp=e}async setAnswerSdp(e){l.info(`${this.logPrefix} setAnswerSdp`);try{if(void 0===this.localSdp)throw"do not set offer";this.needIceRestart=!1,await this.pc.setLocalDescription({type:p,sdp:this.localSdp}),await this.pc.setRemoteDescription({type:f,sdp:e}),this.emit(s.SET_ANSWER,0)}catch(e){throw`set remote answer fail error:${e}`}}getAnswerSdp(){return this.pc.currentRemoteDescription?this.pc.currentRemoteDescription.sdp:void 0}getLocalSdp(){return this.pc.currentLocalDescription?this.pc.currentLocalDescription.sdp:void 0}close(){l.info(`${this.logPrefix} close`);try{this.pc.close(),this.pc.ontrack=null,this.pc.oniceconnectionstatechange=null,this.pc.onconnectionstatechange=null,this.pc.onsignalingstatechange=null,this.pc.onicecandidate=null,this.pc=null,this.audioSender=null,this.audioTransceiver=null,this.videoSender=null,this.videoTransceiver=null,this.mediaStream=null,this.audioTrack=null,this.videoTrack=null}catch(e){}}async addTrack(e){if(l.info(`${this.logPrefix} addTrack kind:${e.kind}`),e.kind===o.AUDIO&&this.audioTrack||e.kind===o.VIDEO&&this.videoTrack)throw l.warning(`${this.logPrefix} addTrack error kind:${e.kind}`),u.TRACk_ALREADY_ADDED;let t=!1;return this.mediaStream.addTrack(e),this.supportUnifiedPlan?t=await this.addUnifedPlanTrack(e):(this.addPlanBTrack(e),t=!0),e.kind===o.AUDIO?this.audioTrack=e:this.videoTrack=e,t}removeTrack(e){l.info(`${this.logPrefix} removeTrack kind:${e.kind}`);let t=e.kind===o.AUDIO?this.audioSender:this.videoSender;if(null===t)throw u.SENDER_NOT_FOUND;try{this.pc.removeTrack(t)}catch(t){l.warning(`${this.logPrefix} removeTrack error kind:${e.kind} error:${t.toString()}`)}if(this.mediaStream.removeTrack(e),e.kind===o.AUDIO)this.audioSender=null,this.audioTrack=null,this.audioTransceiver&&(this.audioTransceiver.direction=v);else{this.videoSender=null,this.videoTrack=null;try{this.videoTransceiver&&(this.videoTransceiver.direction=v)}catch(t){l.warning(`${this.logPrefix} removeTrack error kind:${e.kind} error:${t.toString()}`)}}}async replaceTrack(e){l.info(`${this.logPrefix} replaceTrack kind:${e.kind}`);let t=e.kind===o.AUDIO?this.audioTrack:this.videoTrack;if(this.supportReplaceTrack){let i=e.kind===o.AUDIO?this.audioSender:this.videoSender;if(null===i)throw u.SENDER_NOT_FOUND;this.mediaStream.removeTrack(t),this.mediaStream.addTrack(e),i.replaceTrack(e),e.kind===o.AUDIO?this.audioTrack=e:this.videoTrack=e}else{if(null===t)throw u.TRACK_NOT_EXIST;this.removeTrack(t),await this.addTrack(e)}}async setVideoEncoderParams(e){if(l.info(`${this.logPrefix} setVideoEncoderParams`),this.videoSender){let t=this.videoSender.getParameters();0===t.encodings.length&&(t.encodings=[{}]),e.maxBitrate&&(t.encodings[0].maxBitrate=1e3*e.maxBitrate),e.maxFramerate&&(t.encodings[0].maxFramerate=e.maxFramerate);try{return await this.videoSender.setParameters(t),!0}catch(e){return l.error(`${this.logPrefix} setVideoEncoderParams sender set param error:error`),!1}}return!1}async setOptimizationMode(e){if(l.info(`${this.logPrefix} setOptimizationMode mode:${e}`),this.videoSender){let t=this.videoSender.getParameters();if("degradationPreference"in t){let i="balanced";"motion"===e?i="maintain-framerate":"detail"===e&&(i="maintain-resolution"),t.degradationPreference=i;try{await this.videoSender.setParameters(t),t=this.videoSender.getParameters()}catch(e){l.error(`${this.logPrefix} setOptimizationMode set mode because of error:${e}`)}}}}isSenderSupportedSetParam(){return("chrome"===r.browserDetails.browser||"safari"===r.browserDetails.browser||"firefox"===r.browserDetails.browser&&r.browserDetails.version>=64)&&"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype}get connectionState(){return this.pc?this.pc.connectionState||this.pc.iceConnectionState:void 0}isTrackAdded(e){return this.mediaStream&&this.mediaStream.getTracks().includes(e)}async addUnifedPlanTrack(e){l.info(`${this.logPrefix} addUnifedPlanTrack`);let t=e.kind===o.AUDIO?this.audioTransceiver:this.videoTransceiver,i=!1;return t?(await t.sender.replaceTrack(e),t.direction=m):(t=this.pc.addTransceiver(e,{direction:m}),i=!0),e.kind===o.AUDIO?(this.audioTransceiver=this.audioTransceiver?this.audioTransceiver:t,this.audioSender=t.sender):(this.videoTransceiver=this.videoTransceiver?this.videoTransceiver:t,this.videoSender=t.sender),i}addPlanBTrack(e){l.info(`${this.logPrefix} addPlanBTrack`);let t=this.pc.addTrack(e,this.mediaStream);e.kind===o.AUDIO?this.audioSender=t:this.videoSender=t}async recreatePeerConnection(){l.info(`${this.logPrefix} recreatePeerConnection`),this.createTime=Date.now().toString().slice(-6),this.logPrefix=`[${this.config.type.slice(0,3)}_peer_${this.id}_${this.sourceType}_${this.simulcastLayer}_${this.createTime}]`;let e=this.mediaStream.getTracks();this.close(),this.createPeerConnection(),this.needIceRestart=!0,this.config.type===c.PUBLISH&&e.forEach((async e=>{try{await this.addTrack(e)}catch(t){l.info(`${this.logPrefix} recreatePeerConnection fail to add track of ${e.kind}`)}}))}isAddedTrack(e){return e.kind===o.AUDIO&&this.audioTrack&&e===this.audioTrack||e.kind===o.VIDEO&&this.videoTrack&&e===this.videoTrack}async awaitSetAnswer(){l.info(`${this.logPrefix} awaitSetAnswer`),await new Promise(((e,t)=>{this.once(s.SET_ANSWER,(i=>{l.info(`${this.logPrefix} awaitSetAnswer resolve code:${i}`),0===i?e():t("await set answer failed")}))}))}initiativeReconnect(){l.info(`${this.logPrefix} initiativeReconnect`),this.emit(s.RECONNECT,this.id,this.sourceType,this.simulcastLayer)}}}},417:(e,t,i)=>{const r=i(5547),n=i(7247);function o(e,t,i,r){var n=e.split("\r\n"),o=l(n,t),a={};if(null===o){var u=d(n,"a=rtpmap",t);if(null===u)return e;var h=p(n[u]);a.pt=h.toString(),a.params={},a.params[i]=r,n.splice(u+1,0,c(a))}else(a=s(n[o])).params[i]=r,n[o]=c(a);return e=n.join("\r\n")}function a(e,t,i,r){let n=e.split("\r\n"),o=0;for(;o<n.length;){let e=h(n,o,-1,"a=rtpmap",t);if(null===e)break;var a=p(n[e]);let l=h(n,e+1,-1,"a=fmtp:"+a.toString());var u={};null===l?(u.pt=a.toString(),u.params={},u.params[i]=r,n.splice(e+1,0,c(u)),l=e+1):((u=s(n[l])).params[i]=r,n[l]=c(u)),o=l+1}return e=n.join("\r\n")}function s(e){var t={},i=e.indexOf(" "),r=e.substring(i+1).split(";"),n=new RegExp("a=fmtp:(\\d+)"),o=e.match(n);if(!o||2!==o.length)return null;t.pt=o[1];for(var a={},s=0;s<r.length;++s){var c=r[s].split("=");2===c.length&&(a[c[0]]=c[1])}return t.params=a,t}function c(e){if(!e.hasOwnProperty("pt")||!e.hasOwnProperty("params"))return null;var t=e.pt,i=e.params,r=[],n=0;for(var o in i)r[n]=o+"="+i[o],++n;return 0===n?null:"a=fmtp:"+t.toString()+" "+r.join(";")}function u(e,t,i){var r=e.split("\r\n"),n=l(r,t);if(null===n)return e;var o=s(r[n]);delete o.params[i];var a=c(o);return null===a?r.splice(n,1):r[n]=a,e=r.join("\r\n")}function l(e,t){var i=function(e,t){var i=d(e,"a=rtpmap",t);return i?p(e[i]):null}(e,t);return i?d(e,"a=fmtp:"+i.toString()):null}function d(e,t,i){return h(e,0,-1,t,i)}function h(e,t,i,r,n,o){if(void 0===o&&(o="asc"),"asc"===(o=o||"asc")){for(var a=-1!==i?i:e.length,s=t;s<a;++s)if(0===e[s].indexOf(r)&&(!n||-1!==e[s].toLowerCase().indexOf(n.toLowerCase())))return s}else for(var c=-1!==t?t:e.length-1;c>=0;--c)if(0===e[c].indexOf(r)&&(!n||-1!==e[c].toLowerCase().indexOf(n.toLowerCase())))return c;return null}function p(e){var t=new RegExp("a=rtpmap:(\\d+) [a-zA-Z0-9-]+\\/\\d+"),i=e.match(t);return i&&2===i.length?i[1]:null}function f(e,t){var i=e.split(" "),r=i.slice(0,3);r.push(t);for(var n=3;n<i.length;n++)i[n]!==t&&r.push(i[n]);return r.join(" ")}function m(e,t,i,r){var o=t+" "+i+" codec";if(!r)return n.debug("No preference on "+o+"."),e;n.debug("Prefer "+o+": "+r);var a=e.split("\r\n"),s=d(a,"m=",t);if(null===s)return e;for(var c=null,u=a.length-1;u>=0;--u){var l=h(a,u,0,"a=rtpmap",r,"desc");if(null===l)break;u=l,(c=p(a[l]))&&(a[s]=f(a[s],c))}return e=a.join("\r\n")}function g(e,t,i){var o=e.split("\r\n"),a=d(o,"m=",i);if(null===a)return n.debug("Failed to add bandwidth line to sdp, as no m-line found"),e;var s=h(o,a+1,-1,"m=");null===s&&(s=o.length);var c=h(o,a+1,s,"c=");if(null===c)return n.debug("Failed to add bandwidth line to sdp, as no c-line found"),e;let u="AS";"firefox"===r.browserDetails.browser&&(t=1e3*(t>>>0),u="TIAS");var l=h(o,c+1,s,`b=${u}`);l&&o.splice(l,1);var p=`b=${u}:`+t;return o.splice(c+1,0,p),e=o.join("\r\n")}function v(e,t){e=e.split(" ");for(var i=0;i<e.length;++i)e[i]===t.toString()&&e.splice(i,1);return e.join(" ")}function A(e,t){var i=d(e,"a=rtpmap",t.toString());if(null===i)return e;e.splice(i,1);var r=d(e,"m=","video");return null===r||(e[r]=v(e[r],t)),e}class T{static mergeConstraints(e,t){if(!e||!t)return e||t;var i=e;for(var r in t)i[r]=t[r];return i}static iceCandidateType(e){return e.split(" ")[7]}static setOpusParam(e,t){return"true"===t.opusStereo?e=o(e,"opus/48000","stereo","1"):"false"===t.opusStereo&&(e=u(e,"opus/48000","stereo")),"true"===t.opusFec?e=o(e,"opus/48000","useinbandfec","1"):"false"===t.opusFec&&(e=u(e,"opus/48000","useinbandfec")),"true"===t.opusDtx?e=o(e,"opus/48000","usedtx","1"):"false"===t.opusDtx&&(e=u(e,"opus/48000","usedtx")),t.opusMaxPbr&&(e=o(e,"opus/48000","maxplaybackrate",t.opusMaxPbr)),t.spropMaxCapturerate&&(e=o(e,"opus/48000","sprop-maxcapturerate",t.opusMaxPbr)),e}static setAudioSendBitRate(e,t){return t.audioSendBitrate?(n.debug(`[SdpUtil] setAudioSendBitRate bitrate:${t.audioSendBitrate}`),g(e,t.audioSendBitrate,"audio")):e}static setAudioReceiveBitRate(e,t){return t.audioRecvBitrate?(n.debug(`[SdpUtil] setAudioReceiveBitRate Prefer audio receive bitrate:${t.audioRecvBitrate}`),g(e,t.audioRecvBitrate,"audio")):e}static setVideoSendBitRate(e,t){return t.videoSendBitrate?(n.debug(`[SdpUtil] setVideoSendBitRate bitrate:${t.videoSendBitrate}`),g(e,t.videoSendBitrate,"video")):e}static setVideoReceiveBitRate(e,t){return t.videoRecvBitrate?(n.debug(`[SdpUtil] setVideoReceiveBitRate bitrate:${t.videoRecvBitrate}`),g(e,t.videoRecvBitrate,"video")):e}static setVideoCodecParam(e,t){var i=e.split("\r\n"),r=d(i,"m=","video");if(null===r)return n.debug("[SdpUtil] setVideoCodecParam failed to find video m-line"),e;var a=i[r],s=new RegExp("m=video\\s\\d+\\s[A-Z/]+\\s");a.split(s);var c=a.split(s)[1].split(" ")[0],u=i[d(i,"a=rtpmap",c)].split("a=rtpmap:"+c)[1].split("/")[0],l=t.videoSendCodec||u;return t.minBitrate&&(e=o(e,l,"x-google-min-bitrate",t.minBitrate.toString())),t.maxBitrate&&(e=o(e,l,"x-google-max-bitrate",t.maxBitrate.toString())),t.startBitrate&&(e=o(e,l,"x-google-start-bitrate",t.startBitrate.toString())),t.profileLevelId&&(e=o(e,l,"profile-level-id",t.profileLevelId)),t.maxFrameRate&&(e=o(e,l,"max-fr",t.maxFrameRate)),e}static setSpsPpsIdrInkeyFrame(e,t){if(!e||0===e.length)return e;var i=e.split("\r\n"),r=d(i,"m=","video");if(null===r)return n.debug("[SdpUtil] setSpsPpsIdrInkeyFrame failed to find video m-line"),e;var o=i[r],s=new RegExp("m=video\\s\\d+\\s[A-Z/]+\\s"),c=o.split(s)[1].split(" ")[0],u=i[d(i,"a=rtpmap",c)].split("a=rtpmap:"+c)[1].split("/")[0];return e=a(e,t.codec||u,"sps-pps-idr-in-keyframe",1)}static setPacketizationMode(e,t){if(!e||0===e.length)return e;var i=e.split("\r\n"),r=d(i,"m=","video");if(null===r)return n.debug("[SdpUtil] setPacketizationMode failed to find video m-line"),e;var o=i[r],s=new RegExp("m=video\\s\\d+\\s[A-Z/]+\\s"),c=o.split(s)[1].split(" ")[0],u=i[d(i,"a=rtpmap",c)].split("a=rtpmap:"+c)[1].split("/")[0];return e=a(e,t.codec||u,"packetization-mode",t.packetizationMode)}static modifyOrRecoverySsrc(e,t,i){if(!e||0===e.length)return e;var r=e.split("\r\n"),o=d(r,"m=",t);if(null===o)return n.debug("[SdpUtil] modifyOrRecoverySscr failed to find video m-line"),e;let a=h(r,o+1,-1,"a=ssrc");for(let e=0;e<4;e++){var s=r[a+e].split(" "),c=s[0].split(":");c[1]=i?parseInt(c[1])+1:parseInt(c[1])-1,r[a+e]=c.join(":")+" "+s[1]}return e=r.join("\r\n")}static readSsrc(e,t){if(!e||0===e.length)return;let i=e.split("\r\n"),r=new Map;if("video"===t||"av"===t){let e=d(i,"m=","video");if(null===e)n.debug("[SdpUtil] readSsrc failed to find video m-line");else{let t=i[h(i,e+1,-1,"a=ssrc")].split(" ");r.set("video",t.slice(1))}}if("audio"===t||"av"===t){let e=d(i,"m=","audio");if(null===e)n.debug("[SdpUtil] readSsrc failed to find audio m-line");else{let t=i[h(i,e+1,-1,"a=ssrc:")].split(" ");r.set("audio",[t[0].split(":")[1]])}}return r}static replaceSSrcWithLastSdp(e,t){let i=T.readSsrc(e,"av"),r=T.readSsrc(t,"av");return i.forEach(((e,i)=>{let n=r.get(i);void 0!==n&&n.forEach(((i,r)=>{t=t.replace(new RegExp(i,"gm"),e[r])}))})),t}static removeTransportCC(e){if(!e||0===e.length)return e;var t=e.split("\r\n");return e=t.filter(((e,t)=>!e.includes("transport-cc")&&!e.includes("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))).join("\r\n")}static writeRtcpFb(e,t){if(!e||0===e.length)return e;let i=e.split("\r\n");for(let e=0;e<i.length;){if(i[e].includes("a=rtpmap")){let r=`a=rtcp-fb:${p(i[e])} ${t}`;i.splice(e+1,0,r),++e}++e}return e=i.join("\r\n")}static removeVideoFec(e,t){if("false"!==t.videoFec)return e;var i=e.split("\r\n"),r=d(i,"a=rtpmap","red");if(null===r)return e;var n=p(i[r]);if(i=function(e,t){var i=d(e,"a=rtpmap",t);if(null===i)return e;var r=p(e[i]);e.splice(i,1);var n=d(e,"m=","video");return null===n||(e[n]=v(e[n],r)),e}(i=A(i,n),"ulpfec"),null===(r=d(i,"a=fmtp",n.toString())))return e;var o=s(i[r]).pt;return null===o?e:(i.splice(r,1),(i=A(i,o)).join("\r\n"))}static setPreferAudioSendCodec(e,t){return m(e,"audio","send",t.audioSendCodec)}static setPreferAudioReceiveCodec(e,t){return m(e,"audio","receive",t.audioRecvCodec)}static setPreferVideoSendCodec(e,t){return m(e,"video","send",t.videoSendCodec)}static setVideoReceiveCodec(e,t){return m(e,"video","receive",t.videoRecvCodec)}static getAudioParam(e){if(!e||0===e.length)return;let t,i=e.split("m=");for(let e=0;e<i.length;++e){let r=i[e].match(/audio /);r&&(t=r.input)}if(!t)return;let r=t.split("\r\n"),n=0,o=[];for(;n<r.length;){let e=h(r,n,r.length,"a=rtpmap");if(null===e)break;let t=r[e].split(" ")[1].split("/");o.push({codingStreamType:t[0],channels:t[2],clockRate:t[1]}),n=e+1}return o}static getSupportedCodec(e){if(!e||0===e.length)return{video:[],audio:[]};let t=e.split("\r\n"),i=0,r=[],n=[];for(;i<t.length;){let e=h(t,i,t.length,"a=rtpmap");if(null===e)break;let o=t[e].split(" ")[1].split("/")[0];switch(o){case"opus":!n.includes(o)&&n.push(o);break;case"H264":case"VP8":case"VP9":!r.includes(o)&&r.push(o)}i=e+1}return{video:r,audio:n}}static setVideoCodec(e,t){let i=t.split("\r\n");var r=d(i,"m=","video");if(null===r)return t;let n=i[r],o=r+1,a=[];const s=new RegExp("rtpmap:\\d+ VP8|VP9|H264|AV1X|red/\\d+"),c=new RegExp("a=fmtp:(\\d+) apt=\\d+");for(;o<i.length&&!i[o].startsWith("m=audio");){let t=i[o];if(s.test(t))if(t.includes(e))o++;else{n=v(n,p(t));let e=o;for(;++e<i.length;){let t=i[e].match(c);if(t&&2===t.length){a.push([o,e]),n=v(n,t[1]);break}}o=e+1}else o++}i[r]=n;let u=[];for(o=0;o<i.length;){let e=!1;for(let t of a)if(o>=t[0]&&o<=t[1]){e=!0;break}e||u.push(i[o]),o++}return u.join("\r\n")}}e.exports=T},4312:e=>{class t{static GenerateJoinBody(e,i,r,n,o,a){return{action:t.Action.kJoin,roomId:e,role:i,token:r,deviceId:n,supportH264:o,signalHost:a}}static GenerateLeaveBody(e){return{action:t.Action.kLeave,roomId:e}}static GeneratePublishBody(e,i,r,n,o,a){let s=0===o?"low":"high";return{action:t.Action.kPublish,video:e,audio:i,sdp:r,sourceType:n,simulcastLayer:s,iceRestart:a}}static GenerateUnpublishBody(e,i,r,n){let o=0===n?"low":"high";return{action:t.Action.kUnpublish,video:e,audio:i,sourceType:r,simulcastLayer:o}}static GenerateSubscibeBody(e,i,r,n,o,a){return{action:t.Action.kSubscribe,uid:e,sdp:i,video:r,audio:n,sourceType:o,iceRestart:a}}static GenerateUnsubscribeBody(e,i){return{action:t.Action.kUnsubscribe,uid:e,sourceType:i}}static GenerateMuteAudioBody(e,i,r){return{action:t.Action.kMuteAudio,uid:e,sourceType:i,public:r}}static GenerateUnmuteAudioBody(e,i,r){return{action:t.Action.kUnmuteAudio,uid:e,sourceType:i,public:r}}static GenerateMuteVideoBody(e,i,r){return{action:t.Action.kMuteVideo,uid:e,sourceType:i,public:r}}static GenerateUnmuteVideoBody(e,i,r){return{action:t.Action.kUnmuteVideo,uid:e,sourceType:i,public:r}}static GenerateSetRoleBody(e){return{action:t.Action.kSetRole,role:e}}static GenerateSwitchStreamType(e,i){return{action:t.Action.kSwitchStreamType,uid:e,simulcastLayer:i}}static GenerateSetLiveTranscodingBody(e){return{action:t.Action.kSetLiveTranscoding,liveTranscoding:e}}static GenerateStartLiveStreamingBody(e,i){return{action:t.Action.kStartLiveStreaming,url:e,transcodingEnabled:i}}static GenerateStopLiveStreamingBody(e){return{action:t.Action.kStopLiveStreaming,url:e}}static GenerateLocalNetQualityBody(e,i){return{action:t.Action.kUpdateNetworkQuality,uplink_quality_score:e,downlink_quality_score:i}}static GenerateSignalRequestData(e,i,r,n,o){let a=t.seq++;return{seq:a,data:JSON.stringify({appId:e,roomId:i,uid:r,sdkVersion:n,seq:a,ts:window.performance.now(),command:t.Command.kClientRequest,body:o})}}static GenerateSignalPingData(e,i,r,n){let o=t.seq++;return{seq:o,data:JSON.stringify({command:t.Command.kPing,seq:o,appId:e,roomId:i,uid:r,sdkVersion:n,ts:window.performance.now(),body:{action:t.Command.kPing}})}}}t.Action={kJoin:"join",kLeave:"leave",kPublish:"publish",kUnpublish:"unpublish",kSubscribe:"subscribe",kUnsubscribe:"unsubscribe",kMuteAudio:"mute_audio",kUnmuteAudio:"unmute_audio",kMuteVideo:"mute_video",kUnmuteVideo:"unmute_video",kVideoMuteState:"video_mute",kVideoUnmuteState:"video_unmute",kAudioMuteState:"audio_mute",kAudioUnmuteState:"audio_unmute",kSetRole:"set_role",kStreamAdded:"stream_added",kStreamRemoved:"stream_remove",kUserOnline:"user_online",kUserOffline:"user_offline",kRemoteUsersState:"remote_users",kKickedOutState:"kicked_out",kSwitchStreamType:"switch_stream_type",kSetLiveTranscoding:"set_live_transcoding",kStartLiveStreaming:"start_live_streaming",kStopLiveStreaming:"stop_live_streaming",kTrackRelationState:"track_relation",kAryaErrorState:"arya_error",kUpdateNetworkQuality:"update_network_quality",kRemoteNetworkQuality:"remote_network_quality"},t.Command={kClientRequest:"clientRequest",kClientResponse:"clientResponse",kServerStatus:"serverStatus",kPing:"ping",kPong:"pong"},t.seq=0,e.exports=t},9036:(e,t,i)=>{const r=i(485),n=i(9596),o=i(4312),{ActionInfo:a,RtcAction:s}=i(9516),{MediaType:c,SignalHandlerEvent:u,SignalConnectionState:l,SignalConnectionStateReason:d,PeerConnectionState:h}=i(9648),p=i(7247),f=i(297);const m=1e3;e.exports=class extends r{constructor(e){super(),this.appId=e.appId,this.channel=e.channel,this.uid=e.uid,this.sdkVersion=e.sdkVersion,this.client=e,this.aryaSignal=new n,this.aryaSignal.init(this.appId,this.channel,this.uid,this.sdkVersion,this),this.aryaSignal.onMessage=this.onMessage.bind(this),this.aryaSignal.onSignalConnectionStateChange=this.onSignalConnectionStateChange.bind(this),this.rtcAction=new s,this.deviceId=e.deviceId?e.deviceId:"",this._signalMutex=new f("signalMutex")}connnect(e){return this.aryaSignal.reset(),this.aryaSignal.open(e)}close(e){this.aryaSignal.close(e),e||(this.client=null,this.aryaSignal=null),this._signalMutex.locked&&this._signalMutex.unlock()}async sendSetRoleSignal(e,t){let i=o.GenerateSetRoleBody(e);return this.sendSignal(i,t)}async sendJoinSignal(e,t,i,r,n,a){let s=o.GenerateJoinBody(e,t,i,this.deviceId,r,n);return this.sendSignal(s,a)}async sendLeaveSignal(e,t){let i=o.GenerateLeaveBody(e);return this.sendSignal(i,t)}async sendPublishSignal(e,t,i,r,n,s,c){let u=o.GeneratePublishBody(e,t,i,r,n,s);return this.rtcAction.push(new a(o.seq,o.Action.kPublish,this.uid,r,n)),this.sendSignal(u,c)}async sendUnpublishSignal(e,t,i,r,n){let s=o.GenerateUnpublishBody(e,t,i,r);return this.rtcAction.push(new a(o.seq,o.Action.kUnpublish,this.uid,i,r)),this.sendSignal(s,n)}async sendAudioMuteStateSignal(e,t,i,r,n){let s=t?o.GenerateMuteAudioBody(e,i,r):o.GenerateUnmuteAudioBody(e,i,r),c=t?o.Action.kMuteAudio:o.Action.kUnmuteAudio;return this.rtcAction.push(new a(o.seq,c,e,i)),this.sendSignal(s,n)}async sendVideoMuteStateSignal(e,t,i,r,n){let s=t?o.GenerateMuteVideoBody(e,i,r):o.GenerateUnmuteVideoBody(e,i,r),c=t?o.Action.kMuteVideo:o.Action.kUnmuteVideo;return this.rtcAction.push(new a(o.seq,c,e,i)),this.sendSignal(s,n)}async sendSubscribeSignal(e,t,i,r,n,s,c){let u=o.GenerateSubscibeBody(e,t,i,r,n,s);return this.rtcAction.push(new a(o.seq,o.Action.kSubscribe,e,n)),this.sendSignal(u,c)}async sendUnsubscribeSignal(e,t,i){let r=o.GenerateUnsubscribeBody(e,t);return this.rtcAction.push(new a(o.seq,o.Action.kUnsubscribe,e,t)),this.sendSignal(r,i)}async sendSubscribeChangedSignal(e,t,i,r){let n=t.enableVideo[0],s=t.enableAudio[0],c=o.GenerateSubscibeBody(e,"",n,s,t.sourceType),u=new a(o.seq,o.Action.kSubscribe,e,t.sourceType);return u.event=i,this.rtcAction.push(u),this.sendSignal(c,r)}async sendSwitchStreamTypeSignal(e,t,i){let r=o.GenerateSwitchStreamType(e,t);return this.sendSignal(r,i)}async sendSetLiveTranscodingSignal(e,t){let i=o.GenerateSetLiveTranscodingBody(e);return this.sendSignal(i,t)}async sendStartLiveStreamingSignal(e,t,i){let r=o.GenerateStartLiveStreamingBody(e,t);return this.sendSignal(r,i)}async sendStopLiveStreamingSignal(e,t){let i=o.GenerateStopLiveStreamingBody(e);return this.sendSignal(i,t)}async sendLocalNetQualitySignal(e,t,i){let r=o.GenerateLocalNetQualityBody(e,t);return this.sendSignal(r,i)}async sendSignal(e,t){let i=o.GenerateSignalRequestData(this.appId,this.channel,this.uid,this.sdkVersion,e);if(t)this.aryaSignal.send(i);else try{return await this.aryaSignal.invoke(i)}catch(e){throw e}}async onSignalConnectionStateChange(e){if(p.info(`[SignalHandler] onSignalConnectionStateChange state:${e}`),e===n.WsStatus.WSStatusReconnectFail||e===n.WsStatus.WSStatusConnectionRefuse)this.emit(u.RECONNECT_FAILED);else{let t=e===n.WsStatus.WsStatusConnected?l.CONNECTED:l.RECONNECTING;try{await this.asyncEmit(u.CONNECTION_STATE,t)}catch(t){p.warning(`[SignalHandler] onSignalConnectionStateChange state:${e}, error:${t}`)}}}isMediaConnectionActive(){return this.client&&this.client.isMediaConnectionActive()}async onMessage(e){if(!this.isVaildMessage(e))return void p.warning("[SignalHandler] onMessage message is invalid");let t;if(e.command!==o.Command.kClientResponse||(t=this.getAndRemoveActionInfo(e.body.action,e.seq),void 0!==t)){try{switch(e.body.action){case o.Action.kUserOnline:await this.lockforTime(m),this.client.handleUserOnlineState(e.body.uid);break;case o.Action.kUserOffline:await this.lockforTime(m),this.client.handleUserOfflineState(e.body.uid);break;case o.Action.kAudioMuteState:await this.lockforTime(m),this.client.handleMuteState(e.body.uid,c.AUDIO,!0,e.body.sourceType);break;case o.Action.kAudioUnmuteState:await this.lockforTime(m),this.client.handleMuteState(e.body.uid,c.AUDIO,!1,e.body.sourceType);break;case o.Action.kVideoMuteState:await this.lockforTime(m),this.client.handleMuteState(e.body.uid,c.VIDEO,!0,e.body.sourceType);break;case o.Action.kVideoUnmuteState:await this.lockforTime(m),this.client.handleMuteState(e.body.uid,c.VIDEO,!1,e.body.sourceType);break;case o.Action.kRemoteUsersState:await this.lockforTime(m),await this.client.handleRemoteUsersState(e.body.remote_users),await this.client.handleContentState(e.body.content_user),this.client.setClientAddress(e.clientAddress);break;case o.Action.kKickedOutState:this.client.handleKickedOutState();break;case o.Action.kPublish:await this.client.handlePublishAction(t.sourceType,t.simulcastLayer,e.body.sdp),this.client.setClientAddress(e.clientAddress);break;case o.Action.kUnpublish:await this.client.handleUnpublishAction(t.sourceType,t.simulcastLayer);break;case o.Action.kSubscribe:this.handleSubscribeResponse(t,e);break;case o.Action.kUnsubscribe:this.client.handleUnsubscribeAction(t.uid,t.sourceType);break;case o.Action.kMuteAudio:this.client.handleMuteAction(t.uid,t.sourceType,c.AUDIO,!0);break;case o.Action.kUnmuteAudio:this.client.handleMuteAction(t.uid,t.sourceType,c.AUDIO,!1);break;case o.Action.kMuteVideo:this.client.handleMuteAction(t.uid,t.sourceType,c.VIDEO,!0);break;case o.Action.kUnmuteVideo:this.client.handleMuteAction(t.uid,t.sourceType,c.VIDEO,!1);break;case o.Action.kTrackRelationState:this.client.handleTrackRelationState(e.body.relation);break;case o.Action.kAryaErrorState:this.client.handleAryaErrorState(e.body.code,e.body.msg);case o.Action.kRemoteNetworkQuality:this.client.handleRemoteNetQuality(e.body.remote_user,e.body.uplink_network_score,e.body.downlink_network_score)}}catch(e){p.warning(`[SignalHandler] onMessage error:${e}`)}this._signalMutex.locked&&this._signalMutex.unlock()}else p.warning("[SignalHandler] onMessage client response is invalid")}isVaildMessage(e){return void 0!==e.body&&void 0!==e.body.action}async lockforTime(e){const t=new Promise(((t,i)=>{setTimeout(t,e)}));return await Promise.race([this._signalMutex.lock(),t])}getAndRemoveActionInfo(e,t){p.debug(`[SignalHandler] getAndRemoveActionInfo actionName:${e} seq:${t}`);let i=this.rtcAction.get(e,t);if(void 0!==i)return this.rtcAction.remove(e,t),i;p.warning(`[SignalHandler] getAndRemoveActionInfo action:${e} seq:${t} is invalid`)}handleSubscribeResponse(e,t){if(null===e.event)this.client.handleSubcribeAction(e.uid,e.sourceType,t.body.sdp);else switch(e.event){case o.Action.kMuteAudio:this.client.handleMuteAction(e.uid,e.sourceType,c.AUDIO,!0);break;case o.Action.kUnmuteAudio:this.client.handleMuteAction(e.uid,e.sourceType,c.AUDIO,!1);break;case o.Action.kMuteVideo:this.client.handleMuteAction(e.uid,e.sourceType,c.VIDEO,!0);break;case o.Action.kUnmuteVideo:this.client.handleMuteAction(e.uid,e.sourceType,c.VIDEO,!1)}}async reconnect(){if(p.info("[SignalHandler] reconnect"),this.aryaSignal)try{await this.aryaSignal.reconnect()}catch(e){p.info(`[SignalHandler] reconnect error:${e}`)}}get delayScore(){return this.aryaSignal?this.aryaSignal.delayScore:0}}},4891:(e,t,i)=>{const{version:r}=i(4147);Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},e.exports={parseJSON:function(e){try{return JSON.parse(e)}catch(e){}return null},removeArrayItem:function(e,t){let i=e.indexOf(t);-1!==i&&e.splice(i,1)},getRandomIntInclusive:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},getLocaltime:function(){return(new Date).Format("yyyy-MM-dd hh:mm:ss.S")},waitTime:function(e){return new Promise((t=>{window.setTimeout(t,e)}))},generateId:function e(t=7,i){let r=Math.random().toString(16).substr(2,t).toLowerCase();return r.length===t?i.concat(r):i.concat(r)+e(t-r.length,"")},getNetType:function(){let e=navigator.userAgent,t=navigator.connection,i=e.match(/NetType\/\w+/)?e.match(/NetType\/\w+/)[0]:"";"3gnet"===(i=i.toLowerCase().replace("nettype/",""))&&(i="3g");let r=t&&t.type&&t.type.toLowerCase(),n=t&&t.effectiveType&&t.effectiveType.toLowerCase();"slow-2"===n&&(n="2g");let o=i||"unknown";if(r)switch(r){case"cellular":case"wimax":o=n||"unknown";break;case"wifi":o="wifi";break;case"ethernet":o="wired";break;case"none":case"other":case"unknown":o="unknown"}return o.toUpperCase()},getSupportedCodec:async function(e){if(void 0===window.RTCRtpSender||!("getCapabilities"in RTCRtpSender)){let e=new RTCPeerConnection;try{let t=await e.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1});return e.close(),e=null,SdpUtil.getSupportedCodec(t.sdp)}catch(e){return{video:[],audio:[]}}}let t=RTCRtpSender.getCapabilities("video"),i=RTCRtpSender.getCapabilities("audio"),r=[];t&&t.codecs.forEach((e=>{let t=e.mimeType.replace(/^video\//,"").toLocaleUpperCase();"H264"!==t||r.includes("H264")||r.push(t),"VP8"===t&&r.push(t)}));let n=[];return i&&i.codecs.forEach((e=>{let t=e.mimeType.replace(/^audio\//,"").toLocaleUpperCase();"OPUS"===t&&n.push(t)})),{video:r,audio:n}},getAppInstanceId:function(){return localStorage.getItem("KRTC.instanceId")||localStorage.setItem("KRTC.instanceId",(Date.now()-16409664e5)%Math.pow(2,39)*Math.pow(2,24)+5*Math.pow(2,20)+Number(r.replace(/\./g,""))*Math.pow(2,5)+parseInt(31*Math.random())),localStorage.getItem("KRTC.instanceId")}}},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"krtc-js-sdk","version":"1.4.6","description":"","main":"arya_rtc.js","scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","dev":"NODE_ENV=development webpack serve ","build":"NODE_ENV=production webpack --config ./webpack.config.js","deploy":"sh deploy.sh rtc"},"author":"","license":"ISC","dependencies":{"@ks-video/kwai-video-post-processor":"^1.2.2","axios":"^0.24.0","md5":"^2.3.0","ua-parser-js":"^0.7.28"},"devDependencies":{"copy-webpack-plugin":"^9.0.1","css-loader":"^5.1.3","html-webpack-plugin":"5.3.2","style-loader":"^2.0.0","terser-webpack-plugin":"5.1.4","webpack":"^5.53.0","webpack-cli":"^4.8.0","webpack-dev-server":"^4.2.1"}}')}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}return i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(1719)})()}));